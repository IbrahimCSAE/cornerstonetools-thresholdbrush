/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={371:e=>{var t;window,t=function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(x[e]&&j[e]){for(var n in j[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--v&&0===p&&C()}}(e,n),t&&t(e,n)};var n,a=!0,o="4d8d88ba53621f59b9a9",r={},i=[],l=[];function s(e){var t=E[e];if(!t)return M;var a=function(a){return t.hot.active?(E[a]?-1===E[a].parents.indexOf(e)&&E[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),M(a)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return M[e]},set:function(t){M[e]=t}}};for(var r in M)Object.prototype.hasOwnProperty.call(M,r)&&"e"!==r&&"t"!==r&&Object.defineProperty(a,r,o(r));return a.e=function(e){return"ready"===c&&f("prepare"),p++,M.e(e).then(t,(function(e){throw t(),e}));function t(){p--,"prepare"===c&&(b[e]||w(e),0===p&&0===v&&C())}},a.t=function(e,t){return 1&t&&(e=a(e)),M.t(e,-2&t)},a}function u(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:T,apply:O,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:r[e]};return n=void 0,t}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var g,m,h,v=0,p=0,b={},j={},x={};function y(e){return+e+""===e?+e:e}function T(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise((function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,r=M.p+""+o+".hot-update.json";a.open("GET",r,!0),a.timeout=t,a.send(null)}catch(e){return n(e)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+r+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+r+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(e){return void n(e)}e(t)}}}))).then((function(e){if(!e)return f("idle"),null;j={},b={},x=e.c,h=e.h,f("prepare");var t=new Promise((function(e,t){g={resolve:e,reject:t}}));return m={},w("cornerstone"),"prepare"===c&&0===p&&0===v&&C(),t}));var t}function w(e){x[e]?(j[e]=!0,v++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.charset="utf-8",n.src=M.p+""+e+"."+o+".hot-update.js",t.appendChild(n)}(e)):b[e]=!0}function C(){f("ready");var e=g;if(g=null,e)if(a)Promise.resolve().then((function(){return O(a)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(y(n));e.resolve(t)}}function O(t){if("ready"!==c)throw new Error("apply() is only allowed in ready status");var n,a,l,s,u;function d(e){for(var t=[e],n={},a=t.slice().map((function(e){return{chain:[e],id:e}}));a.length>0;){var o=a.pop(),r=o.id,i=o.chain;if((s=E[r])&&!s.hot._selfAccepted){if(s.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:r};if(s.hot._main)return{type:"unaccepted",chain:i,moduleId:r};for(var l=0;l<s.parents.length;l++){var u=s.parents[l],d=E[u];if(d){if(d.hot._declinedDependencies[r])return{type:"declined",chain:i.concat([u]),moduleId:r,parentId:u};-1===t.indexOf(u)&&(d.hot._acceptedDependencies[r]?(n[u]||(n[u]=[]),g(n[u],[r])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var v={},p=[],b={},j=function(){console.warn("[HMR] unexpected require("+w.moduleId+") to disposed module")};for(var T in m)if(Object.prototype.hasOwnProperty.call(m,T)){var w;u=y(T);var C=!1,O=!1,I=!1,S="";switch((w=m[T]?d(u):{type:"disposed",moduleId:T}).chain&&(S="\nUpdate propagation: "+w.chain.join(" -> ")),w.type){case"self-declined":t.onDeclined&&t.onDeclined(w),t.ignoreDeclined||(C=new Error("Aborted because of self decline: "+w.moduleId+S));break;case"declined":t.onDeclined&&t.onDeclined(w),t.ignoreDeclined||(C=new Error("Aborted because of declined dependency: "+w.moduleId+" in "+w.parentId+S));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(w),t.ignoreUnaccepted||(C=new Error("Aborted because "+u+" is not accepted"+S));break;case"accepted":t.onAccepted&&t.onAccepted(w),O=!0;break;case"disposed":t.onDisposed&&t.onDisposed(w),I=!0;break;default:throw new Error("Unexception type "+w.type)}if(C)return f("abort"),Promise.reject(C);if(O)for(u in b[u]=m[u],g(p,w.outdatedModules),w.outdatedDependencies)Object.prototype.hasOwnProperty.call(w.outdatedDependencies,u)&&(v[u]||(v[u]=[]),g(v[u],w.outdatedDependencies[u]));I&&(g(p,[w.moduleId]),b[u]=j)}var P,_=[];for(a=0;a<p.length;a++)u=p[a],E[u]&&E[u].hot._selfAccepted&&_.push({module:u,errorHandler:E[u].hot._selfAccepted});f("dispose"),Object.keys(x).forEach((function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)}));for(var D,L,k=p.slice();k.length>0;)if(u=k.pop(),s=E[u]){var A={},R=s.hot._disposeHandlers;for(l=0;l<R.length;l++)(n=R[l])(A);for(r[u]=A,s.hot.active=!1,delete E[u],delete v[u],l=0;l<s.children.length;l++){var H=E[s.children[l]];H&&(P=H.parents.indexOf(u))>=0&&H.parents.splice(P,1)}}for(u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&(s=E[u]))for(L=v[u],l=0;l<L.length;l++)D=L[l],(P=s.children.indexOf(D))>=0&&s.children.splice(P,1);for(u in f("apply"),o=h,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&(s=E[u])){L=v[u];var U=[];for(a=0;a<L.length;a++)if(D=L[a],n=s.hot._acceptedDependencies[D]){if(-1!==U.indexOf(n))continue;U.push(n)}for(a=0;a<U.length;a++){n=U[a];try{n(L)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:L[a],error:e}),t.ignoreErrored||B||(B=e)}}}for(a=0;a<_.length;a++){var F=_[a];u=F.module,i=[u];try{M(u)}catch(e){if("function"==typeof F.errorHandler)try{F.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:n,originalError:e}),t.ignoreErrored||B||(B=n),B||(B=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:e}),t.ignoreErrored||B||(B=e)}}return B?(f("fail"),Promise.reject(B)):(f("idle"),new Promise((function(e){e(p)})))}var E={};function M(t){if(E[t])return E[t].exports;var n=E[t]={i:t,l:!1,exports:{},hot:u(t),parents:(l=i,i=[],l),children:[]};return e[t].call(n.exports,n,n.exports,s(t)),n.l=!0,n.exports}return M.m=e,M.c=E,M.d=function(e,t,n){M.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},M.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},M.t=function(e,t){if(1&t&&(e=M(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(M.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)M.d(n,a,function(t){return e[t]}.bind(null,a));return n},M.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return M.d(t,"a",t),t},M.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},M.p="",M.h=function(){return o},s("./index.js")(M.s="./index.js")}({"./canvasToPixel.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),r=Object(o.default)(n);return r.invert(),r.transformPoint(t.x,t.y)}},"./colors/colormap.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getColormapsList",(function(){return s})),n.d(t,"getColormap",(function(){return u}));var a=n("./colors/lookupTable.js"),o=[0,0,0,0],r={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}};function i(e,t){for(var n=0,a=e.length-1;n<=a;){var o=n+Math.floor((a-n)/2),r=e[o];if(r===t)return o;t<r?a=o-1:n=o+1}return n}function l(e,t,n){var a,o=[],r=[],l=[],s=[];for(n=null===n?1:n,a=0;a<t.length;a++){var u=t[a];o.push((e-1)*u[0]),r.push(u[1]),l.push(u[1])}var d=function(e,t,n){for(var a=(1-e)/((n=null===n?100:n)-1),o=[];n-- >0;)o.push(e),e+=a;return o[o.length-1]=1,o}(0,0,e);for(a=0;a<e;a++)d[a]=(e-1)*Math.pow(d[a],n);var c=function(e,t){var n,a=[],o=t.length;for(e.sort((function(e,t){return e-t})),n=0;n<o;n++)a[n]=i(e,t[n]);return a}(o,d);for(a=1;a<e-1;a++){var f=c[a],g=(d[a]-o[f-1])/(o[f]-o[f-1]),m=r[f]-l[f-1];s[a]=g*m+l[f-1]}return s[0]=l[0],s[e-1]=r[t.length-1],s}function s(){var e=[];return Object.keys(r).forEach((function(t){if(r.hasOwnProperty(t)){var n=r[t];e.push({id:t,name:n.name})}})),e.sort((function(e,t){var n=e.name.toLowerCase(),a=t.name.toLowerCase();return n===a?0:n<a?-1:1})),e}function u(e,t){var n=r[e];return n||(n=r[e]=t||{name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=function(e,t,n){var a,o=[];n=null===n?1:n;var r=l(t=null===t?256:t,e.red,n),i=l(t,e.green,n),s=l(t,e.blue,n);for(a=0;a<t;a++){var u=[Math.round(255*r[a]),Math.round(255*i[a]),Math.round(255*s[a]),255];o.push(u)}return o}(n.segmentedData,n.numColors,n.gamma)),{getId:function(){return e},getColorSchemeName:function(){return n.name},setColorSchemeName:function(e){n.name=e},getNumberOfColors:function(){return n.colors.length},setNumberOfColors:function(e){for(;n.colors.length<e;)n.colors.push(o);n.colors.length=e},getColor:function(e){return this.isValidIndex(e)?n.colors[e]:o},getColorRepeating:function(e){var t=n.colors.length;return e=t?e%t:0,this.getColor(e)},setColor:function(e,t){this.isValidIndex(e)&&(n.colors[e]=t)},addColor:function(e){n.colors.push(e)},insertColor:function(e,t){this.isValidIndex(e)&&n.colors.splice(e,1,t)},removeColor:function(e){this.isValidIndex(e)&&n.colors.splice(e,1)},clearColors:function(){n.colors=[]},buildLookupTable:function(e){if(e){var t=n.colors.length;e.setNumberOfTableValues(t);for(var a=0;a<t;a++)e.setTableValue(a,n.colors[a])}},createLookupTable:function(){var e=new a.default;return this.buildLookupTable(e),e},isValidIndex:function(e){return e>=0&&e<n.colors.length}}}},"./colors/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/colormap.js"),o=n("./colors/lookupTable.js");t.default={getColormap:a.getColormap,getColormapsList:a.getColormapsList,LookupTable:o.default}},"./colors/lookupTable.js":function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,n){if(e>1)throw new Error("HSVToRGB expects hue < 1");var a=[];if(0===t)return a[0]=n,a[1]=n,a[2]=n,a;var o=Math.floor(6*e),r=6*e-o,i=n*(1-t),l=n*(1-t*r),s=n*(1-t*(1-r));switch(o){case 0:case 6:a[0]=n,a[1]=s,a[2]=i;break;case 1:a[0]=l,a[1]=n,a[2]=i;break;case 2:a[0]=i,a[1]=n,a[2]=s;break;case 3:a[0]=i,a[1]=l,a[2]=n;break;case 4:a[0]=s,a[1]=i,a[2]=n;break;case 5:a[0]=n,a[1]=i,a[2]=l}return a}n.r(t);var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}var t,n;return t=e,n=[{key:"setNumberOfTableValues",value:function(e){this.NumberOfColors=e}},{key:"setRamp",value:function(e){this.Ramp=e}},{key:"setTableRange",value:function(e,t){this.TableRange[0]=e,this.TableRange[1]=t}},{key:"setHueRange",value:function(e,t){this.HueRange[0]=e,this.HueRange[1]=t}},{key:"setSaturationRange",value:function(e,t){this.SaturationRange[0]=e,this.SaturationRange[1]=t}},{key:"setValueRange",value:function(e,t){this.ValueRange[0]=e,this.ValueRange[1]=t}},{key:"setRange",value:function(e,t){this.InputRange[0]=e,this.InputRange[1]=t}},{key:"setAlphaRange",value:function(e,t){this.AlphaRange[0]=e,this.AlphaRange[1]=t}},{key:"getColor",value:function(e){return this.mapValue(e)}},{key:"build",value:function(e){if(!(this.Table.length>1)||e){this.Table=[];var t,n,a,r,i=this.NumberOfColors-1;i?(t=(this.HueRange[1]-this.HueRange[0])/i,n=(this.SaturationRange[1]-this.SaturationRange[0])/i,a=(this.ValueRange[1]-this.ValueRange[0])/i,r=(this.AlphaRange[1]-this.AlphaRange[0])/i):t=n=a=r=0;for(var l=0;l<=i;l++){var s=this.HueRange[0]+l*t,u=this.SaturationRange[0]+l*n,d=this.ValueRange[0]+l*a,c=this.AlphaRange[0]+l*r,f=o(s,u,d),g=[];switch(this.Ramp){case"scurve":g[0]=Math.floor(127.5*(1+Math.cos((1-f[0])*Math.PI))),g[1]=Math.floor(127.5*(1+Math.cos((1-f[1])*Math.PI))),g[2]=Math.floor(127.5*(1+Math.cos((1-f[2])*Math.PI))),g[3]=Math.floor(255*c);break;case"linear":g[0]=Math.floor(255*f[0]+.5),g[1]=Math.floor(255*f[1]+.5),g[2]=Math.floor(255*f[2]+.5),g[3]=Math.floor(255*c+.5);break;case"sqrt":g[0]=Math.floor(255*Math.sqrt(f[0])+.5),g[1]=Math.floor(255*Math.sqrt(f[1])+.5),g[2]=Math.floor(255*Math.sqrt(f[2])+.5),g[3]=Math.floor(255*Math.sqrt(c)+.5);break;default:throw new Error("Invalid Ramp value (".concat(this.Ramp,")"))}this.Table.push(g)}this.buildSpecialColors()}}},{key:"buildSpecialColors",value:function(){var e=this.NumberOfColors,t=e+0,n=e+1,a=e+2;this.UseBelowRangeColor||0===e?this.Table[t]=this.BelowRangeColor:this.Table[t]=this.Table[0],this.UseAboveRangeColor||0===e?this.Table[n]=this.AboveRangeColor:this.Table[n]=this.Table[e-1],this.Table[a]=this.NaNColor}},{key:"mapValue",value:function(e){var t=this.getIndex(e);if(t<0)return this.NaNColor;if(0===t){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(t===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[t]}},{key:"getIndex",value:function(e){var t={Range:[]};if(t.MaxIndex=this.NumberOfColors-1,t.Shift=-this.TableRange[0],this.TableRange[1]<=this.TableRange[0]?t.Scale=Number.MAX_VALUE:t.Scale=t.MaxIndex/(this.TableRange[1]-this.TableRange[0]),t.Range[0]=this.TableRange[0],t.Range[1]=this.TableRange[1],isNaN(e))return-1;var n=function(e,t){var n;return n=e<t.Range[0]?t.MaxIndex+0+1.5:e>t.Range[1]?t.MaxIndex+1+1.5:(e+t.Shift)*t.Scale,Math.floor(n)}(e,t);return n===this.NumberOfColors+0?n=0:n===this.NumberOfColors+1&&(n=this.NumberOfColors-1),n}},{key:"setTableValue",value:function(e,t){if(5===arguments.length&&(t=Array.prototype.slice.call(arguments,1)),e<0)throw new Error("Can't set the table value for negative index (".concat(e,")"));e>=this.NumberOfColors&&new Error("Index ".concat(e," is greater than the number of colors ").concat(this.NumberOfColors)),this.Table[e]=t,0!==e&&e!==this.NumberOfColors-1||this.buildSpecialColors()}}],n&&a(t.prototype,n),e}();t.default=r},"./disable.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./triggerEvent.js"),r=n("./events.js");t.default=function(e){if(void 0===e)throw new Error("disable: element must not be undefined");for(var t=Object(a.getEnabledElements)(),n=0;n<t.length;n++)if(t[n].element===e){var i={element:e};Object(o.default)(e,r.default.ELEMENT_DISABLED,i),Object(o.default)(r.events,r.default.ELEMENT_DISABLED,i),t[n].element.removeChild(t[n].canvas),t[n].canvas=void 0,t.splice(n,1);break}}},"./displayImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/getDefaultViewport.js"),r=n("./updateImage.js"),i=n("./internal/now.js"),l=n("./layers.js"),s=n("./triggerEvent.js"),u=n("./events.js");t.default=function(e,t,n){if(void 0===e)throw new Error("displayImage: parameter element must not be undefined");if(void 0===t)throw new Error("displayImage: parameter image must not be undefined");var d,c=Object(a.getEnabledElement)(e),f=c.image;if(c.image=t,c.layers&&c.layers.length&&Object(l.setLayerImage)(e,t),void 0===c.viewport&&(c.viewport=Object(o.default)(c.canvas,t)),n)for(var g in n)null!==n[g]&&(c.viewport[g]=n[g]);void 0!==c.lastImageTimeStamp&&(d=(1e3/(Object(i.default)()-c.lastImageTimeStamp)).toFixed()),c.lastImageTimeStamp=Object(i.default)();var m={viewport:c.viewport,element:c.element,image:c.image,oldImage:f,enabledElement:c,frameRate:d};Object(s.default)(c.element,u.default.NEW_IMAGE,m),Object(r.default)(e)}},"./draw.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/drawImage.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);Object(o.default)(t)}},"./drawInvalidated.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/drawImage.js");t.default=function(){for(var e=Object(a.getEnabledElements)(),t=0;t<e.length;t++){var n=e[t];!0===n.invalid&&Object(o.default)(n,!0)}}},"./enable.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./resize.js"),r=n("./internal/drawImageSync.js"),i=n("./internal/requestAnimationFrame.js"),l=n("./internal/tryEnableWebgl.js"),s=n("./triggerEvent.js"),u=n("./generateUUID.js"),d=n("./events.js"),c=n("./internal/getCanvas.js");t.default=function(e,t){if(void 0===e)throw new Error("enable: parameter element cannot be undefined");t&&t.renderer&&"webgl"===t.renderer.toLowerCase()&&Object(l.default)(t);var n={element:e,canvas:Object(c.default)(e),image:void 0,invalid:!1,needsRedraw:!0,options:Object.assign({},t),layers:[],data:{},renderingTools:{},uuid:Object(u.default)()};Object(a.addEnabledElement)(n),Object(s.default)(d.events,d.default.ELEMENT_ENABLED,n),Object(o.default)(e,!0),function e(t){if(void 0!==n.canvas){var a={enabledElement:n,timestamp:t};Object(s.default)(n.element,d.default.PRE_RENDER,a),n.needsRedraw&&function(e){return void 0!==e.image||e.layers.length>0}(n)&&Object(r.default)(n,n.invalid),Object(i.default)(e)}}()}},"./enabledElementData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getElementData",(function(){return o})),n.d(t,"removeElementData",(function(){return r}));var a=n("./enabledElements.js");function o(e,t){var n=Object(a.getEnabledElement)(e);return!1===n.data.hasOwnProperty(t)&&(n.data[t]={}),n.data[t]}function r(e,t){delete Object(a.getEnabledElement)(e).data[t]}},"./enabledElements.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getEnabledElement",(function(){return o})),n.d(t,"addEnabledElement",(function(){return r})),n.d(t,"getEnabledElementsByImageId",(function(){return i})),n.d(t,"getEnabledElements",(function(){return l}));var a=[];function o(e){if(void 0===e)throw new Error("getEnabledElement: parameter element must not be undefined");for(var t=0;t<a.length;t++)if(a[t].element===e)return a[t];throw new Error("element not enabled")}function r(e){if(void 0===e)throw new Error("getEnabledElement: enabledElement element must not be undefined");a.push(e)}function i(e){var t=[];return a.forEach((function(n){n.image&&n.image.imageId===e&&t.push(n)})),t}function l(){return a}},"./events.js":function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n.r(t),n.d(t,"events",(function(){return o})),t.default={NEW_IMAGE:"cornerstonenewimage",INVALIDATED:"cornerstoneinvalidated",PRE_RENDER:"cornerstoneprerender",IMAGE_CACHE_MAXIMUM_SIZE_CHANGED:"cornerstoneimagecachemaximumsizechanged",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",IMAGE_CACHE_FULL:"cornerstoneimagecachefull",IMAGE_CACHE_CHANGED:"cornerstoneimagecachechanged",WEBGL_TEXTURE_REMOVED:"cornerstonewebgltextureremoved",WEBGL_TEXTURE_CACHE_FULL:"cornerstonewebgltexturecachefull",IMAGE_LOADED:"cornerstoneimageloaded",IMAGE_LOAD_PROGRESS:"cornerstoneimageloadprogress",IMAGE_LOAD_FAILED:"cornerstoneimageloadfailed",ELEMENT_RESIZED:"cornerstoneelementresized",IMAGE_RENDERED:"cornerstoneimagerendered",LAYER_ADDED:"cornerstonelayeradded",LAYER_REMOVED:"cornerstonelayerremoved",ACTIVE_LAYER_CHANGED:"cornerstoneactivelayerchanged",ELEMENT_DISABLED:"cornerstoneelementdisabled",ELEMENT_ENABLED:"cornerstoneelementenabled"};var o=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={},this.namespaces={}}var t,n;return t=e,(n=[{key:"addEventNamespaceListener",value:function(e,t){e.indexOf(".")<=0||(this.namespaces[e]=t,this.addEventListener(e.split(".")[0],t))}},{key:"removeEventNamespaceListener",value:function(e){e.indexOf(".")<=0||!this.namespaces[e]||(this.removeEventListener(e.split(".")[0],this.namespaces[e]),delete this.namespaces[e])}},{key:"addEventListener",value:function(e,t){e.indexOf(".")>0?this.addEventNamespaceListener(e,t):(e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t))}},{key:"removeEventListener",value:function(e,t){if(e.indexOf(".")>0)this.removeEventNamespaceListener(e);else if(e in this.listeners)for(var n=this.listeners[e],a=0,o=n.length;a<o;a++)if(n[a]===t)return void n.splice(a,1)}},{key:"dispatchEvent",value:function(e){if(!(e.type in this.listeners))return!0;for(var t=this.listeners[e.type].slice(),n=0,a=t.length;n<a;n++)t[n].call(this,e);return!e.defaultPrevented}}])&&a(t.prototype,n),e}())},"./falseColorMapping.js":function(e,t,n){"use strict";n.r(t),n.d(t,"convertImageToFalseColorImage",(function(){return l})),n.d(t,"convertToFalseColorImage",(function(){return s})),n.d(t,"restoreImage",(function(){return i}));var a=n("./enabledElements.js"),o=n("./pixelDataToFalseColorData.js"),r=n("./colors/colormap.js");function i(e){return!(!e.restore||"function"!=typeof e.restore||(e.restore(),0))}function l(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n=(t=function(e){return e&&"string"==typeof e&&(e=Object(r.getColormap)(e)),e}(t)).getId();if(e.colormapId===n)return!1;if(i(e),n){var a=e.minPixelValue||0,l=e.maxPixelValue||255;e.restore=function(e){if(e.restore)return e.restore;var t=e.color,n=e.rgba,a=e.cachedLut,o=e.slope,r=e.windowWidth,i=e.windowCenter,l=e.minPixelValue,s=e.maxPixelValue;return function(){if(e.color=t,e.rgba=n,e.cachedLut=a,e.slope=o,e.windowWidth=r,e.windowCenter=i,e.minPixelValue=l,e.maxPixelValue=s,e.origPixelData){var u=e.origPixelData;e.getPixelData=function(){return u}}e.origPixelData=void 0,e.colormapId=void 0,e.falseColor=void 0}}(e);var s=t.createLookupTable();s.setTableRange(a,l),Object(o.default)(e,s);var u=function(e){for(var t,n=Number.MAX_VALUE,a=Number.MIN_VALUE,o=e.length,r=0;r<o;r++)n=n<(t=e[r])?n:t,a=a>t?a:t;return{minPixelValue:n,maxPixelValue:a}}(e.getPixelData());e.minPixelValue=u.minPixelValue,e.maxPixelValue=u.maxPixelValue,e.windowWidth=255,e.windowCenter=128,e.colormapId=n}return!0}function s(e,t){return l(Object(a.getEnabledElement)(e).image,t)}},"./fitToWindow.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./updateImage.js"),r=n("./internal/getImageFitScale.js");t.default=function(e){var t=Object(a.getEnabledElement)(e),n=t.image;t.viewport.scale=Object(r.default)(t.canvas,n,t.viewport.rotation).scaleFactor,t.viewport.translation.x=0,t.viewport.translation.y=0,Object(o.default)(e)}},"./generateUUID.js":function(e,t,n){"use strict";n.r(t),t.default=function(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"x.x.x.x.x.x.xxxx.xxx.x.x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}},"./getDefaultViewportForImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/getDefaultViewport.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(o.default)(n.canvas,t)}},"./getImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e){return Object(a.getEnabledElement)(e).image}},"./getPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./getStoredPixels.js"),r=n("./internal/getModalityLUT.js");t.default=function(e,t,n,i,l){var s=Object(o.default)(e,t,n,i,l),u=Object(a.getEnabledElement)(e),d=Object(r.default)(u.image.slope,u.image.intercept,u.viewport.modalityLUT);return s.map(d)}},"./getStoredPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e,t,n,o,r){if(void 0===e)throw new Error("getStoredPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);for(var i=Object(a.getEnabledElement)(e),l=[],s=0,u=i.image.getPixelData(),d=0;d<r;d++)for(var c=0;c<o;c++){var f=(d+n)*i.image.columns+(c+t);l[s++]=u[f]}return l}},"./getViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e){var t=Object(a.getEnabledElement)(e).viewport;if(void 0!==t)return Object.assign({},t)}},"./imageCache.js":function(e,t,n){"use strict";n.r(t),n.d(t,"cachedImages",(function(){return s})),n.d(t,"setMaximumSizeBytes",(function(){return u})),n.d(t,"putImageLoadObject",(function(){return c})),n.d(t,"getImageLoadObject",(function(){return f})),n.d(t,"removeImageLoadObject",(function(){return g})),n.d(t,"getCacheInfo",(function(){return m})),n.d(t,"purgeCache",(function(){return h})),n.d(t,"changeImageIdCacheSize",(function(){return v}));var a=n("./events.js"),o=n("./triggerEvent.js"),r=1073741824,i=0,l={},s=[];function u(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");r=e,Object(o.default)(a.events,a.default.IMAGE_CACHE_MAXIMUM_SIZE_CHANGED),d()}function d(){if(!(i<=r)){for(s.sort((function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0}));i>r;){var e=s[s.length-1].imageId;g(e),Object(o.default)(a.events,a.default.IMAGE_CACHE_PROMISE_REMOVED,{imageId:e})}var t=m();Object(o.default)(a.events,a.default.IMAGE_CACHE_FULL,t)}}function c(e,t){if(void 0===e)throw new Error("putImageLoadObject: imageId must not be undefined");if(void 0===t.promise)throw new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");if(!0===l.hasOwnProperty(e))throw new Error("putImageLoadObject: imageId already in cache");if(t.cancelFn&&"function"!=typeof t.cancelFn)throw new Error("putImageLoadObject: imageLoadObject.cancelFn must be a function");var n={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};l[e]=n,s.push(n),t.promise.then((function(e){if(-1!==s.indexOf(n)){if(n.loaded=!0,n.image=e,void 0===e.sizeInBytes)throw new Error("putImageLoadObject: image.sizeInBytes must not be undefined");if(void 0===e.sizeInBytes.toFixed)throw new Error("putImageLoadObject: image.sizeInBytes is not a number");n.sizeInBytes=e.sizeInBytes,i+=n.sizeInBytes;var t={action:"addImage",image:n};Object(o.default)(a.events,a.default.IMAGE_CACHE_CHANGED,t),n.sharedCacheKey=e.sharedCacheKey,d()}}),(function(){var t=l[e];s.splice(s.indexOf(t),1),delete l[e]}))}function f(e){if(void 0===e)throw new Error("getImageLoadObject: imageId must not be undefined");var t=l[e];if(void 0!==t)return t.timeStamp=Date.now(),t.imageLoadObject}function g(e){if(void 0===e)throw new Error("removeImageLoadObject: imageId must not be undefined");var t=l[e];if(void 0===t)throw new Error("removeImageLoadObject: imageId was not present in imageCache");s.splice(s.indexOf(t),1),i-=t.sizeInBytes;var n,r={action:"deleteImage",image:t};Object(o.default)(a.events,a.default.IMAGE_CACHE_CHANGED,r),(n=t.imageLoadObject).promise.then((function(){n.decache&&n.decache()}),(function(){n.decache&&n.decache()})),delete l[e]}function m(){return{maximumSizeInBytes:r,cacheSizeInBytes:i,numberOfImagesCached:s.length}}function h(){for(;s.length>0;)g(s[0].imageId)}function v(e,t){var n=l[e];n&&n.imageLoadObject.promise.then((function(e){var r=t-e.sizeInBytes;e.sizeInBytes=t,n.sizeInBytes=t,i+=r;var l={action:"changeImageSize",image:e};Object(o.default)(a.events,a.default.IMAGE_CACHE_CHANGED,l)}))}t.default={imageCache:l,cachedImages:s,setMaximumSizeBytes:u,putImageLoadObject:c,getImageLoadObject:f,removeImageLoadObject:g,getCacheInfo:m,purgeCache:h,changeImageIdCacheSize:v}},"./imageLoader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"loadImage",(function(){return u})),n.d(t,"loadAndCacheImage",(function(){return d})),n.d(t,"registerImageLoader",(function(){return c})),n.d(t,"registerUnknownImageLoader",(function(){return f}));var a,o=n("./imageCache.js"),r=n("./events.js"),i=n("./triggerEvent.js"),l={};function s(e,t){var n=e.indexOf(":"),o=e.substring(0,n),s=l[o];if(null==s){if(void 0!==a)return a(e);throw new Error("loadImageFromImageLoader: no image loader for imageId")}var u=s(e,t);return u.promise.then((function(e){Object(i.default)(r.events,r.default.IMAGE_LOADED,{image:e})}),(function(t){var n={imageId:e,error:t};Object(i.default)(r.events,r.default.IMAGE_LOAD_FAILED,n)})),u}function u(e,t){if(void 0===e)throw new Error("loadImage: parameter imageId must not be undefined");var n=Object(o.getImageLoadObject)(e);return void 0!==n?n.promise:s(e,t).promise}function d(e,t){if(void 0===e)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");var n=Object(o.getImageLoadObject)(e);return void 0!==n||(n=s(e,t),Object(o.putImageLoadObject)(e,n)),n.promise}function c(e,t){l[e]=t}function f(e){var t=a;return a=e,t}},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js");n.d(t,"EVENTS",(function(){return a.default})),n.d(t,"events",(function(){return a.events}));var o=n("./enabledElements.js");n.d(t,"getEnabledElement",(function(){return o.getEnabledElement})),n.d(t,"addEnabledElement",(function(){return o.addEnabledElement})),n.d(t,"getEnabledElementsByImageId",(function(){return o.getEnabledElementsByImageId})),n.d(t,"getEnabledElements",(function(){return o.getEnabledElements}));var r=n("./layers.js");n.d(t,"addLayer",(function(){return r.addLayer})),n.d(t,"removeLayer",(function(){return r.removeLayer})),n.d(t,"getLayer",(function(){return r.getLayer})),n.d(t,"getLayers",(function(){return r.getLayers})),n.d(t,"getVisibleLayers",(function(){return r.getVisibleLayers})),n.d(t,"setActiveLayer",(function(){return r.setActiveLayer})),n.d(t,"getActiveLayer",(function(){return r.getActiveLayer})),n.d(t,"purgeLayers",(function(){return r.purgeLayers})),n.d(t,"setLayerImage",(function(){return r.setLayerImage}));var i=n("./falseColorMapping.js");n.d(t,"convertImageToFalseColorImage",(function(){return i.convertImageToFalseColorImage})),n.d(t,"convertToFalseColorImage",(function(){return i.convertToFalseColorImage})),n.d(t,"restoreImage",(function(){return i.restoreImage}));var l=n("./enabledElementData.js");n.d(t,"getElementData",(function(){return l.getElementData})),n.d(t,"removeElementData",(function(){return l.removeElementData}));var s=n("./imageLoader.js");n.d(t,"loadImage",(function(){return s.loadImage})),n.d(t,"loadAndCacheImage",(function(){return s.loadAndCacheImage})),n.d(t,"registerImageLoader",(function(){return s.registerImageLoader})),n.d(t,"registerUnknownImageLoader",(function(){return s.registerUnknownImageLoader}));var u=n("./requestPool/imageLoadPoolManager.ts");n.d(t,"imageLoadPoolManager",(function(){return u.default}));var d=n("./requestPool/imageRetrievalPoolManager.ts");n.d(t,"imageRetrievalPoolManager",(function(){return d.default}));var c=n("./requestPool/RequestPoolManager.ts");n.d(t,"RequestPoolManager",(function(){return c.RequestPoolManager}));var f=n("./canvasToPixel.js");n.d(t,"canvasToPixel",(function(){return f.default}));var g=n("./colors/index.js");n.d(t,"colors",(function(){return g.default}));var m=n("./disable.js");n.d(t,"disable",(function(){return m.default}));var h=n("./displayImage.js");n.d(t,"displayImage",(function(){return h.default}));var v=n("./draw.js");n.d(t,"draw",(function(){return v.default}));var p=n("./internal/drawImage.js");n.d(t,"drawImage",(function(){return p.default}));var b=n("./drawInvalidated.js");n.d(t,"drawInvalidated",(function(){return b.default}));var j=n("./enable.js");n.d(t,"enable",(function(){return j.default}));var x=n("./fitToWindow.js");n.d(t,"fitToWindow",(function(){return x.default}));var y=n("./internal/generateLut.js");n.d(t,"generateLut",(function(){return y.default}));var T=n("./internal/getDefaultViewport.js");n.d(t,"getDefaultViewport",(function(){return T.default}));var w=n("./getDefaultViewportForImage.js");n.d(t,"getDefaultViewportForImage",(function(){return w.default}));var C=n("./internal/getDisplayedArea.js");n.d(t,"getDisplayedArea",(function(){return C.default}));var O=n("./getImage.js");n.d(t,"getImage",(function(){return O.default}));var E=n("./getPixels.js");n.d(t,"getPixels",(function(){return E.default}));var M=n("./getStoredPixels.js");n.d(t,"getStoredPixels",(function(){return M.default}));var I=n("./getViewport.js");n.d(t,"getViewport",(function(){return I.default}));var S=n("./imageCache.js");n.d(t,"imageCache",(function(){return S.default}));var P=n("./internal/index.js");n.d(t,"internal",(function(){return P.default}));var _=n("./invalidate.js");n.d(t,"invalidate",(function(){return _.default}));var D=n("./invalidateImageId.js");n.d(t,"invalidateImageId",(function(){return D.default}));var L=n("./metaData.js");n.d(t,"metaData",(function(){return L.default}));var k=n("./pageToPixel.js");n.d(t,"pageToPixel",(function(){return k.default}));var A=n("./pixelDataToFalseColorData.js");n.d(t,"pixelDataToFalseColorData",(function(){return A.default}));var R=n("./pixelToCanvas.js");n.d(t,"pixelToCanvas",(function(){return R.default}));var H=n("./rendering/renderColorImage.js");n.d(t,"renderColorImage",(function(){return H.renderColorImage}));var B=n("./rendering/renderGrayscaleImage.js");n.d(t,"renderGrayscaleImage",(function(){return B.renderGrayscaleImage}));var U=n("./rendering/renderLabelMapImage.js");n.d(t,"renderLabelMapImage",(function(){return U.renderLabelMapImage}));var F=n("./rendering/renderPseudoColorImage.js");n.d(t,"renderPseudoColorImage",(function(){return F.renderPseudoColorImage}));var N=n("./rendering/renderToCanvas.js");n.d(t,"renderToCanvas",(function(){return N.default}));var V=n("./rendering/renderWebImage.js");n.d(t,"renderWebImage",(function(){return V.renderWebImage}));var z=n("./rendering/index.js");n.d(t,"rendering",(function(){return z.default}));var W=n("./internal/requestAnimationFrame.js");n.d(t,"requestAnimationFrame",(function(){return W.default}));var q=n("./reset.js");n.d(t,"reset",(function(){return q.default}));var G=n("./resize.js");n.d(t,"resize",(function(){return G.default}));var Y=n("./internal/setDefaultViewport.js");n.d(t,"setDefaultViewport",(function(){return Y.default}));var X=n("./setToPixelCoordinateSystem.js");n.d(t,"setToPixelCoordinateSystem",(function(){return X.default}));var Z=n("./setViewport.js");n.d(t,"setViewport",(function(){return Z.default}));var K=n("./internal/storedColorPixelDataToCanvasImageData.js");n.d(t,"storedColorPixelDataToCanvasImageData",(function(){return K.default}));var J=n("./internal/storedPixelDataToCanvasImageData.js");n.d(t,"storedPixelDataToCanvasImageData",(function(){return J.default}));var $=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataColorLUT",(function(){return $.default}));var Q=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataPseudocolorLUT",(function(){return Q.default}));var ee=n("./triggerEvent.js");n.d(t,"triggerEvent",(function(){return ee.default}));var te=n("./updateImage.js");n.d(t,"updateImage",(function(){return te.default}));var ne=n("./webgl/index.js");n.d(t,"webGL",(function(){return ne.default}));var ae={drawImage:p.default,generateLut:y.default,getDefaultViewport:T.default,requestAnimationFrame:W.default,storedPixelDataToCanvasImageData:J.default,storedColorPixelDataToCanvasImageData:K.default,storedPixelDataToCanvasImageDataColorLUT:$.default,storedPixelDataToCanvasImageDataPseudocolorLUT:Q.default,internal:P.default,renderLabelMapImage:U.renderLabelMapImage,renderPseudoColorImage:F.renderPseudoColorImage,renderColorImage:H.renderColorImage,renderGrayscaleImage:B.renderGrayscaleImage,renderWebImage:V.renderWebImage,renderToCanvas:N.default,canvasToPixel:f.default,disable:m.default,displayImage:h.default,draw:v.default,drawInvalidated:b.default,enable:j.default,getElementData:l.getElementData,removeElementData:l.removeElementData,getEnabledElement:o.getEnabledElement,addEnabledElement:o.addEnabledElement,getEnabledElementsByImageId:o.getEnabledElementsByImageId,getEnabledElements:o.getEnabledElements,addLayer:r.addLayer,removeLayer:r.removeLayer,getLayer:r.getLayer,getLayers:r.getLayers,getVisibleLayers:r.getVisibleLayers,setActiveLayer:r.setActiveLayer,getActiveLayer:r.getActiveLayer,purgeLayers:r.purgeLayers,setLayerImage:r.setLayerImage,fitToWindow:x.default,getDefaultViewportForImage:w.default,getDisplayedArea:C.default,setDefaultViewport:Y.default,getImage:O.default,getPixels:E.default,getStoredPixels:M.default,getViewport:I.default,loadImage:s.loadImage,loadAndCacheImage:s.loadAndCacheImage,registerImageLoader:s.registerImageLoader,registerUnknownImageLoader:s.registerUnknownImageLoader,invalidate:_.default,invalidateImageId:D.default,pageToPixel:k.default,pixelToCanvas:R.default,reset:q.default,resize:G.default,setToPixelCoordinateSystem:X.default,setViewport:Z.default,updateImage:te.default,pixelDataToFalseColorData:A.default,rendering:z.default,imageCache:S.default,metaData:L.default,webGL:ne.default,colors:g.default,convertImageToFalseColorImage:i.convertImageToFalseColorImage,convertToFalseColorImage:i.convertToFalseColorImage,restoreImage:i.restoreImage,EVENTS:a.default,events:a.events,triggerEvent:ee.default,imageLoadPoolManager:u.default,imageRetrievalPoolManager:d.default,RequestPoolManager:c.RequestPoolManager};t.default=ae},"./internal/calculateTransform.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/transform.js"),o=n("./internal/getDisplayedArea.js");t.default=function(e,t){var n=new a.Transform;n.translate(e.canvas.width/2,e.canvas.height/2);var r=e.viewport.rotation;0!==r&&n.rotate(r*Math.PI/180);var i=e.viewport.scale,l=e.viewport.scale,s=Object(o.default)(e.image,e.viewport),u=s.tlhc.x-1,d=s.tlhc.y-1,c=s.brhc.x-u,f=s.brhc.y-d;if("NONE"===s.presentationSizeMode)e.image.rowPixelSpacing<e.image.columnPixelSpacing?i*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(l*=e.image.rowPixelSpacing/e.image.columnPixelSpacing);else if(i=s.columnPixelSpacing,l=s.rowPixelSpacing,"SCALE TO FIT"===s.presentationSizeMode){var g=e.canvas.height/(f*l),m=e.canvas.width/(c*i);i=l=Math.min(m,g),s.rowPixelSpacing<s.columnPixelSpacing?i*=s.columnPixelSpacing/s.rowPixelSpacing:s.columnPixelSpacing<s.rowPixelSpacing&&(l*=s.rowPixelSpacing/s.columnPixelSpacing)}return n.scale(i,l),0!==r&&n.rotate(-r*Math.PI/180),n.translate(e.viewport.translation.x,e.viewport.translation.y),0!==r&&n.rotate(r*Math.PI/180),void 0!==t&&n.scale(t,t),e.viewport.hflip&&n.scale(-1,1),e.viewport.vflip&&n.scale(1,-1),n.translate(-c/2,-f/2),n.translate(-u,-d),n}},"./internal/computeAutoVoi.js":function(e,t,n){"use strict";function a(e,t){if(!function(e){return e.voiLUT&&e.voiLUT.lut&&e.voiLUT.lut.length>0||void 0!==e.voi.windowWidth&&void 0!==e.voi.windowCenter}(e)){var n=t.maxPixelValue*t.slope+t.intercept,a=t.minPixelValue*t.slope+t.intercept,o=n-a,r=(n+a)/2;void 0===e.voi?e.voi={windowWidth:o,windowCenter:r}:(e.voi.windowWidth=o,e.voi.windowCenter=r)}}n.r(t),n.d(t,"default",(function(){return a}))},"./internal/createViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/setDefaultViewport.js");t.default=function(){return Object.assign({},{scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:void 0},a.state.viewport)}},"./internal/drawCompositeImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./layers.js"),o=n("./rendering/renderGrayscaleImage.js"),r=n("./rendering/renderColorImage.js"),i=n("./rendering/renderPseudoColorImage.js"),l=n("./rendering/renderLabelMapImage.js"),s=n("./setToPixelCoordinateSystem.js"),u=n("./internal/getDisplayedArea.js");function d(e){var t=e.syncProps||{};t.originalScale=e.viewport.scale,e.syncProps=t}t.default=function(e,t){var n=e.element,c=Object(a.getLayers)(n),f=Object(a.getActiveLayer)(n),g=Object(a.getVisibleLayers)(n),m=!e.lastSyncViewportsState&&e.syncViewports;e.lastSyncViewportsState=e.syncViewports,m&&c.forEach((function(e){e.viewport&&d(e)})),!0===e.syncViewports&&function(e,t){e.forEach((function(e){if(e!==t&&e.viewport&&t.viewport){e.syncProps||d(e);var n,a,o=(a=e,(n=t).syncProps||d(n),a.syncProps||d(a),a.syncProps.originalScale/n.syncProps.originalScale);e.viewport.scale=t.viewport.scale*o,e.viewport.rotation=t.viewport.rotation,e.viewport.translation={x:t.viewport.translation.x/o,y:t.viewport.translation.y/o},e.viewport.hflip=t.viewport.hflip,e.viewport.vflip=t.viewport.vflip}}))}(g,f);var h=e.canvas.getContext("2d",{desynchronized:!0});h.setTransform(1,0,0,1,0,0),h.fillStyle="black",h.fillRect(0,0,e.canvas.width,e.canvas.height),function(e,t,n){t.forEach((function(t,a){if(t.image){e.save(),t.canvas=e.canvas,Object(s.default)(t,e);var d=t.viewport.colormap||t.options.colormap,c=t.viewport.labelmap,f=t.invalid||n;if(d&&""!==d&&!0===c)Object(l.addLabelMapLayer)(t,f);else if(d&&""!==d)Object(i.addPseudoColorLayer)(t,f);else if(!0===t.image.color)Object(r.addColorLayer)(t,f);else{var g=0===a;Object(o.addGrayscaleLayer)(t,f,g)}t.options&&t.options.opacity?e.globalAlpha=t.options.opacity:e.globalAlpha=1,t.options&&t.options.fillStyle&&(e.fillStyle=t.options.fillStyle),e.imageSmoothingEnabled=!t.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled;var m=Object(u.default)(t.image,t.viewport),h=m.tlhc.x-1,v=m.tlhc.y-1,p=m.brhc.x-h,b=m.brhc.y-v;e.drawImage(t.canvas,h,v,p,b,h,v,p,b),e.restore(),t.invalid=!1}}))}(h,g,t)}},"./internal/drawImage.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.needsRedraw=!0,t&&(e.invalid=!0)}},"./internal/drawImageSync.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js"),o=n("./internal/drawCompositeImage.js"),r=n("./rendering/renderColorImage.js"),i=n("./rendering/renderGrayscaleImage.js"),l=n("./rendering/renderPseudoColorImage.js"),s=n("./rendering/renderLabelMapImage.js"),u=n("./triggerEvent.js"),d=n("./events.js");t.default=function(e,t){var n=e.image,c=e.element,f=e.layers||[];if(e.canvas&&e.image){var g=Object(a.default)();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},f&&f.length)Object(o.default)(e,t);else if(n){var m=n.render;m||(m=e.viewport.colormap&&""!==e.viewport.colormap&&!0===e.image.labelmap?s.renderLabelMapImage:e.viewport.colormap&&""!==e.viewport.colormap?l.renderPseudoColorImage:n.color?r.renderColorImage:i.renderGrayscaleImage),m(e,t)}var h=Object(a.default)()-g,v={viewport:e.viewport,element:c,image:n,enabledElement:e,canvasContext:e.canvas.getContext("2d",{desynchronized:!0}),renderTimeInMs:h};n.stats.lastRenderTime=h,e.invalid=!1,e.needsRedraw=!1,Object(u.default)(c,d.default.IMAGE_RENDERED,v)}}},"./internal/generateColorLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getVOILut.js");t.default=function(e,t,n,o,r){var i=e.maxPixelValue,l=e.minPixelValue,s=Math.min(l,0);if(void 0===e.cachedLut){var u=i-s+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(u)}var d=e.cachedLut.lutArray,c=Object(a.default)(t,n,r);if(!0===o)for(var f=l;f<=i;f++)d[f+-s]=255-c(f);else for(var g=l;g<=i;g++)d[g+-s]=c(g);return d}},"./internal/generateLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getModalityLUT.js"),o=n("./internal/getVOILut.js");t.default=function(e,t,n,r,i,l){var s=e.maxPixelValue,u=e.minPixelValue,d=Math.min(u,0);if(void 0===e.cachedLut){var c=s-d+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(c)}var f=e.cachedLut.lutArray,g=Boolean(e.slope%1)||Boolean(e.intercept%1),m=Object(a.default)(e.slope,e.intercept,i),h=Object(o.default)(t,n,l,g);if(!0===r)for(var v=u;v<=s;v++)f[v+-d]=255-h(m(v));else for(var p=u;p<=s;p++)f[p+-d]=h(m(p));return f}},"./internal/getCanvas.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a="cornerstone-canvas";function o(e){var t="canvas.".concat(a);return e.querySelector(t)||function(e){var t=document.createElement("canvas");return t.style.display="block",t.classList.add(a),e.appendChild(t),t}(e)}},"./internal/getDefaultViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/createViewport.js"),o=n("./internal/getImageFitScale.js");t.default=function(e,t){if(void 0===e)throw new Error("getDefaultViewport: parameter canvas must not be undefined");return void 0===t?Object(a.default)():{scale:Object(o.default)(e,t,0).scaleFactor,translation:{x:0,y:0},voi:{windowWidth:t.windowWidth,windowCenter:t.windowCenter},invert:t.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT,colormap:t.colormap,labelmap:Boolean(t.labelmap),displayedArea:void 0}}},"./internal/getDisplayedArea.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&t.displayedArea)return t.displayedArea;if(void 0===e)throw new Error("getDisplayedArea: parameter image must not be undefined");return{tlhc:{x:1,y:1},brhc:{x:e.columns,y:e.rows},rowPixelSpacing:void 0===e.rowPixelSpacing?1:e.rowPixelSpacing,columnPixelSpacing:void 0===e.columnPixelSpacing?1:e.columnPixelSpacing,presentationSizeMode:"NONE"}}},"./internal/getFillStyle.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=(e.viewport||{}).invert,n=(e.options||{}).fillStyle;return-1!==["black","white"].indexOf(n)&&t?"white":"black"}},"./internal/getImageFitScale.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/validator.js"),o=n("./internal/getImageSize.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(a.validateParameterUndefinedOrNull)(e,"getImageScale: parameter windowSize must not be undefined"),Object(a.validateParameterUndefinedOrNull)(t,"getImageScale: parameter image must not be undefined");var r=Object(o.default)(t,n),i=t.rowPixelSpacing||1,l=t.columnPixelSpacing||1,s=1,u=1;i<l?u=l/i:s=i/l;var d=e.height/r.height/s,c=e.width/r.width/u;return{verticalScale:d,horizontalScale:c,scaleFactor:Math.min(c,d)}}},"./internal/getImageSize.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/validator.js");function o(e){return!(null==e||0===e||180===e)}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(a.validateParameterUndefinedOrNull)(e,"getImageSize: parameter image must not be undefined"),Object(a.validateParameterUndefinedOrNull)(e.width,"getImageSize: parameter image must have width"),Object(a.validateParameterUndefinedOrNull)(e.height,"getImageSize: parameter image must have height"),o(t)?{height:e.width,width:e.height}:{width:e.width,height:e.height}}},"./internal/getModalityLUT.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return n?function(e){var t=e.lut[0],n=e.lut[e.lut.length-1],a=e.firstValueMapped+e.lut.length;return function(o){return o<e.firstValueMapped?t:o>=a?n:e.lut[o]}}(n):function(e,t){return function(n){return n*e+t}}(e,t)}},"./internal/getTransform.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/calculateTransform.js");t.default=function(e){return Object(a.default)(e)}},"./internal/getVOILut.js":function(e,t,n){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}n.r(t),t.default=function(e,t,n,o){return n?function(e,t){var n,o=Math.max.apply(Math,(n=e.lut,function(e){if(Array.isArray(e))return a(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).toString(2).length-8,r=e.lut[0]>>o,i=e.lut[e.lut.length-1]>>o,l=e.firstValueMapped+e.lut.length-1;return function(n){return n<e.firstValueMapped?r:n>=l?i:t?e.lut[Math.round(n)-e.firstValueMapped]>>o:e.lut[n-e.firstValueMapped]>>o}}(n,o):function(e,t){return function(n){return 255*((n-t)/e+.5)}}(e,t)}},"./internal/guid.js":function(e,t,n){"use strict";function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.r(t),t.default=function(){return"".concat(a()+a(),"-").concat(a(),"-").concat(a(),"-").concat(a(),"-").concat(a()).concat(a()).concat(a())}},"./internal/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/transform.js"),o=n("./internal/calculateTransform.js"),r=n("./internal/drawImage.js"),i=n("./internal/generateLut.js"),l=n("./internal/getDefaultViewport.js"),s=n("./internal/getTransform.js"),u=n("./internal/requestAnimationFrame.js"),d=n("./internal/setDefaultViewport.js"),c=n("./internal/storedColorPixelDataToCanvasImageData.js"),f=n("./internal/storedPixelDataToCanvasImageData.js"),g=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),m=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),h=n("./internal/storedPixelDataToCanvasImageDataRGBA.js");t.default={drawImage:r.default,generateLut:i.default,getDefaultViewport:l.default,requestAnimationFrame:u.default,setDefaultViewport:d.default,storedPixelDataToCanvasImageData:f.default,storedPixelDataToCanvasImageDataRGBA:h.default,storedPixelDataToCanvasImageDataColorLUT:g.default,storedPixelDataToCanvasImageDataPseudocolorLUT:m.default,storedColorPixelDataToCanvasImageData:c.default,getTransform:s.default,calculateTransform:o.default,Transform:a.Transform}},"./internal/now.js":function(e,t,n){"use strict";n.r(t),t.default=function(){return window.performance?performance.now():Date.now()}},"./internal/requestAnimationFrame.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return window.requestAnimationFrame(e)||window.webkitRequestAnimationFrame(e)||window.mozRequestAnimationFrame(e)||window.oRequestAnimationFrame(e)||window.msRequestAnimationFrame(e)||function(e){window.setTimeout(e,1e3/60)}(e)}},"./internal/setDefaultViewport.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",(function(){return a}));var a={viewport:{}};t.default=function(e){a.viewport=e||{}}},"./internal/storedColorPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var o=Object(a.default)(),r=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-o;var i=e.minPixelValue,l=0,s=0,u=r.length;if(o=Object(a.default)(),i<0)for(;s<u;)n[l++]=t[r[s++]+-i],n[l++]=t[r[s++]+-i],n[l]=t[r[s]+-i],s+=2,l+=2;else for(;s<u;)n[l++]=t[r[s++]],n[l++]=t[r[s++]],n[l]=t[r[s]],s+=2,l+=2;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-o}},"./internal/storedPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var o=Object(a.default)(),r=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-o;var i=r.length,l=e.minPixelValue,s=3,u=0;if(o=Object(a.default)(),r instanceof Int16Array)if(l<0)for(;u<i;)n[s]=t[r[u++]+-l],s+=4;else for(;u<i;)n[s]=t[r[u++]],s+=4;else if(r instanceof Uint16Array)for(;u<i;)n[s]=t[r[u++]],s+=4;else if(l<0)for(;u<i;)n[s]=t[r[u++]+-l],s+=4;else for(;u<i;)n[s]=t[r[u++]],s+=4;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-o}},"./internal/storedPixelDataToCanvasImageDataColorLUT.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/index.js"),o=n("./internal/now.js");t.default=function(e,t,n){var r=Object(o.default)(),i=e.getPixelData();e.stats.lastGetPixelDataTime=Object(o.default)()-r;var l,s,u=i.length,d=e.minPixelValue,c=0,f=0;if(r=Object(o.default)(),s=t instanceof a.default.LookupTable?t.Table:t,d<0)for(;f<u;)l=s[i[f++]+-d],n[c++]=l[0],n[c++]=l[1],n[c++]=l[2],n[c++]=l[3];else for(;f<u;)l=s[i[f++]],n[c++]=l[0],n[c++]=l[1],n[c++]=l[2],n[c++]=l[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(o.default)()-r}},"./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/index.js"),o=n("./internal/now.js");t.default=function(e,t,n,r){var i=Object(o.default)(),l=e.getPixelData();e.stats.lastGetPixelDataTime=Object(o.default)()-i;var s,u,d=l.length,c=e.minPixelValue,f=0,g=0;if(i=Object(o.default)(),u=n instanceof a.default.LookupTable?n.Table:n,c<0)for(;g<d;)s=u[t[l[g++]+-c]],r[f++]=s[0],r[f++]=s[1],r[f++]=s[2],r[f++]=s[3];else for(;g<d;)s=u[t[l[g++]]],r[f++]=s[0],r[f++]=s[1],r[f++]=s[2],r[f++]=s[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(o.default)()-i}},"./internal/storedPixelDataToCanvasImageDataRGBA.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var o=Object(a.default)(),r=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-o;var i,l=r.length,s=e.minPixelValue,u=0,d=0;if(o=Object(a.default)(),r instanceof Int16Array)if(s<0)for(;d<l;)i=t[r[d++]+-s],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else for(;d<l;)i=t[r[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else if(r instanceof Uint16Array)for(;d<l;)i=t[r[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else if(s<0)for(;d<l;)i=t[r[d++]+-s],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else for(;d<l;)i=t[r[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-o}},"./internal/storedRGBAPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var o=Object(a.default)(),r=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-o;var i=e.minPixelValue,l=0,s=0,u=r.length;if(o=Object(a.default)(),i<0)for(;s<u;)n[l++]=t[r[s++]+-i],n[l++]=t[r[s++]+-i],n[l++]=t[r[s++]+-i],n[l++]=r[s++];else for(;s<u;)n[l++]=t[r[s++]],n[l++]=t[r[s++]],n[l++]=t[r[s++]],n[l++]=r[s++];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-o}},"./internal/transform.js":function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n.r(t),n.d(t,"Transform",(function(){return o}));var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}var t,n;return t=e,(n=[{key:"reset",value:function(){this.m=[1,0,0,1,0,0]}},{key:"clone",value:function(){var t=new e;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}},{key:"multiply",value:function(e){var t=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],a=this.m[0]*e.m[2]+this.m[2]*e.m[3],o=this.m[1]*e.m[2]+this.m[3]*e.m[3],r=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],i=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];this.m[0]=t,this.m[1]=n,this.m[2]=a,this.m[3]=o,this.m[4]=r,this.m[5]=i}},{key:"invert",value:function(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,a=-this.m[2]*e,o=this.m[0]*e,r=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),i=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=t,this.m[1]=n,this.m[2]=a,this.m[3]=o,this.m[4]=r,this.m[5]=i}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),a=this.m[0]*t+this.m[2]*n,o=this.m[1]*t+this.m[3]*n,r=this.m[0]*-n+this.m[2]*t,i=this.m[1]*-n+this.m[3]*t;this.m[0]=a,this.m[1]=o,this.m[2]=r,this.m[3]=i}},{key:"translate",value:function(e,t){this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t}},{key:"scale",value:function(e,t){this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t}},{key:"transformPoint",value:function(e,t){var n=e,a=t;return{x:e=n*this.m[0]+a*this.m[2]+this.m[4],y:t=n*this.m[1]+a*this.m[3]+this.m[5]}}}])&&a(t.prototype,n),e}()},"./internal/tryEnableWebgl.js":function(e,t,n){"use strict";n.r(t);var a=n("./webgl/index.js");t.default=function(e){return a.default.renderer.isWebGLAvailable()?(a.default.renderer.initRenderer(),e.renderer="webgl",e.desynchronized=!0,e.preserveDrawingBuffer=!0,!0):(console.error("WebGL not available, falling back to Canvas renderer"),delete e.renderer,delete e.preserveDrawingBuffer,!1)}},"./internal/validator.js":function(e,t,n){"use strict";function a(e,t){if(void 0===e)throw new Error(t)}function o(e,t){if(null==e)throw new Error(t)}n.r(t),n.d(t,"validateParameterUndefined",(function(){return a})),n.d(t,"validateParameterUndefinedOrNull",(function(){return o}))},"./invalidate.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./triggerEvent.js"),r=n("./events.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);t.invalid=!0,t.needsRedraw=!0;var n={element:e};Object(o.default)(e,r.default.INVALIDATED,n)}},"./invalidateImageId.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/drawImage.js");t.default=function(e){Object(a.getEnabledElementsByImageId)(e).forEach((function(e){Object(o.default)(e,!0)}))}},"./layers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rescaleImage",(function(){return c})),n.d(t,"addLayer",(function(){return f})),n.d(t,"removeLayer",(function(){return g})),n.d(t,"getLayer",(function(){return m})),n.d(t,"getLayers",(function(){return h})),n.d(t,"getVisibleLayers",(function(){return v})),n.d(t,"setActiveLayer",(function(){return p})),n.d(t,"setLayerImage",(function(){return b})),n.d(t,"getActiveLayer",(function(){return j})),n.d(t,"purgeLayers",(function(){return x}));var a=n("./internal/guid.js"),o=n("./enabledElements.js"),r=n("./internal/getDefaultViewport.js"),i=n("./internal/getDisplayedArea.js"),l=n("./updateImage.js"),s=n("./triggerEvent.js"),u=n("./events.js");function d(e,t,n){var a=t.element,o={viewport:t.viewport,element:t.element,image:t.image,enabledElement:t,layerId:n};Object(s.default)(a,e,o)}function c(e,t){if(e.layerId===t.layerId)throw new Error("rescaleImage: both arguments represent the same layer");var n=e.image,a=t.image;if(n.imageId&&a.imageId){var o=Object(i.default)(a,t.viewport),r=Object(i.default)(n,e.viewport),l=o.columnPixelSpacing*a.width/(r.columnPixelSpacing*n.width),s=t.viewport.scale/e.viewport.scale*l;t.viewport.scale=e.viewport.scale*s}}function f(e,t,n){var i,l=Object(a.default)(),s=Object(o.getEnabledElement)(e),f=s.layers;t&&(i=Object(r.default)(s.canvas,t),n&&n.viewport&&(i=Object.assign(i,n.viewport))),!1!==s.syncViewports&&(s.syncViewports=!0);var g={image:t,layerId:l,viewport:i,options:n||{},renderingTools:{}};return f.length&&t&&c(f[0],g),f.push(g),d(u.default.LAYER_ADDED,s,l),1===f.length&&t&&p(e,l),l}function g(e,t){var n=Object(o.getEnabledElement)(e),a=n.layers,r=n.layers.findIndex((function(e){return e.layerId===t}));-1!==r&&(a.splice(r,1),t===n.activeLayerId&&a.length&&p(e,a[0].layerId),d(u.default.LAYER_REMOVED,n,t))}function m(e,t){return Object(o.getEnabledElement)(e).layers.find((function(e){return e.layerId===t}))}function h(e){return Object(o.getEnabledElement)(e).layers}function v(e){return Object(o.getEnabledElement)(e).layers.filter((function(e){return e.options&&!1!==e.options.visible&&0!==e.options.opacity}))}function p(e,t){var n=Object(o.getEnabledElement)(e);if(n.activeLayerId!==t){var a=n.layers.findIndex((function(e){return e.layerId===t}));if(-1===a)throw new Error("setActiveLayer: layer not found in layers array");var r=n.layers[a];if(!r.image)throw new Error("setActiveLayer: layer with undefined image cannot be set as active.");n.activeLayerId=t,n.image=r.image,n.viewport=r.viewport,Object(l.default)(e),d(u.default.ACTIVE_LAYER_CHANGED,n,t)}}function b(e,t,n){var a,i=Object(o.getEnabledElement)(e),l=i.layers[0];if(!(a=n?m(e,n):j(e)))throw new Error("setLayerImage: Layer not found");if(a.image=t,t){if(!a.viewport){var s=Object(r.default)(i.canvas,t);a.options&&a.options.viewport&&(a.viewport=Object.assign(s,a.options.viewport)),l.layerId!==n&&c(l,a)}}else a.viewport=void 0}function j(e){var t=Object(o.getEnabledElement)(e);return t.layers.find((function(e){return e.layerId===t.activeLayerId}))}function x(e){var t=Object(o.getEnabledElement)(e);t.layers=[],delete t.activeLayerId,delete t.lastSyncViewportsState}},"./metaData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addProvider",(function(){return o})),n.d(t,"removeProvider",(function(){return r}));var a=[];function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(t=0;t<a.length&&!(a[t].priority<=n);t++);a.splice(t,0,{priority:n,provider:e})}function r(e){for(var t=0;t<a.length;t++)if(a[t].provider===e){a.splice(t,1);break}}t.default={addProvider:o,removeProvider:r,get:function(e,t){for(var n=0;n<a.length;n++){var o=a[n].provider(e,t);if(void 0!==o)return o}}}},"./pageToPixel.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/getTransform.js");t.default=function(e,t,n){var r=Object(a.getEnabledElement)(e);if(void 0===r.image)throw new Error("image has not been loaded yet");var i=e.getBoundingClientRect(),l={x:t-i.left-window.pageXOffset,y:n-i.top-window.pageYOffset},s=Object(o.default)(r);return s.invert(),s.transformPoint(l.x,l.y)}},"./pixelDataToFalseColorData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./colors/index.js");function o(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n,o,r=e.minPixelValue,i=0,l=0,s=e.width*e.height,u=e.origPixelData||e.getPixelData(),d=new Uint8Array(4*s);if(e.color=!0,e.falseColor=!0,e.origPixelData=u,t instanceof a.default.LookupTable)for(t.build();l<s;)n=u[l++],o=t.mapValue(n),d[i++]=o[0],d[i++]=o[1],d[i++]=o[2],d[i++]=o[3];else if(r<0)for(;l<s;)n=u[l++],d[i++]=t[n+-r][0],d[i++]=t[n+-r][1],d[i++]=t[n+-r][2],d[i++]=t[n+-r][3];else for(;l<s;)n=u[l++],d[i++]=t[n][0],d[i++]=t[n][1],d[i++]=t[n][2],d[i++]=t[n][3];e.rgba=!0,e.cachedLut=void 0,e.render=void 0,e.slope=1,e.intercept=0,e.minPixelValue=0,e.maxPixelValue=255,e.windowWidth=255,e.windowCenter=128,e.getPixelData=function(){return d}}},"./pixelToCanvas.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(o.default)(n).transformPoint(t.x,t.y)}},"./rendering/doesImageNeedToBeRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.renderingTools.lastRenderedImageId,a=e.renderingTools.lastRenderedViewport;return t.imageId!==n||!a||a.windowCenter!==e.viewport.voi.windowCenter||a.windowWidth!==e.viewport.voi.windowWidth||a.invert!==e.viewport.invert||a.rotation!==e.viewport.rotation||a.hflip!==e.viewport.hflip||a.vflip!==e.viewport.vflip||a.modalityLUT!==e.viewport.modalityLUT||a.voiLUT!==e.viewport.voiLUT||a.colormap!==e.viewport.colormap}},"./rendering/getLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/computeAutoVoi.js"),o=n("./rendering/lutMatches.js"),r=n("./internal/generateLut.js");t.default=function(e,t,n){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&Object(o.default)(e.cachedLut.modalityLUT,t.modalityLUT)&&Object(o.default)(e.cachedLut.voiLUT,t.voiLUT)&&e.cachedLut.invert===t.invert&&!0!==n||(Object(a.default)(t,e),Object(r.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert,t.modalityLUT,t.voiLUT),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.voiLUT=t.voiLUT,e.cachedLut.modalityLUT=t.modalityLUT),e.cachedLut.lutArray}},"./rendering/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./rendering/renderColorImage.js"),o=n("./rendering/renderGrayscaleImage.js"),r=n("./rendering/renderWebImage.js"),i=n("./rendering/renderPseudoColorImage.js"),l=n("./rendering/renderLabelMapImage.js"),s=n("./rendering/renderToCanvas.js");t.default={colorImage:a.renderColorImage,grayscaleImage:o.renderGrayscaleImage,webImage:r.renderWebImage,pseudoColorImage:i.renderPseudoColorImage,labelMapImage:l.renderLabelMapImage,toCanvas:s.default}},"./rendering/initializeRenderCanvas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.renderingTools.renderCanvas;n.width=t.width,n.height=t.height;var a=n.getContext("2d",{desynchronized:!0});a.fillStyle="white",a.fillRect(0,0,n.width,n.height);var o=a.getImageData(0,0,t.width,t.height);e.renderingTools.renderCanvasContext=a,e.renderingTools.renderCanvasData=o}},"./rendering/lutMatches.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return!e&&!t||!(!e||!t)&&e.id===t.id}},"./rendering/renderColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderColorImage",(function(){return h})),n.d(t,"addColorLayer",(function(){return v}));var a=n("./internal/now.js"),o=n("./internal/getFillStyle.js"),r=n("./internal/generateColorLut.js"),i=n("./internal/storedColorPixelDataToCanvasImageData.js"),l=n("./internal/storedRGBAPixelDataToCanvasImageData.js"),s=n("./setToPixelCoordinateSystem.js"),u=n("./webgl/index.js"),d=n("./rendering/doesImageNeedToBeRendered.js"),c=n("./rendering/initializeRenderCanvas.js"),f=n("./rendering/saveLastRendered.js"),g=n("./internal/getDisplayedArea.js");function m(e,t,n){var o=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&o||(e.renderingTools.renderCanvas=document.createElement("canvas"));var s=e.renderingTools.renderCanvas;if(255===e.viewport.voi.windowWidth&&128===e.viewport.voi.windowCenter&&!1===e.viewport.invert&&t.getCanvas&&t.getCanvas())return t.getCanvas();if(!1===Object(d.default)(e,t)&&!0!==n)return s;s.width===t.width&&s.height===t.height||Object(c.default)(e,t);var u=Object(a.default)(),f=function(e,t){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&e.cachedLut.invert===t.invert||(Object(r.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert),e.cachedLut.lutArray}(t,e.viewport);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(a.default)()-u;var g=e.renderingTools.renderCanvasData,m=e.renderingTools.renderCanvasContext;return t.rgba?Object(l.default)(t,f,g.data):Object(i.default)(t,f,g.data),u=Object(a.default)(),m.putImageData(g,0,0),t.stats.lastPutImageDataTime=Object(a.default)()-u,s}function h(e,t){if(void 0===e)throw new Error("renderColorImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderColorImage: image must be loaded before it can be drawn");var a,r=e.canvas.getContext("2d",{desynchronized:!0});r.setTransform(1,0,0,1,0,0),r.fillStyle=Object(o.default)(e),r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(s.default)(e,r),a=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?u.default.renderer.render(e):m(e,n,t);var i=Object(g.default)(e.image,e.viewport),l=i.tlhc.x-1,d=i.tlhc.y-1,c=i.brhc.x-l,h=i.brhc.y-d;r.drawImage(a,l,d,c,h,l,d,c,h),e.renderingTools=Object(f.default)(e)}function v(e,t){if(void 0===e)throw new Error("addColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addColorLayer: image must be loaded before it can be drawn");n.rgba=!0,e.canvas=m(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(f.default)(e)}},"./rendering/renderGrayscaleImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderGrayscaleImage",(function(){return h})),n.d(t,"addGrayscaleLayer",(function(){return v}));var a=n("./internal/getFillStyle.js"),o=n("./internal/storedPixelDataToCanvasImageData.js"),r=n("./internal/storedPixelDataToCanvasImageDataRGBA.js"),i=n("./setToPixelCoordinateSystem.js"),l=n("./internal/now.js"),s=n("./webgl/index.js"),u=n("./rendering/getLut.js"),d=n("./rendering/doesImageNeedToBeRendered.js"),c=n("./rendering/initializeRenderCanvas.js"),f=n("./rendering/saveLastRendered.js"),g=n("./internal/getDisplayedArea.js");function m(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&!i||(e.renderingTools.renderCanvas=document.createElement("canvas"),Object(c.default)(e,t));var s=e.renderingTools.renderCanvas;if(!1===Object(d.default)(e,t)&&!0!==n)return s;s.width===t.width&&s.height===t.height||Object(c.default)(e,t);var f=Object(l.default)(),g=Object(u.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(l.default)()-f;var m=e.renderingTools.renderCanvasData,h=e.renderingTools.renderCanvasContext;return a?Object(o.default)(t,g,m.data):Object(r.default)(t,g,m.data),f=Object(l.default)(),h.putImageData(m,0,0),t.stats.lastPutImageDataTime=Object(l.default)()-f,s}function h(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var o,r=e.canvas.getContext("2d",{desynchronized:!0});r.setTransform(1,0,0,1,0,0),r.fillStyle=Object(a.default)(e),r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(i.default)(e,r),o=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?s.default.renderer.render(e):m(e,n,t);var l=Object(g.default)(e.image,e.viewport),u=l.tlhc.x-1,d=l.tlhc.y-1,c=l.brhc.x-u,h=l.brhc.y-d;r.drawImage(o,u,d,c,h,u,d,c,h),e.renderingTools=Object(f.default)(e)}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)throw new Error("addGrayscaleLayer: layer parameter must not be undefined");var a=e.image;if(void 0===a)throw new Error("addGrayscaleLayer: image must be loaded before it can be drawn");e.canvas=m(e,a,t,n);var o=e.canvas.getContext("2d",{desynchronized:!0});o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,e.renderingTools=Object(f.default)(e)}},"./rendering/renderLabelMapImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderLabelMapImage",(function(){return g})),n.d(t,"addLabelMapLayer",(function(){return m}));var a=n("./setToPixelCoordinateSystem.js"),o=n("./internal/now.js"),r=n("./internal/getFillStyle.js"),i=n("./rendering/initializeRenderCanvas.js"),l=n("./rendering/saveLastRendered.js"),s=n("./rendering/doesImageNeedToBeRendered.js"),u=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),d=n("./colors/index.js"),c=n("./internal/getDisplayedArea.js");function f(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,r=e.viewport.colormap||e.options.colormap;if(e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),r&&"string"==typeof r&&(r=d.default.getColormap(r)),!r)throw new Error("renderLabelMapImage: colormap not found.");var l=r.getId();if(!1===Object(s.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===l)return a;a.width===t.width&&a.height===t.height||Object(i.default)(e,t);var c=Object(o.default)();e.renderingTools.colorLut&&!n&&e.renderingTools.colormapId===l||(e.renderingTools.colorLut=r.createLookupTable(),e.renderingTools.colormapId=l),t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(o.default)()-c;var f=e.renderingTools.colorLut,g=e.renderingTools.renderCanvasData,m=e.renderingTools.renderCanvasContext;return Object(u.default)(t,f,g.data),c=Object(o.default)(),m.putImageData(g,0,0),t.stats.lastPutImageDataTime=Object(o.default)()-c,a}function g(e,t){if(void 0===e)throw new Error("renderLabelMapImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderLabelMapImage: image must be loaded before it can be drawn");var o=e.canvas.getContext("2d",{desynchronized:!0});o.setTransform(1,0,0,1,0,0),o.fillStyle=Object(r.default)(e),o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(a.default)(e,o);var i=f(e,n,t),s=Object(c.default)(e.image,e.viewport),u=s.tlhc.x-1,d=s.tlhc.y-1,g=s.brhc.x-u,m=s.brhc.y-d;o.drawImage(i,u,d,g,m,u,d,g,m),e.renderingTools=Object(l.default)(e)}function m(e,t){if(void 0===e)throw new Error("addLabelMapLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addLabelMapLayer: image must be loaded before it can be drawn");e.canvas=f(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(l.default)(e)}},"./rendering/renderPseudoColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderPseudoColorImage",(function(){return m})),n.d(t,"addPseudoColorLayer",(function(){return h}));var a=n("./setToPixelCoordinateSystem.js"),o=n("./internal/now.js"),r=n("./internal/getFillStyle.js"),i=n("./rendering/initializeRenderCanvas.js"),l=n("./rendering/getLut.js"),s=n("./rendering/saveLastRendered.js"),u=n("./rendering/doesImageNeedToBeRendered.js"),d=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),c=n("./colors/index.js"),f=n("./internal/getDisplayedArea.js");function g(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,r=e.viewport.colormap||e.options.colormap;if(e.options&&e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),r&&"string"==typeof r&&(r=c.default.getColormap(r)),!r)throw new Error("renderPseudoColorImage: colormap not found.");var s=r.getId();if(!1===Object(u.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===s)return a;a.width===t.width&&a.height===t.height||Object(i.default)(e,t);var f=Object(o.default)();e.renderingTools.colorLut&&!n&&e.renderingTools.colormapId===s||(r.setNumberOfColors(256),e.renderingTools.colorLut=r.createLookupTable(),e.renderingTools.colormapId=s);var g=Object(l.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(o.default)()-f;var m=e.renderingTools.colorLut,h=e.renderingTools.renderCanvasData,v=e.renderingTools.renderCanvasContext;return Object(d.default)(t,g,m,h.data),f=Object(o.default)(),v.putImageData(h,0,0),t.stats.lastPutImageDataTime=Object(o.default)()-f,a}function m(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var o=e.canvas.getContext("2d",{desynchronized:!0});o.setTransform(1,0,0,1,0,0),o.fillStyle=Object(r.default)(e),o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(a.default)(e,o);var i=g(e,n,t),l=Object(f.default)(e.image,e.viewport),u=l.tlhc.x-1,d=l.tlhc.y-1,c=l.brhc.x-u,m=l.brhc.y-d;o.drawImage(i,u,d,c,m,u,d,c,m),e.renderingTools=Object(s.default)(e)}function h(e,t){if(void 0===e)throw new Error("addPseudoColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addPseudoColorLayer: image must be loaded before it can be drawn");e.canvas=g(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(s.default)(e)}},"./rendering/renderToCanvas.js":function(e,t,n){"use strict";n.r(t);var a=n("./triggerEvent.js"),o=n("./events.js"),r=n("./internal/drawImageSync.js"),i=n("./internal/getDefaultViewport.js"),l=n("./internal/tryEnableWebgl.js");function s(e,t,n,a){return{element:e,canvas:e,image:t,invalid:!0,needsRedraw:!0,options:n,layers:[],data:{},renderingTools:{},viewport:a}}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===e)throw new Error("renderToCanvas: parameter canvas cannot be undefined");u&&u.renderer&&"webgl"===u.renderer.toLowerCase()&&Object(l.default)(u);var d=Object(i.default)(e,t);n&&Object.assign(d,n);var c=s(e,t,u,d),f={enabledElement:c,timestamp:Date.now()};Object(a.default)(c.element,o.default.PRE_RENDER,f),Object(r.default)(c,c.invalid)}},"./rendering/renderWebImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderWebImage",(function(){return i}));var a=n("./setToPixelCoordinateSystem.js"),o=n("./rendering/renderColorImage.js"),r=n("./internal/getDisplayedArea.js");function i(e,t){if(void 0===e)throw new Error("renderWebImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderWebImage: image must be loaded before it can be drawn");if(e.viewport.voi.windowWidth===e.image.windowWidth&&e.viewport.voi.windowCenter===e.image.windowCenter&&!1===e.viewport.invert){var i=e.canvas.getContext("2d",{desynchronized:!0});i.setTransform(1,0,0,1,0,0),i.fillStyle="black",i.fillRect(0,0,e.canvas.width,e.canvas.height),i.imageSmoothingEnabled=!e.viewport.pixelReplication,i.mozImageSmoothingEnabled=i.imageSmoothingEnabled,Object(a.default)(e,i);var l=Object(r.default)(e.image,e.viewport),s=l.tlhc.x-1,u=l.tlhc.y-1,d=l.brhc.x-s,c=l.brhc.y-u;i.drawImage(n.getImage(),s,u,d,c,s,u,d,c)}else Object(o.renderColorImage)(e,t)}},"./rendering/saveLastRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.image.imageId,n=e.viewport,a=e.image.color;return e.renderingTools.lastRenderedImageId=t,e.renderingTools.lastRenderedIsColor=a,e.renderingTools.lastRenderedViewport={windowCenter:n.voi.windowCenter,windowWidth:n.voi.windowWidth,invert:n.invert,rotation:n.rotation,hflip:n.hflip,vflip:n.vflip,modalityLUT:n.modalityLUT,voiLUT:n.voiLUT,colormap:n.colormap},e.renderingTools}},"./requestPool/RequestPoolManager.ts":function(e,t,n){"use strict";function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){s=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(s)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"RequestPoolManager",(function(){return l}));var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"requestPool",void 0),i(this,"awake",void 0),i(this,"numRequests",void 0),i(this,"maxNumRequests",void 0),i(this,"grabDelay",void 0),i(this,"timeoutHandle",void 0),this.requestPool={interaction:{0:[]},thumbnail:{0:[]},prefetch:{0:[]}},this.awake=!1,this.grabDelay=5,this.numRequests={interaction:0,thumbnail:0,prefetch:0},this.maxNumRequests={interaction:6,thumbnail:6,prefetch:5}}var t,n;return t=e,n=[{key:"destroy",value:function(){this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}},{key:"addRequest",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r={requestFn:e,type:t,additionalDetails:n};void 0===this.requestPool[t][a]&&(this.requestPool[t][a]=[]),o?this.requestPool[t][a].unshift(r):this.requestPool[t][a].push(r),this.awake||(this.awake=!0,this.startGrabbing())}},{key:"filterRequests",value:function(e){var t=this;Object.keys(this.requestPool).forEach((function(n){var a=t.requestPool[n];Object.keys(a).forEach((function(t){a[t]=a[t].filter((function(t){return e(t)}))}))}))}},{key:"clearRequestStack",value:function(e){if(!this.requestPool[e])throw new Error("No category for the type ".concat(e," found"));this.requestPool[e]={0:[]}}},{key:"sendRequest",value:function(e){var t=this,n=e.requestFn,a=e.type;this.numRequests[a]++,this.awake=!0,n().finally((function(){t.numRequests[a]--,t.startAgain()}))}},{key:"startGrabbing",value:function(){for(var e=this.maxNumRequests.interaction+this.maxNumRequests.thumbnail+this.maxNumRequests.prefetch-(this.numRequests.interaction+this.numRequests.thumbnail+this.numRequests.prefetch),t=0;t<e;t++){var n=this.getNextRequest();if(!1===n)break;n&&this.sendRequest(n)}}},{key:"startAgain",value:function(){var e=this;this.awake&&(this.grabDelay?this.timeoutHandle=window.setTimeout((function(){e.startGrabbing()}),this.grabDelay):this.startGrabbing())}},{key:"getSortedPriorityGroups",value:function(e){var t=this;return Object.keys(this.requestPool[e]).map(Number).filter((function(n){return t.requestPool[e][n].length})).sort()}},{key:"getNextRequest",value:function(){var e,t=this.getSortedPriorityGroups("interaction"),n=a(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(this.requestPool.interaction[o].length&&this.numRequests.interaction<this.maxNumRequests.interaction)return this.requestPool.interaction[o].shift()}}catch(e){n.e(e)}finally{n.f()}var r,i=this.getSortedPriorityGroups("thumbnail"),l=a(i);try{for(l.s();!(r=l.n()).done;){var s=r.value;if(this.requestPool.thumbnail[s].length&&this.numRequests.thumbnail<this.maxNumRequests.thumbnail)return this.requestPool.thumbnail[s].shift()}}catch(e){l.e(e)}finally{l.f()}var u,d=this.getSortedPriorityGroups("prefetch"),c=a(d);try{for(c.s();!(u=c.n()).done;){var f=u.value;if(this.requestPool.prefetch[f].length&&this.numRequests.prefetch<this.maxNumRequests.prefetch)return this.requestPool.prefetch[f].shift()}}catch(e){c.e(e)}finally{c.f()}return t.length||i.length||d.length||(this.awake=!1),!1}},{key:"getRequestPool",value:function(){return this.requestPool}}],n&&r(t.prototype,n),e}()},"./requestPool/imageLoadPoolManager.ts":function(e,t,n){"use strict";n.r(t);var a=new(n("./requestPool/RequestPoolManager.ts").RequestPoolManager);a.maxNumRequests={interaction:1e3,thumbnail:1e3,prefetch:1e3},a.grabDelay=0,t.default=a},"./requestPool/imageRetrievalPoolManager.ts":function(e,t,n){"use strict";n.r(t);var a=new(n("./requestPool/RequestPoolManager.ts").RequestPoolManager);a.maxNumRequests={interaction:20,thumbnail:20,prefetch:20},a.grabDelay=0,t.default=a},"./reset.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getDefaultViewport.js"),o=n("./enabledElements.js"),r=n("./updateImage.js");t.default=function(e){var t=Object(o.getEnabledElement)(e);t.viewport=Object(a.default)(t.canvas,t.image),Object(r.default)(e)}},"./resize.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./fitToWindow.js"),r=n("./updateImage.js"),i=n("./triggerEvent.js"),l=n("./internal/getImageSize.js"),s=n("./events.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),u=n.canvas.width,d=n.canvas.height;!function(e,t){t.width!==e.clientWidth&&(t.width=e.clientWidth,t.style.width="".concat(e.clientWidth,"px")),t.height!==e.clientHeight&&(t.height=e.clientHeight,t.style.height="".concat(e.clientHeight,"px"))}(e,n.canvas);var c={element:e};Object(i.default)(e,s.default.ELEMENT_RESIZED,c),void 0!==n.image&&(t||function(e,t,n){var a=e.viewport.scale,o=Object(l.default)(e.image,e.viewport.rotation),r=Math.round(o.width*a),i=Math.round(o.height*a),s=e.viewport.translation.x,u=e.viewport.translation.y;return r===t&&i<=n||r<=t&&i===n&&0===s&&0===u}(n,u,d)?Object(o.default)(e):(function(e,t,n){var a=e.viewport.scale,o=e.canvas.width/t,r=e.canvas.height/n,i=Math.sqrt(o*r);e.viewport.scale=i*a}(n,u,d),Object(r.default)(e)))}},"./setToPixelCoordinateSystem.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/calculateTransform.js");t.default=function(e,t,n){if(void 0===e)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===t)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");var o=Object(a.default)(e,n);t.setTransform(o.m[0],o.m[1],o.m[2],o.m[3],o.m[4],o.m[5])}},"./setViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getDefaultViewport.js"),o=n("./enabledElements.js"),r=n("./updateImage.js");t.default=function(e,t){var n=Object(o.getEnabledElement)(e);if(void 0===n.viewport&&(n.viewport=Object(a.default)(n.canvas)),t)for(var i in t)null!==t[i]&&(n.viewport[i]=t[i]);n.viewport.voi.windowWidth&&(n.viewport.voi.windowWidth=Math.max(n.viewport.voi.windowWidth,1e-6)),n.viewport.scale&&(n.viewport.scale=Math.max(n.viewport.scale,1e-4)),n.viewport.rotation%=360,n.viewport.rotation<0&&(n.viewport.rotation+=360),n.image&&Object(r.default)(e)}},"./triggerEvent.js":function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",(function(){return a}))},"./updateImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),o=n("./internal/drawImage.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.getEnabledElement)(e);Object(o.default)(n,t)}},"./webgl/createProgramFromString.js":function(e,t,n){"use strict";function a(e,t,n){var a=e.createShader(n);if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost()){var o=e.getShaderInfoLog(a);console.error("Could not compile shader:\n".concat(o))}return a}n.r(t),t.default=function(e,t,n){return function(e,t,n){var a=e.createProgram();if(e.attachShader(a,t),e.attachShader(a,n),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS)&&!e.isContextLost()){var o=e.getProgramInfoLog(a);console.error("WebGL program filed to link:\n".concat(o))}return a}(e,a(e,t,e.VERTEX_SHADER),a(e,n,e.FRAGMENT_SHADER))}},"./webgl/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./webgl/renderer.js"),o=n("./webgl/createProgramFromString.js"),r=n("./webgl/textureCache.js"),i={createProgramFromString:o.default,renderer:{render:a.render,initRenderer:a.initRenderer,getRenderCanvas:a.getRenderCanvas,isWebGLAvailable:a.isWebGLAvailable},textureCache:r.default};Object.defineProperty(i,"isWebGLInitialized",{enumerable:!0,configurable:!1,get:function(){return a.isWebGLInitialized}}),t.default=i},"./webgl/renderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isWebGLInitialized",(function(){return c})),n.d(t,"getRenderCanvas",(function(){return f})),n.d(t,"initRenderer",(function(){return g})),n.d(t,"render",(function(){return p})),n.d(t,"isWebGLAvailable",(function(){return b}));var a,o,r,i=n("./webgl/shaders/index.js"),l=n("./webgl/vertexShader.js"),s=n("./webgl/textureCache.js"),u=n("./webgl/createProgramFromString.js"),d=document.createElement("canvas"),c=!1;function f(){return d}function g(){!0!==c&&function(e){a=null;try{var t={desynchronized:!0,preserveDrawingBuffer:!0};a=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),e.removeEventListener("webglcontextlost",m,!1),e.addEventListener("webglcontextlost",m,!1),e.removeEventListener("webglcontextrestored",h,!1),e.addEventListener("webglcontextrestored",h,!1)}catch(e){throw new Error("Error creating WebGL context")}return a||(console.error("Unable to initialize WebGL. Your browser may not support it."),a=null),a}(d)&&(r=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,r),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),o=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,o),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),function(){for(var e in i.shaders){var t=i.shaders[e];t.attributes={},t.uniforms={},t.vert=l.vertexShader,t.program=Object(u.default)(a,t.vert,t.frag),t.attributes.texCoordLocation=a.getAttribLocation(t.program,"a_texCoord"),a.enableVertexAttribArray(t.attributes.texCoordLocation),t.attributes.positionLocation=a.getAttribLocation(t.program,"a_position"),a.enableVertexAttribArray(t.attributes.positionLocation),t.uniforms.resolutionLocation=a.getUniformLocation(t.program,"u_resolution")}}(),c=!0)}function m(e){e.preventDefault(),console.warn("WebGL Context Lost!")}function h(e){e.preventDefault(),c=!1,s.default.purgeCache(),g()}function v(e){if(e.color)return"rgb";var t=e.getPixelData();return t instanceof Int16Array?"int16":t instanceof Uint16Array?"uint16":t instanceof Int8Array?"int8":"uint8"}function p(e){var t=e.image;d.width=t.width,d.height=t.height;var n=e.viewport,l=function(e){var t=v(e);return i.shaders.hasOwnProperty(t)?i.shaders[t]:i.shaders.rgb}(t),u=function(e){var t=s.default.getImageTexture(e.imageId);return t||(t=function(e){var t={uint8:a.LUMINANCE,int8:a.LUMINANCE_ALPHA,uint16:a.LUMINANCE_ALPHA,int16:a.RGB,rgb:a.RGB},n=v(e),o=t[n],r=a.createTexture();a.bindTexture(a.TEXTURE_2D,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.UNPACK_ALIGNMENT,1);var l=i.dataUtilities[n].storedPixelDataToImageData(e,e.width,e.height);return a.texImage2D(a.TEXTURE_2D,0,o,e.width,e.height,0,o,a.UNSIGNED_BYTE,l),{texture:r,sizeInBytes:e.width*e.height*{int8:1,uint16:2,int16:3,rgb:3}[n]}}(e),s.default.putImageTexture(e,t)),t.texture}(t);return function(e,t,n,i,l){for(var s in a.clearColor(1,0,0,1),a.viewport(0,0,i,l),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.useProgram(e.program),a.bindBuffer(a.ARRAY_BUFFER,o),a.vertexAttribPointer(e.attributes.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,r),a.vertexAttribPointer(e.attributes.positionLocation,2,a.FLOAT,!1,0,0),t){var u=a.getUniformLocation(e.program,s);if(u){var d=t[s],c=d.type,f=d.value;"i"===c?a.uniform1i(u,f):"f"===c?a.uniform1f(u,f):"2f"===c&&a.uniform2f(u,f[0],f[1])}}!function(e,t,n){e.bufferData(e.ARRAY_BUFFER,new Float32Array([t,n,0,n,t,0,0,0]),e.STATIC_DRAW)}(a,i,l),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n),a.drawArrays(a.TRIANGLE_STRIP,0,4)}(l,{u_resolution:{type:"2f",value:[t.width,t.height]},wc:{type:"f",value:n.voi.windowCenter},ww:{type:"f",value:n.voi.windowWidth},slope:{type:"f",value:t.slope},intercept:{type:"f",value:t.intercept},minPixelValue:{type:"f",value:t.minPixelValue},invert:{type:"i",value:n.invert?1:0}},u,t.width,t.height),d}function b(){var e={failIfMajorPerformanceCaveat:!0};try{var t=document.createElement("canvas");return Boolean(window.WebGLRenderingContext)&&(t.getContext("webgl",e)||t.getContext("experimental-webgl",e))}catch(e){return!1}}},"./webgl/shaders/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"shaders",(function(){return s})),n.d(t,"dataUtilities",(function(){return u}));var a=n("./webgl/shaders/int16.js"),o=n("./webgl/shaders/int8.js"),r=n("./webgl/shaders/rgb.js"),i=n("./webgl/shaders/uint16.js"),l=n("./webgl/shaders/uint8.js"),s={int16:a.int16Shader,int8:o.int8Shader,rgb:r.rgbShader,uint16:i.uint16Shader,uint8:l.uint8Shader},u={int16:a.int16DataUtilities,int8:o.int8DataUtilities,rgb:r.rgbDataUtilities,uint16:i.uint16DataUtilities,uint8:l.uint8DataUtilities}},"./webgl/shaders/int16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int16DataUtilities",(function(){return o})),n.d(t,"int16Shader",(function(){return a}));var a={},o={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*3),a=0,o=0;o<t.length;o++){var r=Math.abs(t[o]);n[a++]=255&r,n[a++]=r>>8,n[a++]=t[o]<0?0:1}return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/int8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int8DataUtilities",(function(){return o})),n.d(t,"int8Shader",(function(){return a}));var a={},o={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),a=0,o=0;o<t.length;o++)n[a++]=t[o],n[a++]=t[o]<0?0:1;return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/rgb.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rgbDataUtilities",(function(){return o})),n.d(t,"rgbShader",(function(){return a}));var a={},o={storedPixelDataToImageData:function(e){var t=e.minPixelValue,n=0,a=0,o=e.width*e.height*4,r=e.width*e.height*3,i=e.getPixelData(),l=new Uint8Array(r);if(t<0)for(;a<o;)l[n++]=i[a++]+-t,l[n++]=i[a++]+-t,l[n++]=i[a++]+-t,a+=1;else for(;a<o;)l[n++]=i[a++],l[n++]=i[a++],l[n++]=i[a++],a+=1;return l}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}"},"./webgl/shaders/uint16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint16DataUtilities",(function(){return o})),n.d(t,"uint16Shader",(function(){return a}));var a={},o={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),a=0,o=0;o<t.length;o++){var r=t[o];n[a++]=255&r,n[a++]=r>>8}return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/uint8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint8DataUtilities",(function(){return o})),n.d(t,"uint8Shader",(function(){return a}));var a={},o={storedPixelDataToImageData:function(e){return e.getPixelData()}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/textureCache.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./triggerEvent.js"),r={},i=[],l=268435456,s=0;function u(){if(!(s<=l)){for(i.sort((function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0}));s>l;){var e=i[i.length-1];s-=e.sizeInBytes,delete r[e.imageId],i.pop(),Object(o.default)(a.events,a.default.WEBGL_TEXTURE_REMOVED,{imageId:e.imageId})}var t={maximumSizeInBytes:l,cacheSizeInBytes:s,numberOfImagesCached:i.length};Object(o.default)(a.events,a.default.WEBGL_TEXTURE_CACHE_FULL,t)}}t.default={purgeCache:function(){for(;i.length>0;){var e=i.pop();delete r[e.imageId]}s=0},getImageTexture:function(e){if(void 0===e)throw new Error("getImageTexture: imageId must not be undefined");var t=r[e];if(void 0!==t)return t.timeStamp=new Date,t.imageTexture},putImageTexture:function(e,t){var n=e.imageId;if(void 0===e)throw new Error("putImageTexture: image must not be undefined");if(void 0===n)throw new Error("putImageTexture: imageId must not be undefined");if(void 0===t)throw new Error("putImageTexture: imageTexture must not be undefined");if(!0===Object.prototype.hasOwnProperty.call(r,n))throw new Error("putImageTexture: imageId already in cache");var a={imageId:n,imageTexture:t,timeStamp:new Date,sizeInBytes:t.sizeInBytes};if(r[n]=a,i.push(a),void 0===t.sizeInBytes)throw new Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");if(void 0===t.sizeInBytes.toFixed)throw new Error("putImageTexture: imageTexture.sizeInBytes is not a number");s+=a.sizeInBytes,u()},removeImageTexture:function(e){if(void 0===e)throw new Error("removeImageTexture: imageId must not be undefined");var t=r[e];if(void 0===t)throw new Error("removeImageTexture: imageId must not be undefined");return i.splice(i.indexOf(t),1),s-=t.sizeInBytes,delete r[e],t.imageTexture},setMaximumSizeBytes:function(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");l=e,u()}}},"./webgl/vertexShader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"vertexShader",(function(){return a}));var a="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"}})},e.exports=t()},30:e=>{var t;window,t=function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(x[e]&&j[e]){for(var n in j[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--v&&0===p&&C()}}(e,n),t&&t(e,n)};var n,a=!0,o="0508e3ca1dab256990d7",r={},i=[],l=[];function s(e){var t=E[e];if(!t)return M;var a=function(a){return t.hot.active?(E[a]?-1===E[a].parents.indexOf(e)&&E[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),M(a)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return M[e]},set:function(t){M[e]=t}}};for(var r in M)Object.prototype.hasOwnProperty.call(M,r)&&"e"!==r&&"t"!==r&&Object.defineProperty(a,r,o(r));return a.e=function(e){return"ready"===c&&f("prepare"),p++,M.e(e).then(t,(function(e){throw t(),e}));function t(){p--,"prepare"===c&&(b[e]||w(e),0===p&&0===v&&C())}},a.t=function(e,t){return 1&t&&(e=a(e)),M.t(e,-2&t)},a}function u(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:T,apply:O,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:r[e]};return n=void 0,t}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var g,m,h,v=0,p=0,b={},j={},x={};function y(e){return+e+""===e?+e:e}function T(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise((function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,r=M.p+""+o+".hot-update.json";a.open("GET",r,!0),a.timeout=t,a.send(null)}catch(e){return n(e)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+r+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+r+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(e){return void n(e)}e(t)}}}))).then((function(e){if(!e)return f("idle"),null;j={},b={},x=e.c,h=e.h,f("prepare");var t=new Promise((function(e,t){g={resolve:e,reject:t}}));return m={},w("cornerstoneTools"),"prepare"===c&&0===p&&0===v&&C(),t}));var t}function w(e){x[e]?(j[e]=!0,v++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=M.p+""+e+"."+o+".hot-update.js",document.head.appendChild(t)}(e)):b[e]=!0}function C(){f("ready");var e=g;if(g=null,e)if(a)Promise.resolve().then((function(){return O(a)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(y(n));e.resolve(t)}}function O(t){if("ready"!==c)throw new Error("apply() is only allowed in ready status");var n,a,l,s,u;function d(e){for(var t=[e],n={},a=t.map((function(e){return{chain:[e],id:e}}));a.length>0;){var o=a.pop(),r=o.id,i=o.chain;if((s=E[r])&&!s.hot._selfAccepted){if(s.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:r};if(s.hot._main)return{type:"unaccepted",chain:i,moduleId:r};for(var l=0;l<s.parents.length;l++){var u=s.parents[l],d=E[u];if(d){if(d.hot._declinedDependencies[r])return{type:"declined",chain:i.concat([u]),moduleId:r,parentId:u};-1===t.indexOf(u)&&(d.hot._acceptedDependencies[r]?(n[u]||(n[u]=[]),g(n[u],[r])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var v={},p=[],b={},j=function(){console.warn("[HMR] unexpected require("+w.moduleId+") to disposed module")};for(var T in m)if(Object.prototype.hasOwnProperty.call(m,T)){var w;u=y(T);var C=!1,O=!1,I=!1,S="";switch((w=m[T]?d(u):{type:"disposed",moduleId:T}).chain&&(S="\nUpdate propagation: "+w.chain.join(" -> ")),w.type){case"self-declined":t.onDeclined&&t.onDeclined(w),t.ignoreDeclined||(C=new Error("Aborted because of self decline: "+w.moduleId+S));break;case"declined":t.onDeclined&&t.onDeclined(w),t.ignoreDeclined||(C=new Error("Aborted because of declined dependency: "+w.moduleId+" in "+w.parentId+S));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(w),t.ignoreUnaccepted||(C=new Error("Aborted because "+u+" is not accepted"+S));break;case"accepted":t.onAccepted&&t.onAccepted(w),O=!0;break;case"disposed":t.onDisposed&&t.onDisposed(w),I=!0;break;default:throw new Error("Unexception type "+w.type)}if(C)return f("abort"),Promise.reject(C);if(O)for(u in b[u]=m[u],g(p,w.outdatedModules),w.outdatedDependencies)Object.prototype.hasOwnProperty.call(w.outdatedDependencies,u)&&(v[u]||(v[u]=[]),g(v[u],w.outdatedDependencies[u]));I&&(g(p,[w.moduleId]),b[u]=j)}var P,_=[];for(a=0;a<p.length;a++)u=p[a],E[u]&&E[u].hot._selfAccepted&&b[u]!==j&&_.push({module:u,errorHandler:E[u].hot._selfAccepted});f("dispose"),Object.keys(x).forEach((function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)}));for(var D,L,k=p.slice();k.length>0;)if(u=k.pop(),s=E[u]){var A={},R=s.hot._disposeHandlers;for(l=0;l<R.length;l++)(n=R[l])(A);for(r[u]=A,s.hot.active=!1,delete E[u],delete v[u],l=0;l<s.children.length;l++){var H=E[s.children[l]];H&&(P=H.parents.indexOf(u))>=0&&H.parents.splice(P,1)}}for(u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&(s=E[u]))for(L=v[u],l=0;l<L.length;l++)D=L[l],(P=s.children.indexOf(D))>=0&&s.children.splice(P,1);for(u in f("apply"),o=h,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&(s=E[u])){L=v[u];var U=[];for(a=0;a<L.length;a++)if(D=L[a],n=s.hot._acceptedDependencies[D]){if(-1!==U.indexOf(n))continue;U.push(n)}for(a=0;a<U.length;a++){n=U[a];try{n(L)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:L[a],error:e}),t.ignoreErrored||B||(B=e)}}}for(a=0;a<_.length;a++){var F=_[a];u=F.module,i=[u];try{M(u)}catch(e){if("function"==typeof F.errorHandler)try{F.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:n,originalError:e}),t.ignoreErrored||B||(B=n),B||(B=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:e}),t.ignoreErrored||B||(B=e)}}return B?(f("fail"),Promise.reject(B)):(f("idle"),new Promise((function(e){e(p)})))}var E={};function M(t){if(E[t])return E[t].exports;var n=E[t]={i:t,l:!1,exports:{},hot:u(t),parents:(l=i,i=[],l),children:[]};return e[t].call(n.exports,n,n.exports,s(t)),n.l=!0,n.exports}return M.m=e,M.c=E,M.d=function(e,t,n){M.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},M.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},M.t=function(e,t){if(1&t&&(e=M(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(M.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)M.d(n,a,function(t){return e[t]}.bind(null,a));return n},M.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return M.d(t,"a",t),t},M.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},M.p="",M.h=function(){return o},s("./index.js")(M.s="./index.js")}({"../node_modules/@babel/runtime/helpers/arrayWithHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},"../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},"../node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"../node_modules/@babel/runtime/helpers/asyncToGenerator.js":function(e,t){function n(e,t,n,a,o,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(a,o)}e.exports=function(e){return function(){var t=this,a=arguments;return new Promise((function(o,r){var i=e.apply(t,a);function l(e){n(i,o,r,l,s,"next",e)}function s(e){n(i,o,r,l,s,"throw",e)}l(void 0)}))}}},"../node_modules/@babel/runtime/helpers/classCallCheck.js":function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"../node_modules/@babel/runtime/helpers/createClass.js":function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}},"../node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},"../node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},"../node_modules/@babel/runtime/helpers/inherits.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/setPrototypeOf.js");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}},"../node_modules/@babel/runtime/helpers/iterableToArray.js":function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},"../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":function(e,t){e.exports=function(e,t){var n=[],a=!0,o=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw r}}return n}},"../node_modules/@babel/runtime/helpers/nonIterableRest.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},"../node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},"../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js");e.exports=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?o(e):t}},"../node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(e,t){function n(t,a){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,a)}e.exports=n},"../node_modules/@babel/runtime/helpers/slicedToArray.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/arrayWithHoles.js"),o=n("../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js"),r=n("../node_modules/@babel/runtime/helpers/nonIterableRest.js");e.exports=function(e,t){return a(e)||o(e,t)||r()}},"../node_modules/@babel/runtime/helpers/toConsumableArray.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),o=n("../node_modules/@babel/runtime/helpers/iterableToArray.js"),r=n("../node_modules/@babel/runtime/helpers/nonIterableSpread.js");e.exports=function(e){return a(e)||o(e)||r()}},"../node_modules/@babel/runtime/helpers/typeof.js":function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=a=function(e){return n(e)}:e.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},a(t)}e.exports=a},"../node_modules/@babel/runtime/regenerator/index.js":function(e,t,n){e.exports=n("../node_modules/regenerator-runtime/runtime-module.js")},"../node_modules/ms/index.js":function(e,t){var n=1e3,a=60*n,o=60*a,r=24*o;function i(e,t,n,a){var o=t>=1.5*n;return Math.round(e/n)+" "+a+(o?"s":"")}e.exports=function(e,t){t=t||{};var l,s,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return i*r;case"hours":case"hour":case"hrs":case"hr":case"h":return i*o;case"minutes":case"minute":case"mins":case"min":case"m":return i*a;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===u&&isFinite(e))return t.long?(l=e,(s=Math.abs(l))>=r?i(l,s,r,"day"):s>=o?i(l,s,o,"hour"):s>=a?i(l,s,a,"minute"):s>=n?i(l,s,n,"second"):l+" ms"):function(e){var t=Math.abs(e);return t>=r?Math.round(e/r)+"d":t>=o?Math.round(e/o)+"h":t>=a?Math.round(e/a)+"m":t>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../node_modules/process/browser.js":function(e,t){var n,a,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var s,u=[],d=!1,c=-1;function f(){d&&s&&(d=!1,s.length?u=s.concat(u):c=-1,u.length&&g())}function g(){if(!d){var e=l(f);d=!0;for(var t=u.length;t;){for(s=u,u=[];++c<t;)s&&s[c].run();c=-1,t=u.length}s=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||d||l(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"../node_modules/regenerator-runtime/runtime-module.js":function(e,t,n){var a=function(){return this||"object"==typeof self&&self}()||Function("return this")(),o=a.regeneratorRuntime&&Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime")>=0,r=o&&a.regeneratorRuntime;if(a.regeneratorRuntime=void 0,e.exports=n("../node_modules/regenerator-runtime/runtime.js"),o)a.regeneratorRuntime=r;else try{delete a.regeneratorRuntime}catch(e){a.regeneratorRuntime=void 0}},"../node_modules/regenerator-runtime/runtime.js":function(e,t){!function(t){"use strict";var n,a=Object.prototype,o=a.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",l=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag",u="object"==typeof e,d=t.regeneratorRuntime;if(d)u&&(e.exports=d);else{(d=t.regeneratorRuntime=u?e.exports:{}).wrap=x;var c="suspendedStart",f="suspendedYield",g="executing",m="completed",h={},v={};v[i]=function(){return this};var p=Object.getPrototypeOf,b=p&&p(p(_([])));b&&b!==a&&o.call(b,i)&&(v=b);var j=C.prototype=T.prototype=Object.create(v);w.prototype=j.constructor=C,C.constructor=w,C[s]=w.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(j),e},d.awrap=function(e){return{__await:e}},O(E.prototype),E.prototype[l]=function(){return this},d.AsyncIterator=E,d.async=function(e,t,n,a){var o=new E(x(e,t,n,a));return d.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},O(j),j[s]="Generator",j[i]=function(){return this},j.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},d.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,o){return l.type="throw",l.arg=e,t.next=a,o&&(t.method="next",t.arg=n),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],l=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var o=a.arg;S(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:_(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),h}}}function x(e,t,n,a){var o=t&&t.prototype instanceof T?t:T,r=Object.create(o.prototype),i=new P(a||[]);return r._invoke=function(e,t,n){var a=c;return function(o,r){if(a===g)throw new Error("Generator is already running");if(a===m){if("throw"===o)throw r;return D()}for(n.method=o,n.arg=r;;){var i=n.delegate;if(i){var l=M(i,n);if(l){if(l===h)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===c)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=g;var s=y(e,t,n);if("normal"===s.type){if(a=n.done?m:f,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(a=m,n.method="throw",n.arg=s.arg)}}}(e,n,i),r}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function T(){}function w(){}function C(){}function O(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function E(e){function t(n,a,r,i){var l=y(e[n],e,a);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==typeof u&&o.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,r,i)}),(function(e){t("throw",e,r,i)})):Promise.resolve(u).then((function(e){s.value=e,r(s)}),(function(e){return t("throw",e,r,i)}))}i(l.arg)}var n;this._invoke=function(e,a){function o(){return new Promise((function(n,o){t(e,a,n,o)}))}return n=n?n.then(o,o):o()}}function M(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,M(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=y(a,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var r=o.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,h):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function _(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(o.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return r.next=r}}return{next:D}}function D(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},"./drawing/draw.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.save(),t(e),e.restore()}},"./drawing/drawArrow.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/drawLine.js"),o=n("./drawing/drawJoinedLines.js");t.default=function(e,t,n,r,i,l){var s=Math.atan2(n.y-t.y,n.x-t.x),u={color:r,lineWidth:i};l&&(u.lineDash=l),Object(a.default)(e,void 0,t,n,u,"canvas"),u={color:r,lineWidth:i,fillStyle:r};var d=[{x:n.x-10*Math.cos(s-Math.PI/7),y:n.y-10*Math.sin(s-Math.PI/7)},{x:n.x-10*Math.cos(s+Math.PI/7),y:n.y-10*Math.sin(s+Math.PI/7)},n];Object(o.default)(e,void 0,n,d,u,"canvas")}},"./drawing/drawCircle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./drawing/path.js");t.default=function(e,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";"pixel"===l&&(n=a.default.cornerstone.pixelToCanvas(t,n)),Object(o.default)(e,i,(function(e){e.arc(n.x,n.y,r,0,2*Math.PI)}))}},"./drawing/drawEllipse.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./drawing/path.js"),r=n("./util/pointProjector.js");t.default=function(e,t,n,i,l){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n),i=a.default.cornerstone.pixelToCanvas(t,i));var d=a.default.cornerstone.getViewport(t),c=t.clientWidth,f=t.clientHeight,g=d.scale,m=d.translation,h=d.rotation-u,v={x:c/2+m.x*g,y:f/2+m.y*g};Math.abs(h)>.05&&(n=Object(r.rotatePoint)(n,v,-h),i=Object(r.rotatePoint)(i,v,-h));var p=Math.abs(n.x-i.x),b=Math.abs(n.y-i.y),j=Math.min(n.x,i.x),x=Math.min(n.y,i.y),y={x:j+p/2,y:x+b/2};Math.abs(h)>.05&&(y=Object(r.rotatePoint)(y,v,h));var T=h*Math.PI/180;Object(o.default)(e,l,(function(e){e.ellipse(y.x,y.y,p/2,b/2,T,0,2*Math.PI),e.closePath()}))}},"./drawing/drawHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./stateManagement/toolStyle.js"),r=n("./stateManagement/toolColors.js"),i=n("./drawing/path.js"),l=n("./store/index.js");t.default=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=t.element,d=r.default.getToolColor();e.strokeStyle=s.color||d;for(var c=Object.keys(n),f=function(t){var r=c[t],d=n[r];if(!0===d.drawnIndependently)return"continue";if(!0===s.drawHandlesIfActive&&!d.active)return"continue";if(s.hideHandlesIfMoving&&d.moving)return"continue";var f={lineWidth:d.active?o.default.getActiveWidth():o.default.getToolWidth(),fillStyle:s.fill};s.lineDash&&(f.lineDash=s.lineDash),Object(i.default)(e,f,(function(e){var t=a.default.cornerstone.pixelToCanvas(u,d),n=d.radius||s.handleRadius||l.state.handleRadius;e.arc(t.x,t.y,n,0,2*Math.PI)}))},g=0;g<c.length;g++)f(g)}},"./drawing/drawJoinedLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./drawing/path.js");t.default=function(e,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(o.default)(e,i,(function(e){"pixel"===l&&(n=a.default.cornerstone.pixelToCanvas(t,n),r=r.map((function(e){return a.default.cornerstone.pixelToCanvas(t,e)}))),e.moveTo(n.x,n.y),r.forEach((function(t){var n=t.x,a=t.y;e.lineTo(n,a)}))}))}},"./drawing/drawLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var a=n("./externalModules.js"),o=n("./drawing/path.js");function r(e,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(o.default)(e,i,(function(e){"pixel"===l&&(n=a.default.cornerstone.pixelToCanvas(t,n),r=a.default.cornerstone.pixelToCanvas(t,r)),e.moveTo(n.x,n.y),e.lineTo(r.x,r.y)}))}},"./drawing/drawLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./drawing/path.js");t.default=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pixel";Object(o.default)(e,r,(function(e){n.forEach((function(n){var o=n.start,r=n.end;if("pixel"===i){var l=a.default.cornerstone;o=l.pixelToCanvas(t,o),r=l.pixelToCanvas(t,r)}e.moveTo(o.x,o.y),e.lineTo(r.x,r.y)}))}))}},"./drawing/drawLink.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./drawing/drawLine.js");t.default=function(e,t,n,r,i,l){var s=e.length>0?a.default.cornerstoneMath.point.findClosestPoint(e,t):t,u=[{x:n.left+n.width/2,y:n.top},{x:n.left,y:n.top+n.height/2},{x:n.left+n.width/2,y:n.top+n.height},{x:n.left+n.width,y:n.top+n.height/2}],d=a.default.cornerstoneMath.point.findClosestPoint(u,s),c={color:i,lineWidth:l,lineDash:[2,3]};Object(o.default)(r,void 0,s,d,c,"canvas")}},"./drawing/drawLinkedTextBox.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./drawing/drawTextBox.js"),r=n("./drawing/drawLink.js"),i=n("./store/index.js"),l=n("./util/clip.js");t.default=function(e,t,n,s,u,d,c,f,g,m){var h=a.default.cornerstone.pixelToCanvas,v=h(t,n);g&&(v.x+=g);var p={centering:{x:!1,y:m}};if(i.state.preventTextBoxOutsideDisplayedArea&&(p.displacer=function(e){return Object(l.clipBoxToDisplayedArea)(t,e)}),n.boundingBox=Object(o.default)(e,s,v.x,v.y,c,p),n.hasMoved){var b=d(u).map((function(e){return h(t,e)}));Object(r.default)(b,v,n.boundingBox,e,c,f)}}},"./drawing/drawRect.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./drawing/path.js"),r=n("./util/pointProjector.js");t.default=function(e,t,n,i,l){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if("pixel"===s){var d=a.default.cornerstone;n=d.pixelToCanvas(t,n),i=d.pixelToCanvas(t,i)}var c=a.default.cornerstone.getViewport(t),f=t.clientWidth,g=t.clientHeight,m=c.scale,h=c.translation,v=c.rotation-u,p={x:f/2+h.x*m,y:g/2+h.y*m};Math.abs(v)>.05&&(n=Object(r.rotatePoint)(n,p,-v),i=Object(r.rotatePoint)(i,p,-v));var b=Math.abs(n.x-i.x),j=Math.abs(n.y-i.y);n={x:Math.min(n.x,i.x),y:Math.min(n.y,i.y)},i={x:n.x+b,y:n.y+j};var x={x:n.x+b,y:n.y},y={x:n.x,y:n.y+j};Math.abs(v)>.05&&(n=Object(r.rotatePoint)(n,p,v),i=Object(r.rotatePoint)(i,p,v),x=Object(r.rotatePoint)(x,p,v),y=Object(r.rotatePoint)(y,p,v)),Object(o.default)(e,l,(function(e){e.moveTo(n.x,n.y),e.lineTo(x.x,x.y),e.lineTo(i.x,i.y),e.lineTo(y.x,y.y),e.lineTo(n.x,n.y)}))}},"./drawing/drawTextBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"textBoxWidth",(function(){return l}));var a=n("./stateManagement/textStyle.js"),o=n("./drawing/draw.js"),r=n("./drawing/fillTextLines.js"),i=n("./drawing/fillBox.js");function l(e,t,n){var o=a.default.getFont(),r=e.font;o&&o!==r&&(e.font=o);var i=e.measureText(t).width;return o&&o!==r&&(e.font=r),i+2*n}t.default=function(e,t,n,s,u){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var c=5,f=a.default.getFontSize(),g=a.default.getBackgroundColor(),m=0;t.forEach((function(t){var n=l(e,t,c);m=Math.max(m,n)}));var h={width:m,height:c+t.length*(f+c)};return Object(o.default)(e,(function(e){e.strokeStyle=u,d.centering&&(!0===d.centering.x&&(n-=h.width/2),!0===d.centering.y&&(s-=h.height/2)),h.left=n,h.top=s,"function"==typeof d.displacer&&d.displacer(h),Object(i.default)(e,h,g),Object(r.default)(e,h,t,u,c)})),h}},"./drawing/fillBox.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){e.fillStyle=n,e.fillRect(t.left,t.top,t.width,t.height)}},"./drawing/fillOutsideRect.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./drawing/path.js");t.default=function(e,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===l){var s=a.default.cornerstone;n=s.pixelToCanvas(t,n),r=s.pixelToCanvas(t,r)}var u=Math.min(n.x,r.x),d=Math.min(n.y,r.y),c=Math.abs(n.x-r.x),f=Math.abs(n.y-r.y);Object(o.default)(e,i,(function(e){e.rect(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.rect(u+c,d,-c,f)}))}},"./drawing/fillTextLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/textStyle.js");t.default=function(e,t,n,o,r){var i=a.default.getFontSize();e.font=a.default.getFont(),e.textBaseline="top",e.fillStyle=o,n.forEach((function(n,a){e.fillText(n,t.left+r,t.top+r+a*(i+r))}))}},"./drawing/getNewContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.getContext("2d");return t.setTransform(1,0,0,1,0,0),t}},"./drawing/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/draw.js");n.d(t,"draw",(function(){return a.default}));var o=n("./drawing/drawArrow.js");n.d(t,"drawArrow",(function(){return o.default}));var r=n("./drawing/drawCircle.js");n.d(t,"drawCircle",(function(){return r.default}));var i=n("./drawing/drawEllipse.js");n.d(t,"drawEllipse",(function(){return i.default}));var l=n("./drawing/drawHandles.js");n.d(t,"drawHandles",(function(){return l.default}));var s=n("./drawing/drawJoinedLines.js");n.d(t,"drawJoinedLines",(function(){return s.default}));var u=n("./drawing/drawLine.js");n.d(t,"drawLine",(function(){return u.default}));var d=n("./drawing/drawLines.js");n.d(t,"drawLines",(function(){return d.default}));var c=n("./drawing/drawLink.js");n.d(t,"drawLink",(function(){return c.default}));var f=n("./drawing/drawLinkedTextBox.js");n.d(t,"drawLinkedTextBox",(function(){return f.default}));var g=n("./drawing/drawRect.js");n.d(t,"drawRect",(function(){return g.default}));var m=n("./drawing/drawTextBox.js");n.d(t,"drawTextBox",(function(){return m.default}));var h=n("./drawing/fillBox.js");n.d(t,"fillBox",(function(){return h.default}));var v=n("./drawing/fillOutsideRect.js");n.d(t,"fillOutsideRect",(function(){return v.default}));var p=n("./drawing/fillTextLines.js");n.d(t,"fillTextLines",(function(){return p.default}));var b=n("./drawing/getNewContext.js");n.d(t,"getNewContext",(function(){return b.default}));var j=n("./drawing/path.js");n.d(t,"path",(function(){return j.default}));var x=n("./drawing/setShadow.js");n.d(t,"setShadow",(function(){return x.default}));var y=n("./drawing/transformCanvasContext.js");n.d(t,"transformCanvasContext",(function(){return y.default}));var T=n("./drawing/resetCanvasContextTransform.js");n.d(t,"resetCanvasContextTransform",(function(){return T.default}))},"./drawing/path.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolStyle.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=t.color,r=t.lineWidth,i=t.fillStyle,l=t.lineDash,s=t.shouldDrawLines,u=void 0===s||s;e.beginPath(),e.strokeStyle=o||e.strokeStyle,e.lineWidth=r||void 0===r&&a.default.getToolWidth()||e.lineWidth,l&&e.setLineDash(l),n(e),i&&(e.fillStyle=i,e.fill()),u&&e.stroke(),l&&e.setLineDash([])}},"./drawing/resetCanvasContextTransform.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){e.setTransform(1,0,0,1,0,0)}},"./drawing/setShadow.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/getDefault.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.shadow&&(e.shadowColor=Object(a.default)(t.shadowColor,"#000000"),e.shadowBlur=Object(a.default)(t.shadowBlur,0),e.shadowOffsetX=Object(a.default)(t.shadowOffsetX,1),e.shadowOffsetY=Object(a.default)(t.shadowOffsetY,1))}},"./drawing/transformCanvasContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){if(n.hflip||n.vflip||n.rotation){var a={x:t.width/2+n.translation.x*n.scale,y:t.height/2+n.translation.y*n.scale};e.translate(a.x,a.y),n.rotation&&e.rotate(n.rotation*Math.PI/180),n.vflip&&e.scale(1,-1),n.hflip&&e.scale(-1,1),e.translate(-a.x,-a.y)}}},"./eventDispatchers/imageRenderedEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./stateManagement/toolState.js"),r=n("./eventListeners/onImageRenderedBrushEventHandler.js"),i=n("./externalModules.js"),l=Object(a.getModule)("segmentation"),s=function(e){var t=e.detail,n=t.element,i=a.state.tools.filter((function(e){return e.element===n&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)})),s=Object(o.getToolState)(n,"stack"),u=l.configuration;s&&(u.renderFill||u.renderOutline)&&Object(r.default)(e);var d=t.canvasContext.canvas.getContext("2d");i.forEach((function(t){t.renderToolData&&(d.save(),t.renderToolData(e),d.restore())}))};t.default={enable:function(e){e.addEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,s)},disable:function(e){e.removeEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,s)}}},"./eventDispatchers/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventDispatchers/imageRenderedEventDispatcher.js");n.d(t,"imageRenderedEventDispatcher",(function(){return a.default}));var o=n("./eventDispatchers/mouseToolEventDispatcher.js");n.d(t,"mouseToolEventDispatcher",(function(){return o.default}));var r=n("./eventDispatchers/newImageEventDispatcher.js");n.d(t,"newImageEventDispatcher",(function(){return r.default}));var i=n("./eventDispatchers/touchToolEventDispatcher.js");n.d(t,"touchToolEventDispatcher",(function(){return i.default}))},"./eventDispatchers/mouseEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),i=n("./manipulators/index.js"),l=n("./util/logger.js"),s=n("./util/triggerEvent.js"),u=Object(l.getLogger)("eventDispatchers:mouseEventHandlers");t.default=function(e,t){u.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,l=n.element,d=t.createNewMeasurement(n);if(d){Object(r.addToolState)(l,t.name,d),o.default.cornerstone.updateImage(l);var c=1===Object.keys(d.handles).length?i.moveHandle:i.moveNewHandle,f=(new Date).getTime();c(n,t.name,d,d.handles.end,t.options,"mouse",(function(e){if(!d.cancelled){var n=!(!t.configuration||!Object(t.configuration).hasOwnProperty("measurementCreationThreshold"))&&(new Date).getTime()-f<t.configuration.measurementCreationThreshold;if(e&&!1===n){var o=a.default.MEASUREMENT_COMPLETED,i={toolName:t.name,toolType:t.name,element:l,measurementData:d};Object(s.default)(l,o,i)}else Object(r.removeToolState)(l,t.name,d)}}))}}},"./eventDispatchers/mouseEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"mouseClick",(function(){return s})),n.d(t,"mouseDoubleClick",(function(){return u})),n.d(t,"mouseUp",(function(){return d})),n.d(t,"mouseWheel",(function(){return c}));var a=n("./eventDispatchers/shared/customCallbackHandler.js"),o=n("./eventDispatchers/mouseEventHandlers/mouseDown.js");n.d(t,"mouseDown",(function(){return o.default}));var r=n("./eventDispatchers/mouseEventHandlers/mouseDownActivate.js");n.d(t,"mouseDownActivate",(function(){return r.default}));var i=n("./eventDispatchers/mouseEventHandlers/mouseDrag.js");n.d(t,"mouseDrag",(function(){return i.default}));var l=n("./eventDispatchers/mouseEventHandlers/mouseMove.js");n.d(t,"mouseMove",(function(){return l.default}));var s=a.default.bind(null,"Mouse","mouseClickCallback"),u=a.default.bind(null,"Mouse","doubleClickCallback"),d=a.default.bind(null,"Mouse","mouseUpCallback"),c=a.default.bind(null,"MouseWheel","mouseWheelCallback")},"./eventDispatchers/mouseEventHandlers/mouseDown.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./stateManagement/toolState.js"),r=n("./store/getToolsWithMoveableHandles.js"),i=n("./util/findAndMoveHelpers.js"),l=n("./store/getInteractiveToolsForElement.js"),s=n("./store/getToolsWithDataForElement.js"),u=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=e.detail.element,d=e.detail.currentPoints.canvas,c=Object(l.default)(n,a.getters.mouseTools()),f=c.filter((function(e){return"active"===e.mode&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(t.buttons)&&e.options.isMouseActive}));if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var g=f.find((function(e){return"function"==typeof e.preMouseDownCallback}));if(g&&g.preMouseDownCallback(e))return}if(!a.state.isMultiPartToolActive){var m=Object(s.default)(n,c),h=Object(r.default)(n,m,d,"mouse");if(h.length>0){var v=h[0],p=Object(o.getToolState)(n,v.name),b=Object(i.findHandleDataNearImagePoint)(n,p,v.name,d),j=b.handle,x=b.data;v.handleSelectedCallback(e,x,j,"mouse")}else{var y=c.filter((function(e){var t=Object(o.getToolState)(n,e.name),a=t&&t.data&&e.pointNearTool&&t.data.some((function(t){return e.pointNearTool(n,t,d,"mouse")}));return a}));if(y.length>0){var T=y[0],w=Object(o.getToolState)(n,T.name).data.find((function(e){return T.pointNearTool(n,e,d)}));T.toolSelectedCallback(e,w,"mouse")}else if(f.length>0){var C=f.find((function(e){return"function"==typeof e.postMouseDownCallback}));if(C&&C.postMouseDownCallback(e))return}}}}}},"./eventDispatchers/mouseEventHandlers/mouseDownActivate.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventDispatchers/mouseEventHandlers/addNewMeasurement.js"),o=n("./store/index.js"),r=n("./tools/base/BaseAnnotationTool.js"),i=n("./util/getActiveTool.js");t.default=function(e){if(!o.state.isToolLocked){var t=e.detail,n=t.element,l=t.buttons,s=Object(i.default)(n,l,"mouse");if(s){if("function"==typeof s.preMouseDownActivateCallback&&s.preMouseDownActivateCallback(e))return;o.state.isMultiPartToolActive||(s.addNewMeasurement?s.addNewMeasurement(e,"mouse"):s instanceof r.default&&Object(a.default)(e,s))}}}},"./eventDispatchers/mouseEventHandlers/mouseDrag.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),r=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t,n=e.detail,i=n.element;t=(t=(t=Object(o.default)(i,a.getters.mouseTools())).filter((function(e){return Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(n.buttons)&&e.options.isMouseActive}))).filter((function(e){return"function"==typeof e.mouseDragCallback})),a.state.isMultiPartToolActive&&(t=Object(r.default)(t)),0!==t.length&&t[0].mouseDragCallback(e)}}},"./eventDispatchers/mouseEventHandlers/mouseMove.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./store/index.js"),r=n("./store/getInteractiveToolsForElement.js"),i=n("./store/getToolsWithDataForElement.js");t.default=function(e){if(!o.state.isToolLocked&&!o.state.isMultiPartToolActive){var t,n=e.detail,l=n.element,s=n.currentPoints;o.state.mousePositionImage=s.image;var u=(t=Object(r.default)(l,o.getters.mouseTools())).filter((function(e){return"active"===e.mode&&e.options.isMouseActive})),d=!1;u.length>0&&(d=u.some((function(e){return e.updateOnMouseMove}))),t=Object(i.default)(l,t);for(var c=0;c<t.length;c++){var f=t[c];"function"==typeof f.mouseMoveCallback&&(d=f.mouseMoveCallback(e)||d)}!0===d&&a.default.cornerstone.updateImage(l)}}},"./eventDispatchers/mouseToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./eventDispatchers/mouseEventHandlers/index.js");t.default={enable:function(e){e.addEventListener(a.default.MOUSE_CLICK,o.mouseClick),e.addEventListener(a.default.MOUSE_DOWN,o.mouseDown),e.addEventListener(a.default.MOUSE_DOWN_ACTIVATE,o.mouseDownActivate),e.addEventListener(a.default.MOUSE_DOUBLE_CLICK,o.mouseDoubleClick),e.addEventListener(a.default.MOUSE_DRAG,o.mouseDrag),e.addEventListener(a.default.MOUSE_MOVE,o.mouseMove),e.addEventListener(a.default.MOUSE_UP,o.mouseUp),e.addEventListener(a.default.MOUSE_WHEEL,o.mouseWheel)},disable:function(e){e.removeEventListener(a.default.MOUSE_CLICK,o.mouseClick),e.removeEventListener(a.default.MOUSE_DOWN,o.mouseDown),e.removeEventListener(a.default.MOUSE_DOWN_ACTIVATE,o.mouseDownActivate),e.removeEventListener(a.default.MOUSE_DOUBLE_CLICK,o.mouseDoubleClick),e.removeEventListener(a.default.MOUSE_DRAG,o.mouseDrag),e.removeEventListener(a.default.MOUSE_MOVE,o.mouseMove),e.removeEventListener(a.default.MOUSE_UP,o.mouseUp),e.removeEventListener(a.default.MOUSE_WHEEL,o.mouseWheel)}}},"./eventDispatchers/newImageEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./externalModules.js"),r=function(e){if(a.state.isToolLocked)return!1;var t=e.detail.element,n=a.state.tools.filter((function(e){return e.element===t&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)}));if(0===n.length)return!1;n.forEach((function(t){t.newImageCallback&&t.newImageCallback(e)}))};t.default={enable:function(e){e.addEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,r)},disable:function(e){e.removeEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,r)}}},"./eventDispatchers/shared/customCallbackHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),r=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e,t,n){if(a.state.isToolLocked)return!1;var i=n.detail.element,l=a.state.tools.filter((function(t){return t.supportedInteractionTypes.includes(e)}));if(l=(l=Object(o.default)(i,l,e)).filter((function(e){return"function"==typeof e[t]})),a.state.isMultiPartToolActive&&(l=Object(r.default)(l)),0===l.length)return!1;l[0][t](n)}},"./eventDispatchers/touchEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./externalModules.js"),r=n("./store/index.js"),i=n("./manipulators/anyHandlesOutsideImage.js"),l=n("./manipulators/index.js"),s=n("./stateManagement/toolState.js"),u=n("./util/triggerEvent.js"),d=n("./util/logger.js"),c=Object(d.getLogger)("eventDispatchers:touchEventHandlers");t.default=function(e,t){c.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,d=n.element,f=t.createNewMeasurement(n);if(f){if(Object(s.addToolState)(d,t.name,f),1===Object.keys(f.handles).length&&n.type===a.default.TAP)return f.active=!1,f.handles.end.active=!1,f.handles.end.highlight=!1,f.invalidated=!0,(r.state.deleteIfHandleOutsideImage||t.options.deleteIfHandleOutsideImage)&&Object(i.default)(n,f.handles)&&Object(s.removeToolState)(d,t.name,f),void o.default.cornerstone.updateImage(d);o.default.cornerstone.updateImage(d),Object(l.moveNewHandle)(n,t.name,f,f.handles.end,t.options,"touch",(function(){var e=a.default.MEASUREMENT_COMPLETED,n={toolName:t.name,toolType:t.name,element:d,measurementData:f};Object(u.default)(d,e,n)}))}}},"./eventDispatchers/touchEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"doubleTap",(function(){return s})),n.d(t,"touchDrag",(function(){return u})),n.d(t,"touchEnd",(function(){return d})),n.d(t,"touchPinch",(function(){return c})),n.d(t,"touchPress",(function(){return f})),n.d(t,"touchRotate",(function(){return g}));var a=n("./eventDispatchers/shared/customCallbackHandler.js"),o=n("./eventDispatchers/touchEventHandlers/multiTouchDrag.js");n.d(t,"multiTouchDrag",(function(){return o.default}));var r=n("./eventDispatchers/touchEventHandlers/tap.js");n.d(t,"tap",(function(){return r.default}));var i=n("./eventDispatchers/touchEventHandlers/touchStart.js");n.d(t,"touchStart",(function(){return i.default}));var l=n("./eventDispatchers/touchEventHandlers/touchStartActive.js");n.d(t,"touchStartActive",(function(){return l.default}));var s=a.default.bind(null,"DoubleTap","doubleTapCallback"),u=a.default.bind(null,"Touch","touchDragCallback"),d=a.default.bind(null,"Touch","touchEndCallback"),c=a.default.bind(null,"TouchPinch","touchPinchCallback"),f=a.default.bind(null,"Touch","touchPressCallback"),g=a.default.bind(null,"TouchRotate","touchRotateCallback")},"./eventDispatchers/touchEventHandlers/multiTouchDrag.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),r=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(a.state.isToolLocked)return!1;var t=e.detail,n=t.element,i=t.numPointers,l=a.state.tools.filter((function(e){return e.supportedInteractionTypes.includes("MultiTouch")}));if(l=(l=Object(o.default)(n,l,"MultiTouch")).filter((function(e){return"function"==typeof e.multiTouchDragCallback&&i===e.configuration.touchPointers})),a.state.isMultiPartToolActive&&(l=Object(r.default)(l)),0===l.length)return!1;l[0].multiTouchDragCallback(e)}},"./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js":function(e,t,n){"use strict";function a(e){Object.keys(e).forEach((function(t){e[t].active=!1}))}n.r(t),t.default=function(e){if(e)for(var t=0;t<e.data.length;t++){var n=e.data[t];n.active=!1,n.handles&&a(n.handles)}}},"./eventDispatchers/touchEventHandlers/tap.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./eventDispatchers/touchEventHandlers/touchStartActive.js"),r=n("./store/index.js"),i=n("./store/getActiveToolsForElement.js"),l=n("./store/getToolsWithDataForElement.js"),s=n("./stateManagement/toolState.js"),u=n("./manipulators/getHandleNearImagePoint.js"),d=n("./manipulators/index.js"),c=n("./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js");t.default=function(e){if(!r.state.isToolLocked&&!r.state.isMultiPartToolActive){var t,n=e.detail.element,f=e.detail.currentPoints.canvas;t=Object(i.default)(n,r.getters.touchTools());var g=(t=Object(l.default)(n,t)).filter((function(e){for(var t=Object(s.getToolState)(n,e.name),a=0;a<t.data.length;a++)if(void 0!==Object(u.default)(n,t.data[a].handles,f,28))return!0;return!1}));if(g.length>0){var m=g[0],h=Object(s.getToolState)(n,m.name),v=h.data.find((function(e){return void 0!==Object(u.default)(n,e.handles,f,28)}));return h.data.active=!0,v.active=!0,a.default.cornerstone.updateImage(n),Object(d.moveHandle)(e.detail,m.name,h.data,v,m.options,"touch",(function(){return Object(c.default)(h)})),e.stopImmediatePropagation(),void e.preventDefault()}var p=t.filter((function(e){var t=Object(s.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some((function(t){return e.pointNearTool(n,t,f)}))}));if(p.length>0){var b=p[0],j=Object(s.getToolState)(n,b.name),x=j.data.find((function(e){return b.pointNearTool(n,e,f)}));return x.active=!0,a.default.cornerstone.updateImage(n),Object(d.moveAllHandles)(e.detail,b.name,x,null,b.options,"touch",(function(){return Object(c.default)(j)})),e.stopImmediatePropagation(),void e.preventDefault()}var y=Object(i.default)(n,r.getters.touchTools());return y.length>0&&y[0].touchStartActiveCallback?y[0].touchStartActiveCallback(e):Object(o.default)(e),!1}}},"./eventDispatchers/touchEventHandlers/touchStart.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./util/findAndMoveHelpers.js"),r=n("./store/getToolsWithMoveableHandles.js"),i=n("./stateManagement/toolState.js"),l=n("./store/getInteractiveToolsForElement.js"),s=n("./store/getToolsWithDataForElement.js"),u=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=t.element,d=t.startPoints.canvas,c=Object(l.default)(n,a.getters.touchTools()),f=c.filter((function(e){return"active"===e.mode&&e.options.isTouchActive}));if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var g=f.find((function(e){return"function"==typeof e.preTouchStartCallback}));if(g&&g.preTouchStartCallback(e))return}if(!a.state.isMultiPartToolActive){var m=Object(s.default)(n,c),h=Object(r.default)(n,m,d,"touch");if(h.length>0){var v=h[0],p=Object(i.getToolState)(n,v.name),b=Object(o.findHandleDataNearImagePoint)(n,p,v.name,d,"touch"),j=b.handle,x=b.data;v.handleSelectedCallback(e,x,j,"touch")}else{var y=m.filter((function(e){var t=Object(i.getToolState)(n,e.name),a=t&&t.data&&e.pointNearTool&&t.data.some((function(t){return e.pointNearTool(n,t,d,"touch")}));return a}));if(y.length>0){var T=y[0],w=Object(i.getToolState)(n,T.name).data.find((function(e){return T.pointNearTool(n,e,d)}));T.toolSelectedCallback(e,w,"touch")}else if(f.length>0){var C=f.find((function(e){return"function"==typeof e.postTouchStartCallback}));if(C&&C.postTouchStartCallback(e))return}}}}}},"./eventDispatchers/touchEventHandlers/touchStartActive.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./eventDispatchers/touchEventHandlers/addNewMeasurement.js"),r=n("./tools/base/BaseAnnotationTool.js"),i=n("./util/getActiveTool.js");t.default=function(e){if(!a.state.isToolLocked&&!a.state.isMultiPartToolActive){var t=e.detail.element,n=Object(i.default)(t,null,"touch");n&&n.addNewMeasurement?n.addNewMeasurement(e,"touch"):n instanceof r.default&&Object(o.default)(e,n)}}},"./eventDispatchers/touchToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./eventDispatchers/touchEventHandlers/index.js");t.default={enable:function(e){e.addEventListener(a.default.TAP,o.tap),e.addEventListener(a.default.TOUCH_START,o.touchStart,{passive:!1}),e.addEventListener(a.default.TOUCH_DRAG,o.touchDrag,{passive:!1}),e.addEventListener(a.default.TOUCH_END,o.touchEnd),e.addEventListener(a.default.TOUCH_START_ACTIVE,o.touchStartActive),e.addEventListener(a.default.TOUCH_PRESS,o.touchPress),e.addEventListener(a.default.DOUBLE_TAP,o.doubleTap),e.addEventListener(a.default.TOUCH_PINCH,o.touchPinch),e.addEventListener(a.default.TOUCH_ROTATE,o.touchRotate),e.addEventListener(a.default.MULTI_TOUCH_DRAG,o.multiTouchDrag)},disable:function(e){e.removeEventListener(a.default.TAP,o.tap),e.removeEventListener(a.default.TOUCH_START,o.touchStart),e.removeEventListener(a.default.TOUCH_DRAG,o.touchDrag),e.removeEventListener(a.default.TOUCH_END,o.touchEnd),e.removeEventListener(a.default.TOUCH_START_ACTIVE,o.touchStartActive),e.removeEventListener(a.default.TOUCH_PRESS,o.touchPress),e.removeEventListener(a.default.DOUBLE_TAP,o.doubleTap),e.removeEventListener(a.default.TOUCH_PINCH,o.touchPinch),e.removeEventListener(a.default.TOUCH_ROTATE,o.touchRotate),e.removeEventListener(a.default.MULTI_TOUCH_DRAG,o.multiTouchDrag)}}},"./eventListeners/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/mouseEventListeners.js");n.d(t,"mouseEventListeners",(function(){return a.default}));var o=n("./eventListeners/wheelEventListener.js");n.d(t,"wheelEventListener",(function(){return o.default}));var r=n("./eventListeners/touchEventListeners.js");n.d(t,"touchEventListeners",(function(){return r.default}))},"./eventListeners/internals/normalizeWheel.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=0,n=0,a=0,o=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),a=10*t,o=10*n,"deltaY"in e&&(o=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||o)&&e.deltaMode&&(1===e.deltaMode?(a*=40,o*=40):(a*=800,o*=800)),a&&!t&&(t=a<1?-1:1),o&&!n&&(n=o<1?-1:1),{spinX:t,spinY:n,pixelX:a,pixelY:o}}},"./eventListeners/internals/renderSegmentation.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var a=n("./store/index.js"),o=n("./eventListeners/internals/renderSegmentationFill.js"),r=n("./eventListeners/internals/renderSegmentationOutline.js"),i=Object(a.getModule)("segmentation");function l(e,t,n,a,l){(function(e){var t=i.configuration;return t.renderFill&&(e&&0!==t.fillAlpha||!e&&0!==t.fillAlphaInactive)})(l)&&Object(o.default)(e,t,a,n,l),function(e){var t=i.configuration;return t.renderOutline&&(e&&0!==t.outlineAlpha||!e&&0!==t.outlineAlphaInactive)}(l)&&Object(r.default)(e,t,a,n,l)}},"./eventListeners/internals/renderSegmentationFill.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l})),n.d(t,"getLabelmapCanvas",(function(){return s})),n.d(t,"renderFill",(function(){return u}));var a=n("./store/index.js"),o=n("./drawing/index.js"),r=n("./externalModules.js"),i=Object(a.getModule)("segmentation");function l(e,t,n,a,o){u(e,s(e,t,n),o)}function s(e,t,n){var a=i.state,r=e.detail.image,l=r.width,s=r.height,u=t.segmentsHidden,d=n.pixelData,c=a.colorLutTables[t.colorLUTIndex],f=document.createElement("canvas");f.width=l,f.height=s;for(var g=Object(o.getNewContext)(f),m=new ImageData(l,s),h=m.data,v=0;v<d.length;v++){var p=d[v];if(0!==p&&!u[p]){var b=c[d[v]];h[4*v]=b[0],h[4*v+1]=b[1],h[4*v+2]=b[2],h[4*v+3]=b[3]}}return g.putImageData(m,0,0),f}function u(e,t,n){var a=i.configuration,l=e.detail,s=Object(o.getNewContext)(l.canvasContext.canvas),u=r.default.cornerstone.pixelToCanvas(l.element,{x:0,y:0}),d=r.default.cornerstone.pixelToCanvas(l.element,{x:l.image.width,y:0}),c=r.default.cornerstone.pixelToCanvas(l.element,{x:l.image.width,y:l.image.height}),f=r.default.cornerstoneMath.point.distance(u,d),g=r.default.cornerstoneMath.point.distance(d,c),m=l.canvasContext.canvas,h=l.viewport,v=s.imageSmoothingEnabled,p=s.globalAlpha;s.imageSmoothingEnabled=!1,s.globalAlpha=n?a.fillAlpha:a.fillAlphaInactive,Object(o.transformCanvasContext)(s,m,h);var b=function(e){var t=e.viewport,n=e.image,a=t.scale,o=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?a*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(o*=n.rowPixelSpacing/n.columnPixelSpacing),{x:t.translation.x*a,y:t.translation.y*o}}(l);s.drawImage(t,m.width/2-f/2+b.x,m.height/2-g/2+b.y,f,g),s.globalAlpha=p,s.imageSmoothingEnabled=v,Object(o.resetCanvasContextTransform)(s)}},"./eventListeners/internals/renderSegmentationOutline.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l})),n.d(t,"renderOutline",(function(){return s})),n.d(t,"getOutline",(function(){return u})),n.d(t,"_addTopRightCorner",(function(){return f}));var a=n("./store/index.js"),o=n("./externalModules.js"),r=n("./drawing/index.js"),i=(n("./index.js"),Object(a.getModule)("segmentation"));function l(e,t,n,a,o){s(e,u(e,t,n,i.configuration.outlineWidth),t.colorLUTIndex,o)}function s(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=i.configuration,l=i.state,s=e.detail,u=s.element,d=s.canvasContext,c=o.outlineWidth||1,f=Object(r.getNewContext)(d.canvas),g=l.colorLutTables[n],m=f.globalAlpha;f.globalAlpha=a?o.outlineAlpha:o.outlineAlphaInactive,Object(r.draw)(f,(function(e){for(var n=1;n<t.length;n++)if(t[n]){var a=g[n];Object(r.drawLines)(e,u,t[n],{color:"rgba(".concat(a[0],", ").concat(a[1],", ").concat(a[2],", 1.0 )"),lineWidth:c},"canvas")}})),f.globalAlpha=m}function u(e,t,n,a){var o=e.detail,r=o.element,i=o.image,l=o.viewport,s=i.width,u=i.height;a=a||1;var j=t.segmentsHidden,x=n.pixelData,y=t.activeSegmentIndex,T=[];n.segmentsOnLabelmap.forEach((function(e){!j[e]&&(T[e]=[])})),T[y]||(T[y]=[]);for(var w,C=function(e,t){var n=t/2,a=e.rotation;a*=Math.PI/180;var o=Math.cos(a),r=Math.sin(a),i=[o,r],l=[-r,o],s={x:n*i[0],y:n*i[1]},u={x:n*l[0],y:n*l[1]};return e.hflip&&(s.x*=-1,s.y*=-1),e.vflip&&(u.x*=-1,u.y*=-1),{i:s,j:u}}(l,a),O=0;O<x.length;O++){var E=x[O];if(0!==E&&!j[E]){var M={x:(w=O)%s,y:Math.floor(w/s)},I=d(M,u,s);void 0!==I.top&&x[I.top]===E||h(T[E],r,M,C),void 0!==I.bottom&&x[I.bottom]===E||v(T[E],r,M,C),void 0!==I.left&&x[I.left]===E||p(T[E],r,M,C),void 0!==I.right&&x[I.right]===E||b(T[E],r,M,C),void 0!==I.topLeft&&x[I.topLeft]!==E&&x[I.top]===E&&x[I.left]===E&&c(T[E],r,M,C),void 0!==I.topRight&&x[I.topRight]!==E&&x[I.top]===E&&x[I.right]===E&&f(T[E],r,M,C),void 0!==I.bottomLeft&&x[I.bottomLeft]!==E&&x[I.bottom]===E&&x[I.left]===E&&g(T[E],r,M,C),void 0!==I.bottomRight&&x[I.bottomRight]!==E&&x[I.bottom]===E&&x[I.right]===E&&m(T[E],r,M,C)}}return T}function d(e,t,n){var a=e.y*n+e.x,o={},r=e.y-1>=0,i=e.y+1<t,l=e.x-1>=0,s=e.x+1<n;return r&&(o.top=a-n,s&&(o.topRight=o.top+1),l&&(o.topLeft=o.top-1)),i&&(o.bottom=a+n,s&&(o.bottomRight=o.bottom+1),l&&(o.bottomLeft=o.bottom-1)),l&&(o.left=a-1),s&&(o.right=a+1),o}function c(e,t,n,a){var r=(0,o.default.cornerstone.pixelToCanvas)(t,n);r.x+=a.j.x,r.y+=a.j.y;var i={x:r.x,y:r.y};i.x+=2*a.i.x,i.y+=2*a.i.y,e.push({start:r,end:i})}function f(e,t,n,a){var r=(0,o.default.cornerstone.pixelToCanvas)(t,{x:n.x+1,y:n.y});r.x+=a.j.x,r.y+=a.j.y;var i={x:r.x,y:r.y};i.x-=2*a.i.x,i.y-=2*a.i.y,e.push({start:r,end:i})}function g(e,t,n,a){var r=(0,o.default.cornerstone.pixelToCanvas)(t,{x:n.x,y:n.y+1});r.x-=a.j.x,r.y-=a.j.y;var i={x:r.x,y:r.y};i.x+=2*a.i.x,i.y+=2*a.i.y,e.push({start:r,end:i})}function m(e,t,n,a){var r=(0,o.default.cornerstone.pixelToCanvas)(t,{x:n.x+1,y:n.y+1});r.x-=a.j.x,r.y-=a.j.y;var i={x:r.x,y:r.y};i.x-=2*a.i.x,i.y-=2*a.i.y,e.push({start:r,end:i})}function h(e,t,n,a){var r=o.default.cornerstone.pixelToCanvas,i=r(t,n),l=r(t,{x:n.x+1,y:n.y});i.x+=a.j.x,i.y+=a.j.y,l.x+=a.j.x,l.y+=a.j.y,e.push({start:i,end:l})}function v(e,t,n,a){var r=o.default.cornerstone.pixelToCanvas,i=r(t,{x:n.x,y:n.y+1}),l=r(t,{x:n.x+1,y:n.y+1});i.x-=a.j.x,i.y-=a.j.y,l.x-=a.j.x,l.y-=a.j.y,e.push({start:i,end:l})}function p(e,t,n,a){var r=o.default.cornerstone.pixelToCanvas,i=r(t,n),l=r(t,{x:n.x,y:n.y+1});i.x+=a.i.x,i.y+=a.i.y,l.x+=a.i.x,l.y+=a.i.y,e.push({start:i,end:l})}function b(e,t,n,a){var r=o.default.cornerstone.pixelToCanvas,i=r(t,{x:n.x+1,y:n.y}),l=r(t,{x:n.x+1,y:n.y+1});i.x-=a.i.x,i.y-=a.i.y,l.x-=a.i.x,l.y-=a.i.y,e.push({start:i,end:l})}},"./eventListeners/mouseEventListeners.js":function(e,t,n){"use strict";n.r(t);var a,o=n("./events.js"),r=n("./externalModules.js"),i=n("./util/copyPoints.js"),l=n("./util/triggerEvent.js"),s=n("./util/logger.js"),u=Object(s.getLogger)("eventListeners:mouseEventListeners"),d=!0,c=new Map;function f(e){if("number"==typeof e.buttons)return e.buttons;switch(e.which){case 0:return 0;case 1:return 1;case 2:return 4;case 3:return 2}return 0}function g(){d=!1}function m(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image){var a=o.default.MOUSE_DOUBLE_CLICK,s={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};s.canvas=r.default.cornerstone.pixelToCanvas(t,s.image);var d=Object(i.default)(s);u.log("double-click: %o",f(e));var c={event:e,buttons:f(e),viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:s,lastPoints:d,currentPoints:s,deltaPoints:{x:0,y:0},type:a};Object(l.default)(t,a,c)}}function h(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image){a=setTimeout(g,200),t.removeEventListener("mousemove",v);var s={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};s.canvas=r.default.cornerstone.pixelToCanvas(t,s.image);var m=Object(i.default)(s),h={event:e,buttons:f(e),viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:s,lastPoints:m,currentPoints:s,deltaPoints:{x:0,y:0},type:o.default.MOUSE_DOWN};Object(l.default)(h.element,o.default.MOUSE_DOWN,h)&&(h.type=o.default.MOUSE_DOWN_ACTIVATE,Object(l.default)(h.element,o.default.MOUSE_DOWN_ACTIVATE,h)),document.addEventListener("mousemove",p),document.addEventListener("mouseup",b),c.set(p,"mousemove"),c.set(b,"mouseup")}function p(e){var a=o.default.MOUSE_DRAG,d={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=r.default.cornerstone.pixelToCanvas(t,d.image);var c={page:r.default.cornerstoneMath.point.subtract(d.page,m.page),image:r.default.cornerstoneMath.point.subtract(d.image,m.image),client:r.default.cornerstoneMath.point.subtract(d.client,m.client),canvas:r.default.cornerstoneMath.point.subtract(d.canvas,m.canvas)};u.log("mousemove: %o",f(e));var g={buttons:f(e),viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:s,lastPoints:m,currentPoints:d,deltaPoints:c,type:a,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};Object(l.default)(g.element,a,g),m=Object(i.default)(d)}function b(e){clearTimeout(a);var i=o.default.MOUSE_UP;d&&(i=o.default.MOUSE_CLICK);var g={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};g.canvas=r.default.cornerstone.pixelToCanvas(t,g.image);var h={page:r.default.cornerstoneMath.point.subtract(g.page,m.page),image:r.default.cornerstoneMath.point.subtract(g.image,m.image),client:r.default.cornerstoneMath.point.subtract(g.client,m.client),canvas:r.default.cornerstoneMath.point.subtract(g.canvas,m.canvas)};u.log("mouseup: %o",f(e));var j={event:e,buttons:f(e),viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:s,lastPoints:m,currentPoints:g,deltaPoints:h,type:i};Object(l.default)(j.element,i,j),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",b),c.delete(p),c.delete(b),t.addEventListener("mousemove",v),d=!0}}function v(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image){var a=o.default.MOUSE_MOVE,s={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};s.canvas=r.default.cornerstone.pixelToCanvas(t,s.image);var u=Object(i.default)(s),d={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=r.default.cornerstone.pixelToCanvas(t,d.image);var c={page:r.default.cornerstoneMath.point.subtract(d.page,u.page),image:r.default.cornerstoneMath.point.subtract(d.image,u.image),client:r.default.cornerstoneMath.point.subtract(d.client,u.client),canvas:r.default.cornerstoneMath.point.subtract(d.canvas,u.canvas)},f={viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:s,lastPoints:u,currentPoints:d,deltaPoints:c,type:a};Object(l.default)(t,a,f),u=Object(i.default)(d)}}function p(e){e.removeEventListener("mousedown",h),e.removeEventListener("mousemove",v),e.removeEventListener("dblclick",m),c.forEach((function(e,t){document.removeEventListener(e,t)})),c.clear()}t.default={enable:function(e){p(e),e.addEventListener("mousedown",h),e.addEventListener("mousemove",v),e.addEventListener("dblclick",m)},disable:p}},"./eventListeners/onImageRenderedBrushEventHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./eventListeners/internals/renderSegmentation.js"),r=Object(a.getModule)("segmentation");t.default=function(e){var t=e.detail.element,n=r.configuration,a=r.getters.labelmaps3D(t),i=a.activeLabelmapIndex,l=a.labelmaps3D,s=a.currentImageIdIndex;l&&(n.shouldRenderInactiveLabelmaps&&function(e,t,n,a){for(var r=0;r<t.length;r++){var i=t[r];if(r!==n&&i){var l=i.labelmaps2D[a];l&&Object(o.default)(e,i,r,l,!1)}}}(e,l,i,s),function(e,t,n,a){var r=t[n];if(r){var i=r.labelmaps2D[a];i&&Object(o.default)(e,r,n,i,!0)}}(e,l,i,s))}},"./eventListeners/preventGhostClick.js":function(e,t,n){"use strict";n.r(t);var a,o;function r(e,t){var n=Date.now();if(e!==a){if(n-o<=2e3)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;a=e}o=n}var i=r.bind(null,0),l=r.bind(null,1);function s(e,t,n){var a=n?i:l;t.forEach((function(t){e.addEventListener(t,a,{passive:!1})}))}function u(e,t,n){var a=n?i:l;t.forEach((function(t){e.removeEventListener(t,a)}))}var d=["mousedown","mouseup"],c=["touchstart","touchend"];function f(e){u(e,d,0),u(e,c,1)}t.default={enable:function(e){f(e),s(e,d,0),s(e,c,1)},disable:f}},"./eventListeners/touchEventListeners.js":function(e,t,n){"use strict";n.r(t);var a,o,r,i,l,s,u,d,c,f=n("./events.js"),g=n("./externalModules.js"),m=n("./util/copyPoints.js"),h=n("./eventListeners/preventGhostClick.js"),v=n("./util/triggerEvent.js"),p=n("./toolOptions.js"),b=1,j=0,x=!1,y=!1,T="touchInput";function w(e){var t=e.currentTarget||e.srcEvent.currentTarget,n=g.default.cornerstone.getEnabledElement(t);if(n.image){var h,p,T,w;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(y=!1,clearTimeout(u)),e.type){case"tap":y=!1,clearTimeout(u),(o={page:g.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:g.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=g.default.cornerstone.pixelToCanvas(t,o.image),h=f.default.TAP,l={event:e,viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:o,type:h,isTouchEvent:!0},Object(v.default)(t,h,l);break;case"doubletap":y=!1,clearTimeout(u),(o={page:g.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:g.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=g.default.cornerstone.pixelToCanvas(t,o.image),h=f.default.DOUBLE_TAP,l={event:e,viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:o,type:h,isTouchEvent:!0},Object(v.default)(t,h,l);break;case"pinchstart":y=!1,clearTimeout(u),b=1;break;case"pinchmove":if(y=!1,clearTimeout(u),!0===x){b=e.scale,x=!1;break}p=(e.scale-b)/b,(a={page:e.center,image:g.default.cornerstone.pageToPixel(t,e.center.x,e.center.y)}).canvas=g.default.cornerstone.pixelToCanvas(t,a.image),h=f.default.TOUCH_PINCH,l={event:e,startPoints:a,viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,direction:e.scale<1?1:-1,scaleChange:p,type:h,isTouchEvent:!0},Object(v.default)(t,h,l),b=e.scale;break;case"touchstart":b=1,clearTimeout(u),clearTimeout(s),s=setTimeout((function(){(a={page:g.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:g.default.cornerstone.pageToPixel(t,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=g.default.cornerstone.pixelToCanvas(t,a.image),h=f.default.TOUCH_START,e.touches.length>1&&(h=f.default.MULTI_TOUCH_START),l={event:e,viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,currentPoints:a,type:h,isTouchEvent:!0},!0===Object(v.default)(t,h,l)&&(h=f.default.TOUCH_START_ACTIVE,e.touches.length>1&&(h=f.default.MULTI_TOUCH_START_ACTIVE),l.type=h,Object(v.default)(t,h,l)),r=Object(m.default)(a)}),50),y=!0,d=0,u=setTimeout((function(){y&&((o={page:g.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:g.default.cornerstone.pageToPixel(t,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=g.default.cornerstone.pixelToCanvas(t,a.image),h=f.default.TOUCH_PRESS,l={event:e,viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:o,type:h,isTouchEvent:!0},Object(v.default)(t,h,l))}),700);break;case"touchend":b=1,y=!1,clearTimeout(u),setTimeout((function(){(a={page:g.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:g.default.cornerstone.pageToPixel(t,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}).canvas=g.default.cornerstone.pixelToCanvas(t,a.image),h=f.default.TOUCH_END,l={event:e,viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,currentPoints:a,type:h,isTouchEvent:!0},Object(v.default)(t,h,l)}),50);break;case"panmove":T={x:e.deltaX-c.x,y:e.deltaY-c.y},c={x:e.deltaX,y:e.deltaY},(o={page:{x:r.page.x+T.x,y:r.page.y+T.y},image:g.default.cornerstone.pageToPixel(t,r.page.x+T.x,r.page.y+T.y),client:{x:r.client.x+T.x,y:r.client.y+T.y}}).canvas=g.default.cornerstone.pixelToCanvas(t,o.image),i={page:g.default.cornerstoneMath.point.subtract(o.page,r.page),image:g.default.cornerstoneMath.point.subtract(o.image,r.image),client:g.default.cornerstoneMath.point.subtract(o.client,r.client),canvas:g.default.cornerstoneMath.point.subtract(o.canvas,r.canvas)},(d+=Math.sqrt(i.page.x*i.page.x+i.page.y*i.page.y))>5&&(y=!1,clearTimeout(u)),h=f.default.TOUCH_DRAG,e.pointers.length>1&&(h=f.default.MULTI_TOUCH_DRAG),l={viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,lastPoints:r,currentPoints:o,deltaPoints:i,numPointers:e.pointers.length,type:h,isTouchEvent:!0},Object(v.default)(t,h,l),r=Object(m.default)(o);break;case"panstart":c={x:e.deltaX,y:e.deltaY},(o={page:g.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:g.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=g.default.cornerstone.pixelToCanvas(t,o.image),r=Object(m.default)(o);break;case"panend":if(y=!1,clearTimeout(u),!r)return!1;(o={page:g.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:g.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=g.default.cornerstone.pixelToCanvas(t,o.image),i={page:g.default.cornerstoneMath.point.subtract(o.page,r.page),image:g.default.cornerstoneMath.point.subtract(o.image,r.image),client:g.default.cornerstoneMath.point.subtract(o.client,r.client),canvas:g.default.cornerstoneMath.point.subtract(o.canvas,r.canvas)},h=f.default.TOUCH_DRAG_END,l={event:e.srcEvent,viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,lastPoints:r,currentPoints:o,deltaPoints:i,type:h,isTouchEvent:!0},Object(v.default)(t,h,l),2==e.pointers.length-e.changedPointers.length&&(x=!0);break;case"rotatemove":y=!1,clearTimeout(u),w=e.rotation-j,j=e.rotation,h=f.default.TOUCH_ROTATE,l={event:e.srcEvent,viewport:g.default.cornerstone.getViewport(t),image:n.image,element:t,rotation:w,type:h},Object(v.default)(t,h,l)}return!1}}function C(e){h.default.disable(e),["touchstart","touchend"].forEach((function(t){e.removeEventListener(t,w)}));var t=Object(p.getToolOptions)(T,e),n=t.hammer;n&&(n.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",w),n.input.destroy()),t.hammer=null,Object(p.clearToolOptions)(T,e)}var O={enable:function(e){C(e);var t=g.default.Hammer,n={inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput},a=new t.Manager(e,n),o={pointers:0,direction:t.DIRECTION_ALL,threshold:0},r=new t.Pan(o),i=new t.Pinch({threshold:0}),l=new t.Rotate({threshold:0});i.recognizeWith(r),i.recognizeWith(l),l.recognizeWith(r);var s=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});s.recognizeWith(r),a.add([s,r,l,i]),a.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",w),h.default.enable(e),["touchstart","touchend"].forEach((function(t){e.addEventListener(t,w,{passive:!1})}));var u=Object(p.getToolOptions)(T,e);u.hammer=a,Object(p.setToolOptions)(T,e,u)},disable:C};t.default=O},"./eventListeners/wheelEventListener.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./externalModules.js"),r=n("./util/triggerEvent.js"),i=n("./eventListeners/internals/normalizeWheel.js");function l(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image&&!(e.deltaY>-1&&e.deltaY<1)){e.preventDefault();var l=e.pageX,s=e.pageY,u=o.default.cornerstone.pageToPixel(t,l,s),d=Object(i.default)(e),c=d.spinX,f=d.spinY,g=d.pixelX,m=d.pixelY,h=f<0?-1:1,v={element:t,viewport:o.default.cornerstone.getViewport(t),detail:e,image:n.image,direction:h,spinX:c,spinY:f,pixelX:g,pixelY:m,pageX:l,pageY:s,imageX:u.x,imageY:u.y};Object(r.default)(t,a.default.MOUSE_WHEEL,v)}}function s(e){e.removeEventListener("wheel",l,{passive:!1})}t.default={enable:function(e){s(e),e.addEventListener("wheel",l,{passive:!1})},disable:s}},"./eventListeners/windowResizeHandler.js":function(e,t,n){"use strict";n.r(t),n.d(t,"forceEnabledElementResize",(function(){return s}));var a,o=n("./store/index.js"),r=n("./externalModules.js"),i=function(){window.removeEventListener("resize",l,!1)};function l(){a||(a=setTimeout((function(){a=null,s()}),66))}var s=function(){o.state.enabledElements.forEach((function(e){r.default.cornerstone.resize(e)}))};t.default={enable:function(){i(),window.addEventListener("resize",l,!1)},disable:i}},"./events.js":function(e,t,n){"use strict";n.r(t),t.default={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_COMPLETED:"cornerstonetoolsmeasurementcompleted",MEASUREMENT_REMOVED:"cornerstonetoolsmeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonetoolsstackscroll",STACK_PREFETCH_IMAGE_LOADED:"cornerstonetoolsstackprefetchimageloaded",STACK_PREFETCH_DONE:"cornerstonetoolsstackprefetchdone",LABELMAP_MODIFIED:"cornersontetoolslabelmapmodified"}},"./externalModules.js":function(e,t,n){"use strict";n.r(t);var a=window.cornerstone,o=window.cornerstoneMath,r=window.Hammer;t.default={set cornerstone(e){a=e},get cornerstone(){return a},set cornerstoneMath(e){o=e},get cornerstoneMath(){return o},set Hammer(e){r=e},get Hammer(){return r}}},"./importInternal.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js");t.default=function(e){return a.lib[e]}},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/annotation/index.js");n.d(t,"AngleTool",(function(){return a.AngleTool})),n.d(t,"ArrowAnnotateTool",(function(){return a.ArrowAnnotateTool})),n.d(t,"BidirectionalTool",(function(){return a.BidirectionalTool})),n.d(t,"CircleRoiTool",(function(){return a.CircleRoiTool})),n.d(t,"CobbAngleTool",(function(){return a.CobbAngleTool})),n.d(t,"EllipticalRoiTool",(function(){return a.EllipticalRoiTool})),n.d(t,"FreehandRoiTool",(function(){return a.FreehandRoiTool})),n.d(t,"LengthTool",(function(){return a.LengthTool})),n.d(t,"ProbeTool",(function(){return a.ProbeTool})),n.d(t,"RectangleRoiTool",(function(){return a.RectangleRoiTool})),n.d(t,"TextMarkerTool",(function(){return a.TextMarkerTool}));var o=n("./tools/segmentation/index.js");n.d(t,"BrushTool",(function(){return o.BrushTool})),n.d(t,"SphericalBrushTool",(function(){return o.SphericalBrushTool})),n.d(t,"RectangleScissorsTool",(function(){return o.RectangleScissorsTool})),n.d(t,"FreehandScissorsTool",(function(){return o.FreehandScissorsTool})),n.d(t,"CircleScissorsTool",(function(){return o.CircleScissorsTool})),n.d(t,"CorrectionScissorsTool",(function(){return o.CorrectionScissorsTool}));var r=n("./tools/index.js");n.d(t,"CrosshairsTool",(function(){return r.CrosshairsTool})),n.d(t,"DoubleTapFitToWindowTool",(function(){return r.DoubleTapFitToWindowTool})),n.d(t,"DragProbeTool",(function(){return r.DragProbeTool})),n.d(t,"EraserTool",(function(){return r.EraserTool})),n.d(t,"FreehandRoiSculptorTool",(function(){return r.FreehandRoiSculptorTool})),n.d(t,"MagnifyTool",(function(){return r.MagnifyTool})),n.d(t,"OverlayTool",(function(){return r.OverlayTool})),n.d(t,"OrientationMarkersTool",(function(){return r.OrientationMarkersTool})),n.d(t,"PanMultiTouchTool",(function(){return r.PanMultiTouchTool})),n.d(t,"PanTool",(function(){return r.PanTool})),n.d(t,"ReferenceLinesTool",(function(){return r.ReferenceLinesTool})),n.d(t,"RotateTool",(function(){return r.RotateTool})),n.d(t,"RotateTouchTool",(function(){return r.RotateTouchTool})),n.d(t,"ScaleOverlayTool",(function(){return r.ScaleOverlayTool})),n.d(t,"StackScrollMouseWheelTool",(function(){return r.StackScrollMouseWheelTool})),n.d(t,"StackScrollMultiTouchTool",(function(){return r.StackScrollMultiTouchTool})),n.d(t,"StackScrollTool",(function(){return r.StackScrollTool})),n.d(t,"WwwcRegionTool",(function(){return r.WwwcRegionTool})),n.d(t,"WwwcTool",(function(){return r.WwwcTool})),n.d(t,"ZoomMouseWheelTool",(function(){return r.ZoomMouseWheelTool})),n.d(t,"ZoomTool",(function(){return r.ZoomTool})),n.d(t,"ZoomTouchPinchTool",(function(){return r.ZoomTouchPinchTool}));var i=n("./init.js");n.d(t,"init",(function(){return i.default}));var l=n("./stackTools/stackPrefetch.js");n.d(t,"stackPrefetch",(function(){return l.default}));var s=n("./stackTools/stackRenderers.js");n.d(t,"stackRenderers",(function(){return s.default}));var u=n("./stackTools/playClip.js");n.d(t,"playClip",(function(){return u.playClip})),n.d(t,"stopClip",(function(){return u.stopClip}));var d=n("./store/index.js");n.d(t,"store",(function(){return d.default})),n.d(t,"getModule",(function(){return d.getModule}));var c=n("./store/getToolForElement.js");n.d(t,"getToolForElement",(function(){return c.default}));var f=n("./store/addTool.js");n.d(t,"addTool",(function(){return f.addTool})),n.d(t,"addToolForElement",(function(){return f.addToolForElement}));var g=n("./store/removeTool.js");n.d(t,"removeTool",(function(){return g.removeTool})),n.d(t,"removeToolForElement",(function(){return g.removeToolForElement}));var m=n("./store/setToolOptions.js");n.d(t,"setToolOptions",(function(){return m.setToolOptions})),n.d(t,"setToolOptionsForElement",(function(){return m.setToolOptionsForElement}));var h=n("./store/setToolMode.js");n.d(t,"setToolActive",(function(){return h.setToolActive})),n.d(t,"setToolActiveForElement",(function(){return h.setToolActiveForElement})),n.d(t,"setToolEnabled",(function(){return h.setToolEnabled})),n.d(t,"setToolEnabledForElement",(function(){return h.setToolEnabledForElement})),n.d(t,"setToolDisabled",(function(){return h.setToolDisabled})),n.d(t,"setToolDisabledForElement",(function(){return h.setToolDisabledForElement})),n.d(t,"setToolPassive",(function(){return h.setToolPassive})),n.d(t,"setToolPassiveForElement",(function(){return h.setToolPassiveForElement}));var v=n("./store/isToolActiveForElement.js");n.d(t,"isToolActiveForElement",(function(){return v.default}));var p=n("./stateManagement/toolState.js");n.d(t,"addToolState",(function(){return p.addToolState})),n.d(t,"getToolState",(function(){return p.getToolState})),n.d(t,"removeToolState",(function(){return p.removeToolState})),n.d(t,"clearToolState",(function(){return p.clearToolState})),n.d(t,"setElementToolStateManager",(function(){return p.setElementToolStateManager})),n.d(t,"getElementToolStateManager",(function(){return p.getElementToolStateManager}));var b=n("./stateManagement/textStyle.js");n.d(t,"textStyle",(function(){return b.default}));var j=n("./stateManagement/toolStyle.js");n.d(t,"toolStyle",(function(){return j.default}));var x=n("./stateManagement/toolColors.js");n.d(t,"toolColors",(function(){return x.default}));var y=n("./stateManagement/toolCoordinates.js");n.d(t,"toolCoordinates",(function(){return y.default}));var T=n("./stateManagement/stackSpecificStateManager.js");n.d(t,"stackSpecificStateManager",(function(){return T.stackSpecificStateManager})),n.d(t,"newStackSpecificToolStateManager",(function(){return T.newStackSpecificToolStateManager})),n.d(t,"addStackStateManager",(function(){return T.addStackStateManager}));var w=n("./stateManagement/loadHandlerManager.js");n.d(t,"loadHandlerManager",(function(){return w.default}));var C=n("./stateManagement/imageIdSpecificStateManager.js");n.d(t,"newImageIdSpecificToolStateManager",(function(){return C.newImageIdSpecificToolStateManager})),n.d(t,"globalImageIdSpecificToolStateManager",(function(){return C.globalImageIdSpecificToolStateManager}));var O=n("./stateManagement/frameOfReferenceStateManager.js");n.d(t,"newFrameOfReferenceSpecificToolStateManager",(function(){return O.newFrameOfReferenceSpecificToolStateManager})),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",(function(){return O.globalFrameOfReferenceSpecificToolStateManager}));var E=n("./eventListeners/windowResizeHandler.js");n.d(t,"forceEnabledElementResize",(function(){return E.forceEnabledElementResize}));var M=n("./orientation/index.js");n.d(t,"orientation",(function(){return M.default}));var I=n("./util/SaveAs.js");n.d(t,"SaveAs",(function(){return I.default}));var S=n("./util/logger.js");n.d(t,"enableLogger",(function(){return S.enable})),n.d(t,"disableLogger",(function(){return S.disable}));var P=n("./thirdParty/register.js");n.d(t,"register",(function(){return P.default}));var _=n("./thirdParty/registerSome.js");n.d(t,"registerSome",(function(){return _.default}));var D=n("./synchronization/wwwcSynchronizer.js");n.d(t,"wwwcSynchronizer",(function(){return D.default}));var L=n("./synchronization/updateImageSynchronizer.js");n.d(t,"updateImageSynchronizer",(function(){return L.default}));var k=n("./synchronization/Synchronizer.js");n.d(t,"Synchronizer",(function(){return k.default}));var A=n("./synchronization/stackScrollSynchronizer.js");n.d(t,"stackScrollSynchronizer",(function(){return A.default}));var R=n("./synchronization/stackImagePositionSynchronizer.js");n.d(t,"stackImagePositionSynchronizer",(function(){return R.default}));var H=n("./synchronization/stackImagePositionOffsetSynchronizer.js");n.d(t,"stackImagePositionOffsetSynchronizer",(function(){return H.default}));var B=n("./synchronization/stackImageIndexSynchronizer.js");n.d(t,"stackImageIndexSynchronizer",(function(){return B.default}));var U=n("./synchronization/panZoomSynchronizer.js");n.d(t,"panZoomSynchronizer",(function(){return U.default}));var F=n("./externalModules.js");n.d(t,"external",(function(){return F.default}));var N=n("./events.js");n.d(t,"EVENTS",(function(){return N.default}));var V=n("./version.js");n.d(t,"version",(function(){return V.default}));var z=n("./importInternal.js");n.d(t,"importInternal",(function(){return z.default})),n.d(t,"import",(function(){return z.default}));var W={AngleTool:a.AngleTool,ArrowAnnotateTool:a.ArrowAnnotateTool,BidirectionalTool:a.BidirectionalTool,CircleRoiTool:a.CircleRoiTool,CobbAngleTool:a.CobbAngleTool,EllipticalRoiTool:a.EllipticalRoiTool,FreehandRoiTool:a.FreehandRoiTool,LengthTool:a.LengthTool,ProbeTool:a.ProbeTool,RectangleRoiTool:a.RectangleRoiTool,TextMarkerTool:a.TextMarkerTool,BrushTool:o.BrushTool,SphericalBrushTool:o.SphericalBrushTool,RectangleScissorsTool:o.RectangleScissorsTool,FreehandScissorsTool:o.FreehandScissorsTool,CircleScissorsTool:o.CircleScissorsTool,CorrectionScissorsTool:o.CorrectionScissorsTool,CrosshairsTool:r.CrosshairsTool,DoubleTapFitToWindowTool:r.DoubleTapFitToWindowTool,DragProbeTool:r.DragProbeTool,EraserTool:r.EraserTool,FreehandRoiSculptorTool:r.FreehandRoiSculptorTool,MagnifyTool:r.MagnifyTool,OverlayTool:r.OverlayTool,OrientationMarkersTool:r.OrientationMarkersTool,PanMultiTouchTool:r.PanMultiTouchTool,PanTool:r.PanTool,ReferenceLinesTool:r.ReferenceLinesTool,RotateTool:r.RotateTool,RotateTouchTool:r.RotateTouchTool,ScaleOverlayTool:r.ScaleOverlayTool,StackScrollMouseWheelTool:r.StackScrollMouseWheelTool,StackScrollMultiTouchTool:r.StackScrollMultiTouchTool,StackScrollTool:r.StackScrollTool,WwwcRegionTool:r.WwwcRegionTool,WwwcTool:r.WwwcTool,ZoomMouseWheelTool:r.ZoomMouseWheelTool,ZoomTool:r.ZoomTool,ZoomTouchPinchTool:r.ZoomTouchPinchTool,init:i.default,stackPrefetch:l.default,stackRenderers:s.default,playClip:u.playClip,stopClip:u.stopClip,store:d.default,getModule:d.getModule,getToolForElement:c.default,addTool:f.addTool,addToolForElement:f.addToolForElement,removeTool:g.removeTool,removeToolForElement:g.removeToolForElement,setToolOptions:m.setToolOptions,setToolOptionsForElement:m.setToolOptionsForElement,isToolActiveForElement:v.default,setToolActive:h.setToolActive,setToolActiveForElement:h.setToolActiveForElement,setToolEnabled:h.setToolEnabled,setToolEnabledForElement:h.setToolEnabledForElement,setToolDisabled:h.setToolDisabled,setToolDisabledForElement:h.setToolDisabledForElement,setToolPassive:h.setToolPassive,setToolPassiveForElement:h.setToolPassiveForElement,addToolState:p.addToolState,getToolState:p.getToolState,removeToolState:p.removeToolState,clearToolState:p.clearToolState,setElementToolStateManager:p.setElementToolStateManager,getElementToolStateManager:p.getElementToolStateManager,textStyle:b.default,toolStyle:j.default,toolColors:x.default,toolCoordinates:y.default,stackSpecificStateManager:T.stackSpecificStateManager,newStackSpecificToolStateManager:T.newStackSpecificToolStateManager,addStackStateManager:T.addStackStateManager,loadHandlerManager:w.default,newImageIdSpecificToolStateManager:C.newImageIdSpecificToolStateManager,globalImageIdSpecificToolStateManager:C.globalImageIdSpecificToolStateManager,newFrameOfReferenceSpecificToolStateManager:O.newFrameOfReferenceSpecificToolStateManager,globalFrameOfReferenceSpecificToolStateManager:O.globalFrameOfReferenceSpecificToolStateManager,forceEnabledElementResize:E.forceEnabledElementResize,orientation:M.default,SaveAs:I.default,enableLogger:S.enable,disableLogger:S.disable,importInternal:z.default,import:z.default,register:P.default,registerSome:_.default,wwwcSynchronizer:D.default,updateImageSynchronizer:L.default,Synchronizer:k.default,stackScrollSynchronizer:A.default,stackImagePositionSynchronizer:R.default,stackImagePositionOffsetSynchronizer:H.default,stackImageIndexSynchronizer:B.default,panZoomSynchronizer:U.default,external:F.default,EVENTS:N.default,version:V.default};t.default=W},"./init.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./store/index.js"),r=n("./store/internals/addEnabledElement.js"),i=n("./store/internals/removeEnabledElement.js"),l=n("./eventListeners/windowResizeHandler.js");function s(){!function(){var e=a.default.cornerstone,t=e.EVENTS.ELEMENT_ENABLED,n=e.EVENTS.ELEMENT_DISABLED;e.events.removeEventListener(t,r.default),e.events.removeEventListener(n,i.default)}();var e=a.default.cornerstone,t=e.EVENTS.ELEMENT_ENABLED,n=e.EVENTS.ELEMENT_DISABLED;e.events.addEventListener(t,r.default),e.events.addEventListener(n,i.default)}function u(){var e=o.default.modules;Object.keys(e).forEach((function(t){"function"==typeof e[t].onRegisterCallback&&e[t].onRegisterCallback()}))}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(),u();var t=Object(o.getModule)("globalConfiguration");Array.isArray(e)?e.forEach((function(e){var t=e.moduleName,n=e.configuration,a=Object(o.getModule)(t);a&&(a.configuration=Object.assign({},a.configuration,n))})):t.configuration=Object.assign({},t.configuration,e),t.configuration.autoResizeViewports&&l.default.enable()}},"./lib.js":function(e,t,n){"use strict";n.r(t),n.d(t,"lib",(function(){return ee}));var a=n("./tools/base/BaseTool.js"),o=n("./tools/base/BaseAnnotationTool.js"),r=n("./tools/base/BaseBrushTool.js"),i=n("./manipulators/index.js"),l=n("./util/findAndMoveHelpers.js"),s=n("./mixins/index.js"),u=n("./tools/cursors/index.js"),d=n("./drawing/index.js"),c=n("./util/clip.js"),f=n("./util/debounce.js"),g=n("./util/deepmerge.js"),m=n("./util/getDefault.js"),h=n("./util/getPixelSpacing.js"),v=n("./util/isEmptyObject.js"),p=n("./util/isObject.js"),b=n("./util/isPointInImage.js"),j=n("./util/isPointInPolygon.js"),x=n("./util/throttle.js"),y=n("./util/wait.js"),T=n("./util/getKeyPressData.js"),w=n("./util/getProximityThreshold.js"),C=n("./drawing/drawTextBox.js"),O=n("./drawing/drawArrow.js"),E=n("./drawing/drawLink.js"),M=n("./drawing/drawLinkedTextBox.js"),I=n("./drawing/drawHandles.js"),S=n("./util/getActiveTool.js"),P=n("./util/getLuminance.js"),_=n("./util/getROITextBoxCoords.js"),D=n("./util/copyPoints.js"),L=n("./util/calculateSUV.js"),k=n("./util/setContextToDisplayFontSize.js"),A=n("./util/scrollToIndex.js"),R=n("./util/scroll.js"),H=n("./util/roundToDecimal.js"),B=n("./util/pointProjector.js"),U=n("./util/lineSegDistance.js"),F=n("./util/logger.js"),N=n("./util/pointInsideBoundingBox.js"),V=n("./util/makeUnselectable.js"),z=n("./util/getRGBPixels.js"),W=n("./util/getMaxSimultaneousRequests.js"),q=n("./util/angleBetweenPoints.js"),G=n("./util/numbersWithCommas.js"),Y=n("./tools/cursors/MouseCursor.js"),X=n("./util/ellipse/index.js"),Z=n("./util/freehand/index.js"),K=n("./util/segmentation/index.js"),J=n("./util/zoom/index.js"),$=n("./util/triggerEvent.js"),Q=n("./util/convertToVector3.js"),ee={"base/BaseTool":a.default,"base/BaseAnnotationTool":o.default,"base/BaseBrushTool":r.default,"tools/cursors/MouseCursor":Y.default,"tools/cursors":u,"manipulators/anyHandlesOutsideImage":i.anyHandlesOutsideImage,"manipulators/getHandleNearImagePoint":i.getHandleNearImagePoint,"manipulators/getHandlePixelPosition":i.getHandlePixelPosition,"manipulators/handleActivator":i.handleActivator,"manipulators/moveAllHandles":i.moveAllHandles,"manipulators/moveHandle":i.moveHandle,"manipulators/moveNewHandle":i.moveNewHandle,"manipulators/moveHandleNearImagePoint":l.moveHandleNearImagePoint,"manipulators/findHandleDataNearImagePoint":l.findHandleDataNearImagePoint,"manipulators/moveAnnotation":l.moveAnnotation,"mixins/activeOrDisabledBinaryTool":s.default.activeOrDisabledBinaryTool,"mixins/enabledOrDisabledBinaryTool":s.default.enabledOrDisabledBinaryTool,"drawing/getNewContext":d.getNewContext,"drawing/draw":d.draw,"drawing/path":d.path,"drawing/setShadow":d.setShadow,"drawing/drawLine":d.drawLine,"drawing/drawLines":d.drawLines,"drawing/drawJoinedLines":d.drawJoinedLines,"drawing/drawCircle":d.drawCircle,"drawing/drawEllipse":d.drawEllipse,"drawing/drawRect":d.drawRect,"drawing/fillOutsideRect":d.fillOutsideRect,"drawing/drawTextBox":C.default,"drawing/drawArrow":O.default,"drawing/fillBox":d.fillBox,"drawing/fillTextLines":d.fillTextLines,"drawing/drawLink":E.default,"drawing/drawLinkedTextBox":M.default,"drawing/drawHandles":I.default,"drawing/textBoxWidth":C.textBoxWidth,"util/getActiveTool":S.default,"util/getLuminance":P.default,"util/getROITextBoxCoords":_.default,"util/copyPoints":D.default,"util/calculateSUV":L.default,"util/setContextToDisplayFontSize":k.default,"util/scrollToIndex":A.default,"util/scroll":R.default,"util/roundToDecimal":H.default,"util/projectPatientPointToImagePlane":B.projectPatientPointToImagePlane,"util/imagePointToPatientPoint":B.imagePointToPatientPoint,"util/planePlaneIntersection":B.planePlaneIntersection,"util/pointInsideBoundingBox":N.default,"util/makeUnselectable":V.default,"util/getRGBPixels":z.default,"util/getBrowserInfo":W.getBrowserInfo,"util/isMobileDevice":W.isMobileDevice,"util/angleBetweenPoints":q.default,"util/numbersWithCommas":G.default,"util/lineSegDistance":U.default,"util/triggerEvent":$.default,"util/convertToVector3":Q.default,"util/clip":c.clip,"util/clipToBox":c.clipToBox,"util/clipBoxToDisplayedArea":c.clipBoxToDisplayedArea,"util/debounce":f.default,"util/deepmerge":g.default,"util/getDefault":m.default,"util/getProximityThreshold":w.default,"util/getPixelSpacing":h.default,"util/isEmptyObject":v.default,"util/isObject":p.default,"util/isPointInImage":b.default,"util/isPointInPolygon":j.default,"util/getLogger":F.getLogger,"util/throttle":x.default,"util/wait":y.wait,"util/waitForEnabledElementImageToLoad":y.waitForEnabledElementImageToLoad,"util/getKeyPressData":T.default,"util/ellipseUtils":X.default,"util/freehandUtils":Z.default,"util/segmentationUtils":K,"util/zoomUtils":J.default}},"./manipulators/anyHandlesOutsideImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){var n=e.image,o={left:0,top:0,width:n.width,height:n.height},r=!1;return Object.keys(t).forEach((function(e){var n=t[e];!0!==n.allowedOutsideImage&&!1===a.default.cornerstoneMath.point.insideRect(n,o)&&(r=!0)})),r}},"./manipulators/getHandleNearImagePoint.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n("./externalModules.js"),i=n("./util/pointInsideBoundingBox.js"),l=function(e,t,n,a){if(e.hasOwnProperty("pointNearHandle")){if(e.pointNearHandle(t,e,n))return!0}else if(!0===e.hasBoundingBox){if(Object(i.default)(e,n))return!0}else{var o=r.default.cornerstone.pixelToCanvas(t,e);if(r.default.cornerstoneMath.point.distance(o,n)<=a)return!0}return!1};t.default=function e(t,n,a,r){var i;if(n){if(Array.isArray(n))for(var s=Object.keys(n),u=0;u<s.length;u++){var d=n[s[u]];if(d.hasOwnProperty("x")&&d.hasOwnProperty("y")&&l(d,t,a,r)){i=d;break}}else if("object"===o()(n))for(var c=Object.keys(n),f=0;f<c.length;f++){var g=c[f];if(Array.isArray(n[g])){if(i=e(t,n[g],a,r))break}else{var m=n[g];if(l(m,t,a,r)){i=m;break}}}return i}}},"./manipulators/getHandlePixelPosition.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./store/index.js");t.default=function(e,t){var n=e.currentPoints,r=e.element,i=n.page,l=o.state.handleTouchOffset,s=0,u=0;return"touch"===t&&(s=l.x,u=l.y),a.default.cornerstone.pageToPixel(r,i.x+s,i.y+u)}},"./manipulators/handleActivator.js":function(e,t,n){"use strict";n.r(t);var a=n("./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n,o){o||(o=6);var r=function(e){var t;return Object.keys(e).forEach((function(n){var a=e[n];!0!==a.active||(t=a)})),t}(t),i=Object(a.default)(e,t,n,o);return r!==i&&(void 0!==i&&(i.active=!0),void 0!==r&&(r.active=!1),!0)}},"./manipulators/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./manipulators/anyHandlesOutsideImage.js");n.d(t,"anyHandlesOutsideImage",(function(){return a.default}));var o=n("./manipulators/getHandleNearImagePoint.js");n.d(t,"getHandleNearImagePoint",(function(){return o.default}));var r=n("./manipulators/getHandlePixelPosition.js");n.d(t,"getHandlePixelPosition",(function(){return r.default}));var i=n("./manipulators/handleActivator.js");n.d(t,"handleActivator",(function(){return i.default}));var l=n("./manipulators/moveAllHandles.js");n.d(t,"moveAllHandles",(function(){return l.default}));var s=n("./manipulators/moveHandle.js");n.d(t,"moveHandle",(function(){return s.default}));var u=n("./manipulators/moveNewHandle.js");n.d(t,"moveNewHandle",(function(){return u.default}))},"./manipulators/moveAllHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./externalModules.js"),r=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),l=n("./util/triggerEvent.js"),s=n("./util/clip.js"),u=n("./store/index.js"),d=n("./util/getActiveTool.js"),c=n("./tools/base/BaseAnnotationTool.js"),f=n("./util/logger.js"),g=Object(f.getLogger)("manipulators:moveAllHandles"),m=Object(u.getModule)("manipulatorState"),h={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},v={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,u=i.detail,f=u.element,g=u.image,m=u.buttons,h=i.detail.deltaPoints.image,v=h.x,p=h.y;t.active=!0,t.invalidated=!0;for(var b=Object.keys(t.handles),j=0;j<b.length;j++){var x=b[j],y=t.handles[x];!0!==y.movesIndependently&&y.hasOwnProperty("x")&&y.hasOwnProperty("y")&&(y.x+=v,y.y+=p,n.preventHandleOutsideImage&&Object(s.clipToBox)(y,g))}o.default.cornerstone.updateImage(f);var T=Object(d.default)(f,m,r);T instanceof c.default&&T.updateCachedStats(g,f,t);var w=a.default.MEASUREMENT_MODIFIED,C={toolName:e,toolType:e,element:f,measurementData:t};Object(l.default)(f,w,C),i.preventDefault(),i.stopPropagation()}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=a.dragHandler,r=a.upOrEndHandler,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0;x(e,t,n,{dragHandler:o,upOrEndHandler:r},i,l,!1)}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,l=o.dragHandler,s=o.upOrEndHandler,u=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,c=u.detail,f=c.element;m.setters.removeActiveManipulatorForElement(f),n.deleteIfHandleOutsideImage&&Object(r.default)(c,t.handles)&&Object(i.removeToolState)(f,e,t),x(t,n,a,{dragHandler:l,upOrEndHandler:s},f,d,!0)}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=a.dragHandler,i=a.upOrEndHandler,l=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,d=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];e.active=!1,e.invalidated=!0,u.state.isToolLocked=!1,h[n].forEach((function(e){l.removeEventListener(e,r)})),v[n].forEach((function(e){l.removeEventListener(e,i)})),"function"==typeof t.doneMovingCallback&&(g.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),t.doneMovingCallback(d)),"function"==typeof s&&s(d),o.default.cornerstone.updateImage(l)}t.default=function(e,t,n,a){var o=e.element,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",l=arguments.length>6?arguments[6]:void 0;r=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},r);var s=p.bind(this,t,n,r,i),d=function e(a){j(t,n,r,i,{dragHandler:s,upOrEndHandler:e},a,l)};m.setters.addActiveManipulatorForElement(o,b.bind(null,n,r,i,{dragHandler:s,upOrEndHandler:d},o,l)),n.active=!0,u.state.isToolLocked=!0,h[i].forEach((function(e){o.addEventListener(e,s)})),v[i].forEach((function(e){o.addEventListener(e,d)}))}},"./manipulators/moveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./externalModules.js"),r=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./manipulators/getHandlePixelPosition.js"),l=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),u=n("./util/clip.js"),d=n("./store/index.js"),c=n("./util/getActiveTool.js"),f=n("./tools/base/BaseAnnotationTool.js"),g=n("./util/logger.js"),m=Object(g.getLogger)("manipulators:moveHandle"),h=Object(d.getModule)("manipulatorState"),v={value:!1},p={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},b={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};function j(e,t,n,r,l,d){var g=d.detail,m=g.image,h=g.element,p=g.buttons,b=Object(i.default)(d.detail,l);v.value=!1,n.active=!0,n.hasMoved=!0,n.x=b.x,n.y=b.y,t.invalidated=!0,r.preventHandleOutsideImage&&Object(u.clipToBox)(n,m),o.default.cornerstone.updateImage(h);var j=Object(c.default)(h,p,l);j instanceof f.default&&j.updateCachedStats(m,h,t);var x=a.default.MEASUREMENT_MODIFIED,y={toolName:e,toolType:e,element:h,measurementData:t};Object(s.default)(h,x,y)}function x(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,l=i.dragHandler,s=i.upOrEndHandler,u=arguments.length>7?arguments[7]:void 0;T(e,t,n,a,o,r,{dragHandler:l,upOrEndHandler:s},u,!1)}function y(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,l=i.dragHandler,s=i.upOrEndHandler,u=arguments.length>7?arguments[7]:void 0,d=t.element;h.setters.removeActiveManipulatorForElement(d),T(e,t,n,a,o,r,{dragHandler:l,upOrEndHandler:s},u,!0)}function T(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0,c=u.dragHandler,f=u.upOrEndHandler,g=arguments.length>7?arguments[7]:void 0,h=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],j=t.element;a.active=!1,a.moving=!1,n.active=!1,n.invalidated=!0,v.value=!1,d.state.isToolLocked=!1,p[s].forEach((function(e){j.removeEventListener(e,c)})),b[s].forEach((function(e){j.removeEventListener(e,f)})),i.deleteIfHandleOutsideImage&&Object(r.default)(t,n.handles)&&Object(l.removeToolState)(j,e,n),"function"==typeof i.doneMovingCallback&&(m.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),i.doneMovingCallback(h)),"function"==typeof g&&g(h),o.default.cornerstone.updateImage(j)}function w(e,t,n,a){if(t.value){var r=Math.abs(e.y-a.y),i=r/10;if(r<1)return e.y=a.y,void(t.value=!1);e.y>a.y?e.y-=i:e.y<a.y&&(e.y+=i),o.default.cornerstone.updateImage(n.element),o.default.cornerstone.requestAnimationFrame((function(){w(e,t,n,a)}))}}t.default=function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",s=arguments.length>6?arguments[6]:void 0;r=Object.assign({deleteIfHandleOutsideImage:d.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:d.state.preventHandleOutsideImage},r);var u=e.element,c=j.bind(this,t,n,a,r,l),f=function o(){y(t,e,n,a,r,l,{dragHandler:c,upOrEndHandler:o},s)};if(h.setters.addActiveManipulatorForElement(u,x.bind(null,t,e,n,a,r,l,{dragHandler:c,upOrEndHandler:f},s)),a.active=!0,a.moving=!0,n.active=!0,d.state.isToolLocked=!0,p[l].forEach((function(e){u.addEventListener(e,c)})),b[l].forEach((function(e){u.addEventListener(e,f)})),"touch"===l){v.value=!0;var g=o.default.cornerstone.getEnabledElement(u),m=Object(i.default)(e,l);w(a,v,g,m)}}},"./manipulators/moveNewHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./externalModules.js"),r=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./manipulators/getHandlePixelPosition.js"),l=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),u=n("./util/clip.js"),d=n("./store/index.js"),c=n("./util/getActiveTool.js"),f=n("./tools/base/BaseAnnotationTool.js"),g=n("./util/logger.js"),m=Object(g.getLogger)("manipulators:moveNewHandle"),h=Object(d.getModule)("manipulatorState"),v={mouse:[a.default.MOUSE_MOVE,a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},p={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_PINCH,a.default.TAP]};function b(e,t,n,r,l,d){var g=d.detail,m=g.image,h=g.element,v=g.buttons,p=Object(i.default)(d.detail,l);r.hasMoved=!0,t.invalidated=!0,n.active=!0,n.x=p.x,n.y=p.y,r&&r.preventHandleOutsideImage&&Object(u.clipToBox)(n,m),o.default.cornerstone.updateImage(h);var b=Object(c.default)(h,v,l);b instanceof f.default&&b.updateCachedStats(m,h,t);var j=a.default.MEASUREMENT_MODIFIED,x={toolName:e,toolType:e,element:h,measurementData:t};Object(s.default)(h,j,x)}function j(e,t,n,r,i){var l=r.moveHandler,s=r.moveEndHandler,u=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];v[e].forEach((function(e){n.removeEventListener(e,l)})),p[e].forEach((function(e){n.removeEventListener(e,s)})),n.removeEventListener(a.default.TOUCH_START,T),d.state.isToolLocked=!1,"function"==typeof i&&i(u),"function"==typeof t.doneMovingCallback&&(m.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),t.doneMovingCallback(u)),o.default.cornerstone.updateImage(n)}function x(e,t,n,a,o,s,d,c){var f=s.moveHandler,g=s.moveEndHandler,m=d.detail,v=m.element,p=!0;if(!1!==a.hasMoved){var b=Object(i.default)(m,o);t.active=!1,t.invalidated=!0,n.active=!1,n.moving=!1,n.x=b.x,n.y=b.y,h.setters.removeActiveManipulatorForElement(v),a.preventHandleOutsideImage&&Object(u.clipToBox)(n,d.detail.image),a.deleteIfHandleOutsideImage&&Object(r.default)(d.detail,t.handles)&&(t.cancelled=!0,p=!1,Object(l.removeToolState)(v,e,t)),j(o,a,v,{moveHandler:f,moveEndHandler:g},c,p)}}function y(e,t,n,a,o,r,i){var l=o.moveHandler,s=o.moveEndHandler;e.active=!1,e.invalidated=!0,t.active=!1,j(a,n,r,{moveHandler:l,moveEndHandler:s},i,!1)}function T(e){return e.stopImmediatePropagation(),!1}t.default=function(e,t,n,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",l=arguments.length>6?arguments[6]:void 0;(r=Object.assign({deleteIfHandleOutsideImage:d.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:d.state.preventHandleOutsideImage},r)).hasMoved=!1;var s=e.element;function u(e){b(t,n,o,r,i,e)}function c(e){x(t,n,o,r,i,{moveHandler:u,moveEndHandler:c},e,l)}n.active=!0,o.moving=!0,o.active=!0,d.state.isToolLocked=!0,v[i].forEach((function(e){s.addEventListener(e,u)})),s.addEventListener(a.default.TOUCH_START,T),p[i].forEach((function(e){s.addEventListener(e,c)})),h.setters.addActiveManipulatorForElement(s,y.bind(null,n,o,r,i,{moveHandler:u,moveEndHandler:c},s,l))}},"./mixins/activeOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/setToolMode.js");t.default={passiveCallback:function(e){Object(a.setToolDisabledForElement)(e,this.name)},enabledCallback:function(e){Object(a.setToolActiveForElement)(e,this.name)}}},"./mixins/enabledOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/setToolMode.js");t.default={passiveCallback:function(e){Object(a.setToolDisabledForElement)(e,this.name)},activeCallback:function(e){Object(a.setToolEnabledForElement)(e,this.name)}}},"./mixins/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./mixins/activeOrDisabledBinaryTool.js"),o=n("./mixins/enabledOrDisabledBinaryTool.js"),r=n("./mixins/segmentation/circleSegmentationMixin.js"),i=n("./mixins/segmentation/polylineSegmentationMixin.js"),l=n("./mixins/segmentation/freehandSegmentationMixin.js"),s=n("./mixins/segmentation/rectangleSegmentationMixin.js"),u=n("./mixins/segmentation/renderBrushMixin.js");t.default={activeOrDisabledBinaryTool:a.default,enabledOrDisabledBinaryTool:o.default,circleSegmentationMixin:r.default,polylineSegmentationMixin:i.default,freehandSegmentationMixin:l.default,rectangleSegmentationMixin:s.default,renderBrushMixin:u.default}},"./mixins/segmentation/circleSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/index.js"),o=n("./externalModules.js"),r=n("./util/isEmptyObject.js"),i=n("./store/index.js"),l=n("./util/segmentation/index.js"),s=Object(i.getModule)("segmentation"),u=s.getters,d=s.setters;function c(){this.handles={start:{},end:{}}}function f(e){var t=e.detail.element,n=e.detail.currentPoints.image;return Object(r.default)(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),o.default.cornerstone.updateImage(t),!0}function g(e){var t=e.detail,n=t.element,a=t.currentPoints.image;this.handles.end=a,o.default.cornerstone.updateImage(n)}function m(e){e.detail.handles=this.handles;var t=e.detail.element,n=u.labelmap2D(t),a=n.labelmap2D,r=n.labelmap3D,i=n.currentImageIdIndex,s=a.pixelData,c=s.slice(),f={points:{start:{x:this.handles.start.x,y:this.handles.start.y},end:{x:this.handles.end.x,y:this.handles.end.y}},pixelData:s,segmentIndex:r.activeSegmentIndex,segmentationMixinType:"circleSegmentationMixin"};this.applyActiveStrategy(e,f);var g={imageIdIndex:i,diff:Object(l.getDiffBetweenPixelData)(c,s)};d.pushState(this.element,[g]),d.updateSegmentsOnLabelmap2D(a),o.default.cornerstone.updateImage(t),this._resetHandles()}t.default={postTouchStartCallback:f,postMouseDownCallback:f,mouseClickCallback:f,touchDragCallback:g,mouseDragCallback:g,mouseMoveCallback:g,touchEndCallback:m,mouseUpCallback:m,initializeMixin:c,renderToolData:function(e){var t=this,n=e.detail,r=n.element,i=u.brushColor(r,!0),l=Object(a.getNewContext)(n.canvasContext.canvas),s=o.default.cornerstoneMath.point.distance;Object(a.draw)(l,(function(e){if(!t.handles)return null;var n=o.default.cornerstone.pixelToCanvas(r,t.handles.start),l=o.default.cornerstone.pixelToCanvas(r,t.handles.end),u=s(n,l);Object(a.drawCircle)(e,r,t.handles.start,u,{color:i})}))},_resetHandles:c,_applyStrategy:m}},"./mixins/segmentation/freehandSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n("./externalModules.js"),i=n("./store/index.js"),l=n("./util/logger.js"),s=n("./drawing/index.js"),u=n("./util/segmentation/index.js"),d=Object(l.getLogger)("tools:ScissorsTool"),c=Object(i.getModule)("segmentation"),f=c.getters,g=c.setters;function m(e){var t=e.detail.element,n=e.detail.currentPoints.image,a=this.handles.points;if(!a.length)return d.warn("Something went wrong, empty handles detected."),null;a.push({x:n.x,y:n.y,lines:[]}),this.currentHandle+=1,r.default.cornerstone.updateImage(t)}function h(e){var t=e.detail,n=e.detail.element;this._addPoint(t),r.default.cornerstone.updateImage(n)}function v(e){var t=this.handles.points,n=e.detail.element,a=f.labelmap2D(n),o=a.labelmap2D,i=a.labelmap3D,l=a.currentImageIdIndex,s=o.pixelData,d=s.slice(),c={points:t,pixelData:s,segmentIndex:i.activeSegmentIndex,segmentationMixinType:"freehandSegmentationMixin"};this.applyActiveStrategy(e,c);var m={imageIdIndex:l,diff:Object(u.getDiffBetweenPixelData)(d,s)};g.pushState(this.element,[m]),g.updateSegmentsOnLabelmap2D(o),r.default.cornerstone.updateImage(n),this._resetHandles()}function p(){this.handles={points:[]},this.currentHandle=0}t.default={postTouchStartCallback:m,postMouseDownCallback:m,mouseClickCallback:m,touchDragCallback:h,mouseDragCallback:h,mouseMoveCallback:h,touchEndCallback:v,mouseUpCallback:v,initializeMixin:p,renderToolData:function(e){var t=e.detail,n=t.element,a=f.brushColor(n,!0),r=Object(s.getNewContext)(t.canvasContext.canvas),i=this.handles.points;i.length<2||Object(s.draw)(r,(function(e){for(var t=0;t<i.length;t++){var r=o()(i[t].lines);t===i.length-1&&r.push(i[0]),Object(s.drawJoinedLines)(e,n,i[t],r,{color:a})}}))},_resetHandles:p,_addPoint:function(e){var t=this.handles.points;t.length&&t[this.currentHandle-1].lines.push({x:e.currentPoints.image.x,y:e.currentPoints.image.y,lines:[]}),t.push({x:e.currentPoints.image.x,y:e.currentPoints.image.y,lines:[]}),this.currentHandle+=1,r.default.cornerstone.updateImage(e.element)},_applyStrategy:v}},"./mixins/segmentation/polylineSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n("./drawing/index.js"),i=n("./store/index.js"),l=n("./mixins/segmentation/freehandSegmentationMixin.js"),s=Object(i.getModule)("segmentation").getters,u=Object.assign({},l.default,{renderToolData:function(e){var t=this,n=e.detail,a=n.element,i=s.brushColor(a,!0),l=Object(r.getNewContext)(n.canvasContext.canvas),u=this.handles;Object(r.draw)(l,(function(e){if(u.points.length>1)for(var n=0;n<u.points.length;n++){var l=o()(u.points[n].lines);Object(r.drawJoinedLines)(e,a,t.handles.points[n],l,{color:i})}}))}});t.default=u},"./mixins/segmentation/rectangleSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/index.js"),o=n("./externalModules.js"),r=n("./util/isEmptyObject.js"),i=n("./store/index.js"),l=n("./util/segmentation/index.js"),s=Object(i.getModule)("segmentation"),u=s.getters,d=s.setters;function c(e){var t=e.detail.element,n=e.detail.currentPoints.image;return Object(r.default)(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),o.default.cornerstone.updateImage(t),!0}function f(e){var t=e.detail,n=t.element,a=t.currentPoints.image;this.handles.end=a,o.default.cornerstone.updateImage(n)}function g(e){e.detail.handles=this.handles;var t=e.detail.element,n=u.labelmap2D(t),a=n.labelmap2D,r=n.labelmap3D,i=n.currentImageIdIndex,s=a.pixelData,c=s.slice(),f={points:[{x:this.handles.start.x,y:this.handles.start.y},{x:this.handles.end.x,y:this.handles.end.y}],pixelData:s,segmentIndex:r.activeSegmentIndex,segmentationMixinType:"rectangleSegmentationMixin"};this.applyActiveStrategy(e,f);var g={imageIdIndex:i,diff:Object(l.getDiffBetweenPixelData)(c,s)};d.pushState(this.element,[g]),d.updateSegmentsOnLabelmap2D(a),o.default.cornerstone.updateImage(t),this._resetHandles()}function m(){this.handles={start:{},end:{}}}t.default={postTouchStartCallback:c,postMouseDownCallback:c,mouseClickCallback:c,touchDragCallback:f,mouseDragCallback:f,mouseMoveCallback:f,touchEndCallback:g,mouseUpCallback:g,initializeMixin:m,renderToolData:function(e){var t=this,n=e.detail,o=n.element,r=u.brushColor(o,!0),i=Object(a.getNewContext)(n.canvasContext.canvas);Object(a.draw)(i,(function(e){Object(a.drawRect)(e,o,t.handles.start,t.handles.end,{color:r})}))},_resetHandles:m,_applyStrategy:g}},"./mixins/segmentation/renderBrushMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./store/index.js");t.default={renderBrush:function(e){var t,n=a.default.cornerstone,r=Object(o.getModule)("segmentation"),i=r.getters,l=r.configuration,s=e.detail,u=s.viewport;if(this._drawing?t=this._lastImageCoords:this._mouseUpRender?(t=this._lastImageCoords,this._mouseUpRender=!1):t=o.default.state.mousePositionImage,t){var d=s.image,c=d.rows,f=d.columns,g=t,m=g.x,h=g.y;if(!(m<0||m>f||h<0||h>c)){var v=l.radius,p=s.canvasContext,b=s.element,j=i.brushColor(b,this._drawing);p.setTransform(1,0,0,1,0,0);var x=v*u.scale,y=n.pixelToCanvas(b,t);p.beginPath(),p.strokeStyle=j,p.ellipse(y.x,y.y,x,x,0,0,2*Math.PI),p.stroke()}}}}},"./orientation/getOrientationString.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./util/convertToVector3.js");t.default=function(e){for(var t=Object(o.default)(e),n="",r=t.x<0?"R":"L",i=t.y<0?"A":"P",l=t.z<0?"F":"H",s=new a.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),u=1e-4,d=0;d<3;d++)if(s.x>u&&s.x>s.y&&s.x>s.z)n+=r,s.x=0;else if(s.y>u&&s.y>s.x&&s.y>s.z)n+=i,s.y=0;else if(s.z>u&&s.z>s.x&&s.z>s.y)n+=l,s.z=0;else if(s.x>u&&s.y>u&&s.x===s.y)n+=r+i,s.x=0,s.y=0;else if(s.x>u&&s.z>u&&s.x===s.z)n+=r+l,s.x=0,s.z=0;else{if(!(s.y>u&&s.z>u&&s.y===s.z))break;n+=i+l,s.y=0,s.z=0}return n}},"./orientation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./orientation/getOrientationString.js"),o=n("./orientation/invertOrientationString.js"),r={getOrientationString:a.default,invertOrientationString:o.default};t.default=r},"./orientation/invertOrientationString.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.replace("H","f");return(t=(t=(t=(t=(t=t.replace("F","h")).replace("R","l")).replace("L","r")).replace("A","p")).replace("P","a")).toUpperCase()}},"./stackTools/fusionRenderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("./externalModules.js"),s=n("./stateManagement/toolState.js"),u=function(){function e(){o()(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return i()(e,[{key:"render",value:function(e,t){var n=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");t||(t=Object(s.getToolState)(e,"stack").data);var a=l.default.cornerstone,o=t[0],r=o.imageIds[this.currentImageIdIndex],i=t.slice(1,t.length);a.loadAndCacheImage(r).then((function(t){var l=n.layerIds[0];l?a.setLayerImage(e,t,l):(l=a.addLayer(e,t,o.options),n.layerIds.push(l)),a.displayImage(e,t),i.forEach((function(t,o){var i=n.findImageFn(t.imageIds,r),s=o+1,u=n.layerIds[s];u||(u=a.addLayer(e,void 0,t.options),n.layerIds.push(u)),i?a.loadAndCacheImage(i).then((function(t){a.setLayerImage(e,t,u),a.updateImage(e)})):(a.setLayerImage(e,void 0,u),a.setActiveLayer(e,l),a.updateImage(e))}))}))}}]),e}()},"./stackTools/playClip.js":function(e,t,n){"use strict";n.r(t),n.d(t,"playClip",(function(){return d})),n.d(t,"stopClip",(function(){return c}));var a=n("./events.js"),o=n("./externalModules.js"),r=n("./stateManagement/loadHandlerManager.js"),i=n("./stateManagement/toolState.js"),l=n("./util/triggerEvent.js"),s="playClip";function u(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function d(e,t){var n,d;if(void 0===e)throw new Error("playClip: element must not be undefined");var c=Object(i.getToolState)(e,"stack");if(c&&c.data&&c.data.length){var f,g=o.default.cornerstone;if(c.data.length>1){var m=Object(i.getToolState)(e,"stackRenderer");m&&m.data&&m.data.length&&(f=m.data[0])}var h=c.data[0],v=Object(i.getToolState)(e,s);v&&v.data&&v.data.length?u(n=v.data[0]):(n={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},Object(i.addToolState)(e,s,n)),(t<0||t>0)&&(n.framesPerSecond=Number(t),n.reverse=n.framesPerSecond<0,n.ignoreFrameTimeVector=!0),!0!==n.ignoreFrameTimeVector&&n.frameTimeVector&&n.frameTimeVector.length===h.imageIds.length&&(d=function(e,t){var n,a,o,r=0,i=e.length,l=[];for(l.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),n=1;n<i;n++)o=Number(e[n])/t|0,l.push(o),1===n?a=o:o!==a&&(l.isTimeVarying=!0),r+=o;return l.length>0&&(o=l.isTimeVarying?r/l.length|0:l[0],l.push(o)),l}(n.frameTimeVector,n.speed));var p=function(){var t,o,i,s=h.currentImageIdIndex,d=h.imageIds.length;if(n.reverse?s--:s++,!n.loop&&(s<0||s>=d))return u(n),void function(e){var t={element:e};Object(l.default)(e,a.default.CLIP_STOPPED,t)}(e);s>=d&&(s=0),s<0&&(s=d-1),s!==h.currentImageIdIndex&&(t=r.default.getStartLoadHandler(e),o=r.default.getEndLoadHandler(e),i=r.default.getErrorLoadingHandler(e),t&&t(e),(!0===h.preventCache?g.loadImage(h.imageIds[s]):g.loadAndCacheImage(h.imageIds[s])).then((function(t){try{h.currentImageIdIndex=s,f?(f.currentImageIdIndex=s,f.render(e,c.data)):g.displayImage(e,t),o&&o(e,t)}catch(e){return}}),(function(t){var n=h.imageIds[s];i&&i(e,n,t)})))};d&&d.length>0&&d.isTimeVarying?(n.usingFrameTimeVector=!0,n.intervalId=setTimeout((function e(){n.intervalId=setTimeout(e,d[h.currentImageIdIndex]),p()}),0)):(n.usingFrameTimeVector=!1,n.intervalId=setInterval(p,1e3/Math.abs(n.framesPerSecond)))}}function c(e){var t=Object(i.getToolState)(e,s);t&&t.data&&t.data.length&&u(t.data[0])}},"./stackTools/stackPrefetch.js":function(e,t,n){"use strict";n.r(t);var a,o=n("./externalModules.js"),r=n("./stateManagement/loadHandlerManager.js"),i=n("./stateManagement/toolState.js"),l=n("./util/logger.js"),s=(n("./util/triggerEvent.js"),n("./events.js"),Object(l.getLogger)("stackTools:stackPrefetch")),u="stackPrefetch",d="prefetch",c={maxImagesToPrefetch:1/0,preserveExistingPool:!1};function f(e,t){e=Math.round(e)||0;var n=[],a=(t=Math.round(t)||0)-e+1;if(a<=0)return n;for(;a--;)n[a]=t--;return n}function g(e){var t=Object(i.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0],a=Object(i.getToolState)(e,u);if(a){var l=a.data[0]||{};if(l.indicesToRequest&&l.indicesToRequest.length||(l.enabled=!1),!1!==l.enabled&&(a.data[0].indicesToRequest.sort((function(e,t){return e-t})),l.indicesToRequest.slice().forEach((function(e){var t=n.imageIds[e];t&&o.default.cornerstone.imageCache.getImageLoadObject(t)&&function(e){var t=l.indicesToRequest.indexOf(e);t>-1&&l.indicesToRequest.splice(t,1)}(e)})),l.indicesToRequest.length)){c.preserveExistingPool||o.default.cornerstone.imageLoadPoolManager.clearRequestStack(d);for(var s,f,g,m,h,v,p,b=(s=l.indicesToRequest,f=n.currentImageIdIndex,g=0,m=s.length-1,s.forEach((function(e,t){e<f?g=Math.max(t,g):e>f&&(m=Math.min(t,m))})),{low:g,high:m}),j=(r.default.getErrorLoadingHandler(e),b.low),x=b.high,y=[];j>=0||x<l.indicesToRequest.length;){var T=n.currentImageIdIndex,w=!(T-l.indicesToRequest[j]>c.maxImagesToPrefetch)&&j>=0,C=!(l.indicesToRequest[x]-T>c.maxImagesToPrefetch)&&x<l.indicesToRequest.length;if(!C&&!w)break;w&&(v=l.indicesToRequest[j--],h=n.imageIds[v],y.push(h)),C&&(v=l.indicesToRequest[x++],h=n.imageIds[v],y.push(h))}var O={addToBeginning:!0,priority:0,requestType:d};p=function(e){return o.default.cornerstone.loadAndCacheImage(e,O)},y.reverse().forEach((function(e){o.default.cornerstone.imageLoadPoolManager.addRequest(p.bind(null,e),d,{imageId:e},0,!0)}))}}}}function m(e){return function(t){var n,a=t.detail;try{n=Object(i.getToolState)(e,"stack")}catch(e){return}if(n&&n.data&&n.data.length){var o=n.data[0].imageIds.indexOf(a.imageId);if(!(o<0)){var r=Object(i.getToolState)(e,u);r&&r.data&&r.data.length&&r.data[0].indicesToRequest.push(o)}}}}function h(e){clearTimeout(a),a=setTimeout((function(){var t=e.target;try{g(t)}catch(e){return}}),10)}var v={enable:function(e){Object(i.getToolState)(e,u).data=[];var t=Object(i.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];if(!0!==n.preventCache){var a={indicesToRequest:f(0,n.imageIds.length-1),enabled:!0,direction:1},r=a.indicesToRequest.indexOf(n.currentImageIdIndex);a.indicesToRequest.splice(r,1),Object(i.addToolState)(e,u,a),g(e),e.removeEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,h),e.addEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,h);var l=m(e);o.default.cornerstone.events.removeEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,l),o.default.cornerstone.events.addEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,l)}else s.warn("A stack that should not be cached was given the stackPrefetch")}},disable:function(e){clearTimeout(a),e.removeEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,h);var t=m(e);o.default.cornerstone.events.removeEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,t);var n=Object(i.getToolState)(e,u);n&&n.data.length&&(n.data[0].enabled=!1,o.default.cornerstone.imageLoadPoolManager.clearRequestStack(d))},getConfiguration:function(){return c},setConfiguration:function(e){c=e}};t.default=v},"./stackTools/stackRenderers.js":function(e,t,n){"use strict";n.r(t);var a=n("./stackTools/fusionRenderer.js"),o={};o.FusionRenderer=a.default,t.default=o},"./stateManagement/frameOfReferenceStateManager.js":function(e,t,n){"use strict";function a(){var e={};return{get:function(t,n){if(!1!==e.hasOwnProperty(t)){var a=e[t];if(!1!==a.hasOwnProperty(n))return a[n]}},add:function(t,n,a){!1===e.hasOwnProperty(t)&&(e[t]={});var o=e[t];!1===o.hasOwnProperty(n)&&(o[n]={data:[]}),o[n].data.push(a)},remove:function(t,n,a){if(!1!==e.hasOwnProperty(t)){var o=e[t];if(!1!==o.hasOwnProperty(n)){for(var r=o[n],i=-1,l=0;l<r.data.length;l++)r.data[l]===a&&(i=l);-1!==i&&r.data.splice(i,1)}}}}}n.r(t),n.d(t,"newFrameOfReferenceSpecificToolStateManager",(function(){return a})),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",(function(){return o}));var o=a()},"./stateManagement/imageIdSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"newImageIdSpecificToolStateManager",(function(){return o})),n.d(t,"globalImageIdSpecificToolStateManager",(function(){return r}));var a=n("./externalModules.js");function o(){var e={};function t(t,n,a){!1===e.hasOwnProperty(t)&&(e[t]={});var o=e[t];!1===o.hasOwnProperty(n)&&(o[n]={data:[]}),o[n].data.push(a)}function n(t,n){if(!1!==e.hasOwnProperty(t)){var a=e[t];if(!1!==a.hasOwnProperty(n))return a[n]}}function o(t,n,a){e[t][n]=a}function r(t){!1!==e.hasOwnProperty(t)&&delete e[t]}return{get:function(e,t){var o=a.default.cornerstone.getEnabledElement(e);if(o.image)return n(o.image.imageId,t)},add:function(e,n,o){var r=a.default.cornerstone.getEnabledElement(e);r.image&&t(r.image.imageId,n,o)},set:function(e,t,n){var r=a.default.cornerstone.getEnabledElement(e);r.image&&o(r.image.imageId,t,n)},clear:function(e){var t=a.default.cornerstone.getEnabledElement(e);t.image&&r(t.image.imageId)},getImageIdToolState:n,addImageIdToolState:t,setImageIdToolState:o,clearImageIdToolState:r,saveImageIdToolState:function(t){return e[t]},restoreImageIdToolState:function(t,n){e[t]=n},saveToolState:function(){return e},restoreToolState:function(t){e=t},toolState:e}}var r=o()},"./stateManagement/loadHandlerManager.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o={},r={},i={};function l(e){if(!e)return"DEFAULT";var t=a.default.cornerstone.getEnabledElement(e).uuid;if(!t)throw new Error("Something went wrong when getting uuid from element");return t}var s={setStartLoadHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=l(t);o[n]=e},getStartLoadHandler:function(e){var t=l(e);return o[t]||o.DEFAULT},setEndLoadHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=l(t);r[n]=e},getEndLoadHandler:function(e){var t=l(e);return r[t]||r.DEFAULT},setErrorLoadingHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=l(t);i[n]=e},getErrorLoadingHandler:function(e){var t=l(e);return i[t]||i.DEFAULT},removeHandlers:function(e){var t=l(e);delete o[t],delete r[t],delete i[t]}};t.default=s},"./stateManagement/stackSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"stackSpecificStateManager",(function(){return s})),n.d(t,"newStackSpecificToolStateManager",(function(){return r})),n.d(t,"addStackStateManager",(function(){return l}));var a=n("./stateManagement/imageIdSpecificStateManager.js"),o=n("./stateManagement/toolState.js");function r(e,t){var n={};return{get:function(a,o){return e.indexOf(o)>=0?(!1===n.hasOwnProperty(o)&&(n[o]={data:[]}),n[o]):t.get(a,o)},add:function(a,o,r){if(!(e.indexOf(o)>=0))return t.add(a,o,r);!1===n.hasOwnProperty(o)&&(n[o]={data:[]}),n[o].data.push(r)},saveToolState:function(){return n},restoreToolState:function(e){n=e},toolState:n}}var i=[];function l(e,t){var n=Object(o.getElementToolStateManager)(e);n||(n=a.globalImageIdSpecificToolStateManager);var l=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(l=l.concat(t));var s=r(l,n);i.push(s),Object(o.setElementToolStateManager)(e,s)}var s={newStackSpecificToolStateManager:r,addStackStateManager:l}},"./stateManagement/textStyle.js":function(e,t,n){"use strict";n.r(t);var a={fontSize:15,fontFamily:"Arial",backgroundColor:"transparent"};function o(e){if("string"!=typeof e)throw new Error("Font family must be a valid string");a.fontFamily=e}function r(e){if("number"!=typeof e||isNaN(e)||!isFinite(e))throw new Error("Font size must be a valid number");a.fontSize=parseFloat(e)}var i={setFont:function(e){var t=e.split("px ");2===t.length&&(r(parseFloat(t[0])),o(t[1]))},getFont:function(){return"".concat(a.fontSize,"px ").concat(a.fontFamily)},setFontSize:r,getFontSize:function(){return a.fontSize},setFontFamily:o,getFontFamily:function(){return a.fontFamily},setBackgroundColor:function(e){a.backgroundColor=e},getBackgroundColor:function(){return a.backgroundColor}};t.default=i},"./stateManagement/toolColors.js":function(e,t,n){"use strict";n.r(t);var a="white",o="greenyellow",r="transparent",i={setFillColor:function(e){r=e},getFillColor:function(){return r},setToolColor:function(e){a=e},getToolColor:function(){return a},setActiveColor:function(e){o=e},getActiveColor:function(){return o},getColorIfActive:function(e){return e.color?e.color:e.active?o:a}};t.default=i},"./stateManagement/toolCoordinates.js":function(e,t,n){"use strict";var a;n.r(t);var o={setCoords:function(e){a=e.currentPoints.canvas},getCoords:function(){return a}};t.default=o},"./stateManagement/toolState.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addToolState",(function(){return u})),n.d(t,"getToolState",(function(){return d})),n.d(t,"removeToolState",(function(){return c})),n.d(t,"clearToolState",(function(){return f})),n.d(t,"setElementToolStateManager",(function(){return g})),n.d(t,"getElementToolStateManager",(function(){return s}));var a=n("./events.js"),o=n("./externalModules.js"),r=n("./stateManagement/imageIdSpecificStateManager.js"),i=n("./util/triggerEvent.js"),l=n("./util/uuidv4.js");function s(e){var t=o.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=r.globalImageIdSpecificToolStateManager),t.toolStateManager}function u(e,t,n){var o=s(e);n.uuid=n.uuid||Object(l.default)(),o.add(e,t,n);var r=a.default.MEASUREMENT_ADDED,u={toolName:t,toolType:t,element:e,measurementData:n};Object(i.default)(e,r,u)}function d(e,t){return s(e).get(e,t)}function c(e,t,n){var o=s(e).get(e,t);if(o&&o.data&&o.data.length){for(var r=-1,l=0;l<o.data.length;l++)o.data[l]===n&&(r=l);if(-1!==r){o.data.splice(r,1);var u=a.default.MEASUREMENT_REMOVED,d={toolName:t,toolType:t,element:e,measurementData:n};Object(i.default)(e,u,d)}}}function f(e,t){var n=s(e).get(e,t);void 0!==n&&(n.data=[])}function g(e,t){o.default.cornerstone.getEnabledElement(e).toolStateManager=t}},"./stateManagement/toolStyle.js":function(e,t,n){"use strict";n.r(t);var a=1,o=2,r={setToolWidth:function(e){a=e},getToolWidth:function(){return a},setActiveWidth:function(e){o=e},getActiveWidth:function(){return o}};t.default=r},"./store/addTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addTool",(function(){return s})),n.d(t,"addToolForElement",(function(){return l}));var a=n("./store/index.js"),o=n("./store/getToolForElement.js"),r=n("./util/logger.js"),i=Object(r.getLogger)("addTool"),l=function(e,t,n){var r=new t(n);Object(o.default)(e,r.name)?i.warn("%s has already been added to the target element",r.name):(r.element=e,a.default.state.tools.push(r))},s=function(e,t){u(e,t),a.default.state.enabledElements.forEach((function(n){l(n,e,t)}))},u=function(e,t){if(Object(a.getModule)("globalConfiguration").configuration.globalToolSyncEnabled){var n=new e(t);void 0!==a.default.state.globalTools[n.name]?i.warn("%s has already been added globally",n.name):a.default.state.globalTools[n.name]={tool:e,props:t,activeBindings:[]}}}},"./store/filterToolsUsableWithMultiPartTools.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/base/BaseAnnotationTool.js"),o=n("./tools/base/BaseBrushTool.js");t.default=function(e){return e.filter((function(e){return!(e.isMultiPartTool||e instanceof a.default||e instanceof o.default)}))}},"./store/getActiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return t.filter((function(t){return t.element===e&&"active"===t.mode&&(void 0===n||t.options["is".concat(n,"Active")])}))}},"./store/getInteractiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return t.filter((function(t){return t.element===e&&("active"===t.mode||"passive"===t.mode)}))}},"./store/getToolForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js");t.default=function(e,t){return a.state.tools.find((function(n){return n.element===e&&n.name===t}))}},"./store/getToolsWithDataForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolState.js");t.default=function(e,t){return t.filter((function(t){var n=Object(a.getToolState)(e,t.name);return n&&n.data.length>0}))}},"./store/getToolsWithMoveableHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolState.js"),o=n("./manipulators/getHandleNearImagePoint.js"),r=n("./util/getProximityThreshold.js");t.default=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";return t.filter((function(t){for(var l=Object(r.default)(i,t.name),s=Object(a.getToolState)(e,t.name),u=0;u<s.data.length;u++)if(void 0!==Object(o.default)(e,s.data[u].handles,n,l))return!0;return!1}))}},"./store/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",(function(){return u})),n.d(t,"getters",(function(){return d})),n.d(t,"modules",(function(){return c})),n.d(t,"getModule",(function(){return f}));var a=n("./store/modules/segmentationModule/index.js"),o=n("./store/modules/manipulatorStateModule.js"),r=n("./store/modules/cursorModule.js"),i=n("./store/modules/globalConfigurationModule.js"),l=n("./externalModules.js"),s=n("./util/logger.js"),u=(Object(s.getLogger)("store:modules:storeLogger"),{globalTools:{},globalToolChangeHistory:[],enabledElements:[],tools:[],isToolLocked:!1,activeMultiPartTool:null,mousePositionImage:{},clickProximity:6,touchProximity:10,handleRadius:6,deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,preventTextBoxOutsideDisplayedArea:!1,handleTouchOffset:{x:0,y:-57},svgCursorUrl:null}),d={mouseTools:function(){return u.tools.filter((function(e){return e.supportedInteractionTypes.includes("Mouse")}))},touchTools:function(){return u.tools.filter((function(e){return e.supportedInteractionTypes.includes("Touch")}))},enabledElementByUID:function(e){return u.enabledElements.find((function(t){return l.default.cornerstone.getEnabledElement(t).uuid===e}))}},c={segmentation:a.default,cursor:r.default,globalConfiguration:i.default,manipulatorState:o.default};function f(e){return c[e]}t.default={modules:c,state:u,getters:d}},"./store/internals/addEnabledElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/index.js"),o=n("./eventDispatchers/index.js"),r=n("./store/addTool.js"),i=n("./store/setToolMode.js"),l=n("./store/index.js"),s=n("./util/logger.js"),u=Object(s.getLogger)("internals:addEnabledElement");t.default=function(e){u.log("EVENT:ELEMENT_ENABLED");var t=e.detail.element;o.imageRenderedEventDispatcher.enable(t),o.newImageEventDispatcher.enable(t);var n=Object(l.getModule)("globalConfiguration").configuration;n.mouseEnabled&&(a.mouseEventListeners.enable(t),a.wheelEventListener.enable(t),o.mouseToolEventDispatcher.enable(t)),n.touchEnabled&&(a.touchEventListeners.enable(t),o.touchToolEventDispatcher.enable(t)),d(t)};var d=function(e){l.default.state.enabledElements.push(e),l.default.modules&&function(e){var t=l.default.modules;Object.keys(t).forEach((function(n){"function"==typeof t[n].enabledElementCallback&&t[n].enabledElementCallback(e)}))}(e),function(e){Object(l.getModule)("globalConfiguration").configuration.globalToolSyncEnabled&&Object.keys(l.default.state.globalTools).forEach((function(t){var n=l.default.state.globalTools[t],a=n.tool,o=n.props;Object(r.addToolForElement)(e,a,o)}))}(e),function(e){if(Object(l.getModule)("globalConfiguration").configuration.globalToolSyncEnabled){var t={active:i.setToolActiveForElement,passive:i.setToolPassiveForElement,enabled:i.setToolEnabledForElement,disabled:i.setToolDisabledForElement};l.default.state.globalToolChangeHistory.forEach((function(n){var a=n.args.slice(0);a.unshift(e),t[n.mode].apply(null,a)}))}}(e)}},"./store/internals/removeEnabledElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/index.js"),o=n("./eventDispatchers/index.js"),r=n("./store/index.js"),i=n("./util/logger.js"),l=n("./stateManagement/loadHandlerManager.js"),s=n("./store/setToolMode.js"),u=Object(i.getLogger)("internals:removeEnabledElement");t.default=function(e){u.log("EVENT:ELEMENT_DISABLED");var t=e.detail.element,n=Object(r.getModule)("globalConfiguration").configuration;o.imageRenderedEventDispatcher.disable(t),o.newImageEventDispatcher.disable(t),n.mouseEnabled&&(a.mouseEventListeners.disable(t),a.wheelEventListener.disable(t),o.mouseToolEventDispatcher.disable(t)),n.touchEnabled&&(a.touchEventListeners.disable(t),o.touchToolEventDispatcher.disable(t)),d(t),c(t),f(t)};var d=function(e){r.default.state.tools.forEach((function(t){t.element===e&&Object(s.setToolDisabledForElement)(t.element,t.name)})),r.default.state.tools=r.default.state.tools.filter((function(t){return t.element!==e}))},c=function(e){r.default.modules&&function(e){var t=r.default.modules;Object.keys(t).forEach((function(n){"function"==typeof t[n].removeEnabledElementCallback&&t[n].removeEnabledElementCallback(e)}))}(e);var t=r.default.state.enabledElements.findIndex((function(t){return t===e}));t>-1?r.default.state.enabledElements.splice(t,1):u.warn("unable to remove element")},f=function(e){l.default.removeHandlers(e)}},"./store/isToolActiveForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/getToolForElement.js");t.default=function(e,t){return"active"===Object(a.default)(e,t).mode}},"./store/modules/cursorModule.js":function(e,t,n){"use strict";n.r(t),n("./externalModules.js");var a={iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:'\n    <path stroke="ACTIVE_COLOR" d="M8 16L8 0"></path>\n    <path stroke="ACTIVE_COLOR" d="M16 8L0 8"></path>\n  '},o={defaultOptions:function(e){Object.assign(a,e)}},r={defaultOptions:function(){return a}};t.default={configuration:a,getters:r,setters:o}},"./store/modules/globalConfigurationModule.js":function(e,t,n){"use strict";n.r(t),t.default={configuration:{mouseEnabled:!0,touchEnabled:!0,globalToolSyncEnabled:!1,showSVGCursors:!1,autoResizeViewports:!0,lineDash:[4,4]}}},"./store/modules/manipulatorStateModule.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o={activeManipulators:{}};function r(e){var t=a.default.cornerstone.getEnabledElement(e).uuid;delete o.activeManipulators[t]}function i(e){var t=o.activeManipulators,n=t[e];"function"==typeof n&&n(),delete t[e]}function l(e){r(e.detail.element)}t.default={setters:{addActiveManipulatorForElement:function(e,t){var n=a.default.cornerstone.getEnabledElement(e).uuid;o.activeManipulators[n]=t},removeActiveManipulatorForElement:r,cancelActiveManipulatorsForElement:function(e){i(a.default.cornerstone.getEnabledElement(e).uuid)},cancelActiveManipulators:function(){var e=o.activeManipulators;Object.keys(e).forEach((function(e){return i(e)}))}},state:o,enabledElementCallback:function(e){var t=a.default.cornerstone.EVENTS.NEW_IMAGE;e.removeEventListener(t,l),e.addEventListener(t,l)},removeEnabledElementCallback:function(e){var t=a.default.cornerstone.EVENTS.NEW_IMAGE;e.removeEventListener(t,l),r(e)}}},"./store/modules/segmentationModule/activeLabelmapIndex.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getActiveLabelmapIndex",(function(){return s})),n.d(t,"setActiveLabelmapIndex",(function(){return u}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/addLabelmap3D.js"),i=n("./store/modules/segmentationModule/state.js"),l=n("./externalModules.js");function s(e){var t=Object(a.default)(e);if(t){var n=Object(o.getToolState)(t,"stack").data[0].imageIds[0],r=i.default.series[n];if(r)return r.activeLabelmapIndex}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(a.default)(e);if(n){var s=l.default.cornerstone,u=Object(o.getToolState)(n,"stack"),d=u.data[0],c=s.getEnabledElement(n),f=c.image,g=f.rows,m=f.columns,h=d.imageIds.length,v=g*m*h,p=d.imageIds[0],b=i.default.series[p];b?(b.activeLabelmapIndex=t,b.labelmaps3D[t]||Object(r.default)(b,t,v)):(i.default.series[p]={activeLabelmapIndex:t,labelmaps3D:[]},b=i.default.series[p],Object(r.default)(b,t,v)),s.updateImage(n)}}},"./store/modules/segmentationModule/activeSegmentIndex.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getActiveSegmentIndex",(function(){return l})),n.d(t,"setActiveSegmentIndex",(function(){return s})),n.d(t,"incrementActiveSegmentIndex",(function(){return u})),n.d(t,"decrementActiveSegmentIndex",(function(){return d}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),i=n("./store/index.js");function l(e,t){var n=Object(a.default)(e);if(n){var i=Object(o.getToolState)(n,"stack").data[0].imageIds[0],l=r.default.series[i];if(l){t=void 0===t?l.activeLabelmapIndex:t;var s=l.labelmaps3D[t];if(s)return s.activeSegmentIndex}return 1}}function s(e,t){var n=Object(a.default)(e);if(n){var l=Object(o.getToolState)(n,"stack").data[0].imageIds[0],s=r.default.series[l];if(s){var u=s.activeLabelmapIndex,d=s.labelmaps3D[u],c=Object(i.getModule)("segmentation").configuration;t<=0?t=1:t>c.segmentsPerLabelmap&&(t=c.segmentsPerLabelmap),d.activeSegmentIndex=t}}}function u(e){var t=Object(a.default)(e);t&&c(t,"increase")}function d(e){var t=Object(a.default)(e);t&&c(t,"decrease")}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"increase",n=Object(i.getModule)("segmentation"),a=n.configuration,l=Object(o.getToolState)(e,"stack"),s=l.data[0],u=s.imageIds[0],d=r.default.series[u];if(d){var c=d.activeLabelmapIndex,f=d.labelmaps3D[c];switch(t){case"increase":f.activeSegmentIndex++,f.activeSegmentIndex>a.segmentsPerLabelmap&&(f.activeSegmentIndex=1);break;case"decrease":f.activeSegmentIndex--,f.activeSegmentIndex<=0&&(f.activeSegmentIndex=a.segmentsPerLabelmap)}}}},"./store/modules/segmentationModule/addLabelmap2D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var a=n("./store/modules/segmentationModule/arrayTypes.js"),o=n("./store/index.js"),r=a.default.UINT_16_ARRAY,i=a.default.FLOAT_32_ARRAY;function l(e,t,n,a,l){var s,u=Object(o.getModule)("segmentation").configuration,d=a*l,c=d*n;switch(u.arrayType){case r:s=new Uint16Array(e.labelmaps3D[t].buffer,2*c,d);break;case i:s=new Float32Array(e.labelmaps3D[t].buffer,4*c,d);break;default:throw new Error("Unsupported Array Type ".concat(u.arrayType))}e.labelmaps3D[t].labelmaps2D[n]={pixelData:s,segmentsOnLabelmap:[]}}},"./store/modules/segmentationModule/addLabelmap3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var a=n("./store/modules/segmentationModule/arrayTypes.js"),o=n("./store/index.js"),r=a.default.UINT_16_ARRAY,i=a.default.FLOAT_32_ARRAY;function l(e,t,n){var a,l=Object(o.getModule)("segmentation").configuration;switch(l.arrayType){case r:a=2;break;case i:a=4;break;default:throw new Error("Unsupported Array Type ".concat(l.arrayType))}e.labelmaps3D[t]={buffer:new ArrayBuffer(n*a),labelmaps2D:[],metadata:[],activeSegmentIndex:1,colorLUTIndex:0,segmentsHidden:[],undo:[],redo:[]}}},"./store/modules/segmentationModule/arrayTypes.js":function(e,t,n){"use strict";n.r(t),t.default={UINT_16_ARRAY:0,FLOAT_32_ARRAY:1}},"./store/modules/segmentationModule/colorLUT.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u})),n.d(t,"setColorLUTIndexForLabelmap3D",(function(){return d})),n.d(t,"getColorForSegmentIndexColorLUT",(function(){return c})),n.d(t,"setColorForSegmentIndexOfColorLUT",(function(){return f})),n.d(t,"getColorLUT",(function(){return g}));var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n("./util/logger.js"),i=n("./store/modules/segmentationModule/state.js"),l=n("./store/index.js"),s=Object(r.getLogger)("store:modules:segmentationModule:setColorLUT");function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(l.getModule)("segmentation"),a=n.configuration,r=a.segmentsPerLabelmap;t?(m(t,r),t.length<r&&(t=[].concat(o()(t),o()(h(r-t.length))))):t=t||h(r),t.unshift([0,0,0,0]),i.default.colorLutTables[e]=t}function d(e,t){e.colorLUTIndex=t}function c(e,t){return g(e)[t]}function f(e,t,n){g(e)[t]=n}function g(e){return"number"==typeof e?i.default.colorLutTables[e]:i.default.colorLutTables[e.colorLUTIndex]}function m(e,t){e.length<t?s.warn("The provided colorLUT only provides ".concat(e.length," labels, whereas segmentsPerLabelmap is set to ").concat(t,". Autogenerating the rest.")):e.length>t&&s.warn("segmentsPerLabelmap is set to ".concat(t,", and the provided colorLUT provides ").concat(e.length,". Using the first ").concat(t," colors from the LUT."))}function h(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:255,t=[],n=0;n<e;n++)t.push(x(p(),j()));return t}var v=222.5;function p(){return(v+=137.5)>=360&&(v-=360),v}var b=.6;function j(){return(b+=.07)>.82&&(b=b-.82+.3),b}function x(e){var t,n,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.6,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,l=(1-Math.abs(2*r-1))*o,s=l*(1-Math.abs(e/60%2-1)),u=r-l/2;return e<60?(t=l,n=s,a=0):e<120?(t=s,n=l,a=0):e<180?(t=0,n=l,a=s):e<240?(t=0,n=s,a=l):e<300?(t=s,n=0,a=l):e<360&&(t=l,n=0,a=s),[255*(t+u),255*(n+u),255*(a+u),i]}},"./store/modules/segmentationModule/defaultConfiguration.js":function(e,t,n){"use strict";n.r(t);var a={renderOutline:!0,renderFill:!0,shouldRenderInactiveLabelmaps:!0,radius:10,minRadius:1,maxRadius:50,fillAlpha:.2,fillAlphaInactive:.1,outlineAlpha:.7,outlineAlphaInactive:.35,outlineWidth:3,storeHistory:!0,segmentsPerLabelmap:65535,arrayType:n("./store/modules/segmentationModule/arrayTypes.js").default.UINT_16_ARRAY};t.default=a},"./store/modules/segmentationModule/deleteSegment.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),i=n("./externalModules.js");function l(e,t,n){if(t){var l=Object(a.default)(e);if(l){var s=Object(o.getToolState)(l,"stack").data[0].imageIds[0],u=r.default.series[s];if(u){n=void 0===n?u.activeLabelmapIndex:n;var d=u.labelmaps3D[n];if(d){delete d.metadata[t];for(var c=d.labelmaps2D,f=0;f<c.length;f++){var g=c[f];if(g&&g.segmentsOnLabelmap.includes(t)){var m=g.pixelData,h=g.segmentsOnLabelmap.indexOf(t);g.segmentsOnLabelmap.splice(h,1);for(var v=0;v<m.length;v++)m[v]===t&&(m[v]=0)}}i.default.cornerstone.updateImage(l)}}}}}},"./store/modules/segmentationModule/getBrushColor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var a=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),r=n("./store/modules/segmentationModule/getElement.js"),i=n("./util/logger.js"),l=Object(i.getLogger)("store:modules:segmentationModule:getBrushColor");function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(r.default)(e);if(n){var i=Object(a.getToolState)(n,"stack");if(i){var s,u=i.data[0],d=u.imageIds[0],c=o.default.series[d];if(c){var f=c.activeLabelmapIndex,g=c.labelmaps3D[f],m=g.activeSegmentIndex;s=o.default.colorLutTables[g.colorLUTIndex][m]}else s=o.default.colorLutTables[0][1];return t?"rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 1.0 )"):"rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 0.8 )")}l.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}},"./store/modules/segmentationModule/getElement.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./store/index.js");function o(e){return e instanceof HTMLElement?e:a.getters.enabledElementByUID(e)}},"./store/modules/segmentationModule/getLabelmap2D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v})),n.d(t,"getLabelmap2DByImageIdIndex",(function(){return p}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),i=n("./store/modules/segmentationModule/addLabelmap3D.js"),l=n("./store/modules/segmentationModule/addLabelmap2D.js"),s=n("./externalModules.js"),u=n("./store/modules/segmentationModule/state.js"),d=n("./store/modules/segmentationModule/arrayTypes.js"),c=n("./store/index.js"),f=n("./util/logger.js"),g=d.default.UINT_16_ARRAY,m=d.default.FLOAT_32_ARRAY,h=Object(f.getLogger)("store:modules:segmentationModule:getLabelmap2D");function v(e){var t=Object(a.default)(e);if(t){var n=s.default.cornerstone,r=Object(o.getToolState)(t,"stack");if(r){var d,c=r.data[0],f=n.getEnabledElement(t),g=c.currentImageIdIndex,m=f.image,v=m.rows,p=m.columns,b=c.imageIds.length,j=c.imageIds[0],x=u.default.series[j];if(x){if(d=x.activeLabelmapIndex,!x.labelmaps3D[d]){var y=v*p*b;Object(i.default)(x,d,y)}x.labelmaps3D[d].labelmaps2D[g]||Object(l.default)(x,d,g,v,p)}else{d=0,u.default.series[j]={activeLabelmapIndex:d,labelmaps3D:[]},x=u.default.series[j];var T=v*p*b;Object(i.default)(x,d,T),Object(l.default)(x,d,g,v,p)}var w=x.labelmaps3D[d];return{labelmap2D:w.labelmaps2D[g],labelmap3D:w,currentImageIdIndex:g,activeLabelmapIndex:d}}h.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}function p(e,t,n,a){if(!e.labelmaps2D[t]){var o,i=Object(c.getModule)("segmentation").configuration,l=n*a,s=l*t;switch(i.arrayType){case g:o=new Uint16Array(e.buffer,2*s,l);break;case m:o=new Float32Array(e.buffer,4*s,l);break;default:throw new Error("Unsupported Array Type ".concat(i.arrayType))}e.labelmaps2D[t]={pixelData:o,segmentsOnLabelmap:Object(r.default)(o)}}return e.labelmaps2D[t]}},"./store/modules/segmentationModule/getLabelmapBuffers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLabelmapBuffers",(function(){return c})),n.d(t,"getActiveLabelmapBuffer",(function(){return f}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/getLabelmaps3D.js"),i=n("./store/modules/segmentationModule/state.js"),l=n("./store/modules/segmentationModule/arrayTypes.js"),s=n("./store/index.js"),u=l.default.UINT_16_ARRAY,d=l.default.FLOAT_32_ARRAY;function c(e,t){var n=Object(a.default)(e);if(n){var o=Object(r.default)(n).labelmaps3D;if(!o)return[];var l,c,f=Object(s.getModule)("segmentation").configuration;switch(f.arrayType){case u:l="Uint16Array",c="2";break;case d:l="Float32Array",c="4";break;default:throw new Error("Unsupported Array Type ".concat(f.arrayType))}var g=i.default.colorLutTables;if(void 0!==t){var m=o[t];return m?{labelmapIndex:t,bytesPerVoxel:c,type:l,buffer:m.buffer,colorLUT:g[m.colorLUTIndex]}:void 0}for(var h=[],v=0;v<o.length;v++){var p=o[v];p&&h.push({labelmapIndex:v,bytesPerVoxel:2,buffer:p.buffer,colorLUT:g[p.colorLUTIndex]})}return h}}function f(e){var t=Object(a.default)(e);if(t){var n=Object(o.getToolState)(t,"stack").data[0].imageIds[0],r=i.default.series[n];if(r)return c(t,r.activeLabelmapIndex)}}},"./store/modules/segmentationModule/getLabelmapStats.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u})),n.d(t,"_calculateLabelmapStats",(function(){return d}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),i=n("./externalModules.js"),l=n("./util/logger.js"),s=Object(l.getLogger)("store:modules:segmentationModule:getLabelmapStats");function u(e,t,n){var l=i.default.cornerstone,u=Object(a.default)(e);if(!u)return null;var c=Object(o.getToolState)(u,"stack").data[0].imageIds,f=c[0];return new Promise((function(e){var a=r.default.series[f];a||e(null);var o=function(e){for(var t=[],n=i.default.cornerstone.metaData,a=!0,o=0;o<e.length;o++){var r=n.get("imagePlaneModule",e[o]);if(!r){a=!1;break}t.push(r)}return{sufficientMetadata:a,imagePlanes:t}}(c),u=o.sufficientMetadata,g=o.imagePlanes;u||(s.warn("Insufficient imagePlaneModule information to calculate volume statistics."),e(null)),n=void 0===n?a.activeLabelmapIndex:n;for(var m=a.labelmaps3D[n],h=[],v=0;v<c.length;v++)h.push(l.loadAndCacheImage(c[v]));Promise.all(h).then((function(n){var a=d(m,n,g,t);e(a)}))}))}function d(e,t,n,a){for(var o=function(e,t,n,a){for(var o=t[0],r=o.rowPixelSpacing,i=o.columnPixelSpacing,l=e.labelmaps2D,s=[],u=0;u<l.length;u++){var d=l[u];if(d&&d.segmentsOnLabelmap.includes(a)){for(var f=c(t,n,u)*r*i,g=d.pixelData,m=t[u].getPixelData(),h=[],v=0;v<g.length;v++)g[v]===a&&h.push(m[v]);s.push({voxelInMM3:f,values:h})}}return s}(e,t,n,a),r=0,i=o[0].values[0],l=i,s=0,u=0;u<o.length;u++){var d=o[u],f=d.values;s+=(p=d.voxelInMM3)*f.length;var g=0;f.forEach((function(e){e>i?i=e:e<l&&(l=e),g+=e})),r+=g*p}r/=s;for(var m=0,h=0;h<o.length;h++){var v=o[h],p=(f=v.values,v.voxelInMM3),b=0;f.forEach((function(e){b+=Math.pow(e-r,2)})),m+=b*p}return m/=s,m=Math.sqrt(m),{volume:s,mean:r,stdDev:m,max:i,min:l}}function c(e,t,n){var a=e.length,o=t[n].imagePositionPatient;if(0===n)return f(o,t[n+1].imagePositionPatient);if(n===a-1)return f(o,t[n-1].imagePositionPatient);var r=t[n-1].imagePositionPatient,i=t[n+1].imagePositionPatient;return(f(o,r)+f(o,i))/2}function f(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}},"./store/modules/segmentationModule/getLabelmaps3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s})),n.d(t,"getLabelmap3D",(function(){return u}));var a=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/getElement.js"),r=n("./store/modules/segmentationModule/state.js"),i=n("./util/logger.js"),l=Object(i.getLogger)("store:modules:segmentationModule:getLabelmaps3D");function s(e){var t=Object(o.default)(e);if(t){var n=Object(a.getToolState)(t,"stack");if(n){var i,s,u=n.data[0],d=u.imageIds[0],c=r.default.series[d];return c&&(i=c.labelmaps3D,s=c.activeLabelmapIndex),{labelmaps3D:i,activeLabelmapIndex:s,currentImageIdIndex:u.currentImageIdIndex}}l.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}function u(e,t){var n=s(e),a=n.labelmaps3D,o=n.activeLabelmapIndex;return a[t=void 0!==t?t:o]}},"./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var a=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),r=n("./util/isPointInImage.js"),i=n("./util/logger.js"),l=Object(i.getLogger)("store:modules:segmentationModule:getSegmentOfActiveLabelmapAtEvent");function s(e){var t=e.detail,n=t.element,i=t.image,s=t.currentPoints;if(s){var u=i.width,d=i.height;if(n){var c=Object(a.getToolState)(n,"stack").data[0],f=c.currentImageIdIndex,g=c.imageIds[0],m=o.default.series[g],h=m.activeLabelmapIndex,v=m.labelmaps3D[h];if(v){var p=v.labelmaps2D[f];if(p){var b=p.pixelData,j=s.image,x=j.x,y=j.y;if(x=Math.floor(x),y=Math.floor(y),Object(r.default)({x,y},d,u)){var T=b[y*u+x];if(0===T)return;return{segmentIndex:T,metadata:v.metadata[T]}}}}}}else l.warn("Not a cornerstone input event.")}},"./store/modules/segmentationModule/getSegmentsOnPixeldata.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a);function r(e){return o()(new Set(e))}},"./store/modules/segmentationModule/history.js":function(e,t,n){"use strict";n.r(t),n.d(t,"pushState",(function(){return l})),n.d(t,"undo",(function(){return s})),n.d(t,"redo",(function(){return u}));var a=n("./store/modules/segmentationModule/getLabelmaps3D.js"),o=n("./util/logger.js"),r=n("./externalModules.js"),i=Object(o.getLogger)("util:segmentation:labelmap3DHistory");function l(e,t,n){var o=Object(a.getLabelmap3D)(e,n);o.undo.push(t),o.redo=[]}function s(e,t){var n=Object(a.getLabelmap3D)(e,t),o=n.undo,l=n.redo;if(o.length){var s=o.pop();d(n,s,1),l.push(s),r.default.cornerstone.updateImage(e)}else i.warn("No undos left.")}function u(e,t){var n=Object(a.getLabelmap3D)(e,t),o=n.undo,l=n.redo;if(l.length){var s=l.pop();d(n,s,2),o.push(s),r.default.cornerstone.updateImage(e)}else i.warn("No redos left.")}function d(e,t,n){var a=e.labelmaps2D;t.forEach((function(e){for(var t=e.imageIdIndex,o=e.diff,r=a[t].pixelData,i=0;i<o.length;i++){var l=o[i];r[l[0]]=l[n]}}))}},"./store/modules/segmentationModule/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/modules/segmentationModule/metadata.js"),o=n("./store/modules/segmentationModule/activeLabelmapIndex.js"),r=n("./store/modules/segmentationModule/activeSegmentIndex.js"),i=n("./store/modules/segmentationModule/segmentVisibility.js"),l=n("./store/modules/segmentationModule/getLabelmapBuffers.js"),s=n("./store/modules/segmentationModule/setLabelmap3D.js"),u=n("./store/modules/segmentationModule/getLabelmapStats.js"),d=n("./store/modules/segmentationModule/getLabelmaps3D.js"),c=n("./store/modules/segmentationModule/getLabelmap2D.js"),f=n("./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js"),g=n("./store/modules/segmentationModule/colorLUT.js"),m=n("./store/modules/segmentationModule/getBrushColor.js"),h=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),v=n("./store/modules/segmentationModule/deleteSegment.js"),p=n("./store/modules/segmentationModule/state.js"),b=n("./store/modules/segmentationModule/defaultConfiguration.js"),j=n("./store/modules/segmentationModule/history.js"),x=n("./store/modules/segmentationModule/setRadius.js");t.default={state:p.default,configuration:b.default,onRegisterCallback:function(){Object(g.default)(0)},getters:{metadata:a.getMetadata,labelmap3D:d.getLabelmap3D,labelmaps3D:d.default,activeLabelmapIndex:o.getActiveLabelmapIndex,activeSegmentIndex:r.getActiveSegmentIndex,isSegmentVisible:i.isSegmentVisible,labelmap2D:c.default,labelmap2DByImageIdIndex:c.getLabelmap2DByImageIdIndex,labelmapStats:u.default,segmentOfActiveLabelmapAtEvent:f.default,brushColor:m.default,labelmapBuffers:l.getLabelmapBuffers,activeLabelmapBuffer:l.getActiveLabelmapBuffer,colorLUT:g.getColorLUT,colorForSegmentIndexColorLUT:g.getColorForSegmentIndexColorLUT},setters:{metadata:a.setMetadata,labelmap3DForElement:s.setLabelmap3DForElement,labelmap3DByFirstImageId:s.setLabelmap3DByFirstImageId,incrementActiveSegmentIndex:r.incrementActiveSegmentIndex,decrementActiveSegmentIndex:r.decrementActiveSegmentIndex,activeSegmentIndex:r.setActiveSegmentIndex,toggleSegmentVisibility:i.toggleSegmentVisibility,updateSegmentsOnLabelmap2D:function(e){e.segmentsOnLabelmap=Object(h.default)(e.pixelData)},deleteSegment:v.default,colorLUT:g.default,colorLUTIndexForLabelmap3D:g.setColorLUTIndexForLabelmap3D,colorForSegmentIndexOfColorLUT:g.setColorForSegmentIndexOfColorLUT,activeLabelmapIndex:o.setActiveLabelmapIndex,radius:x.default,pushState:j.pushState,undo:j.undo,redo:j.redo}}},"./store/modules/segmentationModule/metadata.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getMetadata",(function(){return d})),n.d(t,"setMetadata",(function(){return c}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./store/modules/segmentationModule/addLabelmap3D.js"),r=n("./stateManagement/toolState.js"),i=n("./externalModules.js"),l=n("./util/logger.js"),s=n("./store/modules/segmentationModule/state.js"),u=Object(l.getLogger)("store:modules:segmentationModule:metadata");function d(e,t,n){var o=Object(a.default)(e);if(o){var i=Object(r.getToolState)(o,"stack").data[0].imageIds[0],l=s.default.series[i];if(l){if(t=void 0===t?l.activeLabelmapIndex:t,l.labelmaps3D[t]){var d=l.labelmaps3D[t];return void 0===n?d.metadata:d.metadata[n]}u.warn("No labelmap3D of labelmap index ".concat(t," on stack."))}else u.warn("brushStackState is undefined")}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,u=Object(a.default)(e);if(u){var d=i.default.cornerstone,c=Object(r.getToolState)(u,"stack"),f=c.data[0],g=f.imageIds[0],m=s.default.series[g];if(m||(s.default.series[g]={labelmapIndex:t,labelmaps3D:[]},m=s.default.series[g]),!m.labelmaps3D[t]){var h=d.getEnabledElement(u),v=h.image,p=v.rows,b=v.columns,j=f.imageIds.length,x=p*b*j;Object(o.default)(m,t,x)}var y=m.labelmaps3D[t];y.metadata[n]=l}}},"./store/modules/segmentationModule/segmentVisibility.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isSegmentVisible",(function(){return s})),n.d(t,"toggleSegmentVisibility",(function(){return u}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),i=n("./util/logger.js"),l=Object(i.getLogger)("store:modules:segmentationModule:segmentVisibility");function s(e,t,n){if(t){var i=Object(a.default)(e);if(i){var s=Object(o.getToolState)(i,"stack").data[0].imageIds[0],u=r.default.series[s];if(u){if(n=void 0===n?u.activeLabelmapIndex:n,u.labelmaps3D[n])return!u.labelmaps3D[n].segmentsHidden[t];l.warn("No labelmap3D of labelmap index ".concat(n," on stack."))}else l.warn("brushStackState is undefined")}}}function u(e,t,n){if(t){var i=Object(a.default)(e);if(i){var s=Object(o.getToolState)(i,"stack").data[0].imageIds[0],u=r.default.series[s];if(u){if(n=void 0===n?u.activeLabelmapIndex:n,u.labelmaps3D[n]){var d=u.labelmaps3D[n].segmentsHidden;return d[t]=!d[t],!d[t]}l.warn("No labelmap3D of labelmap index ".concat(n," on stack."))}else l.warn("brushStackState is undefined")}}}},"./store/modules/segmentationModule/setLabelmap3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setLabelmap3DByFirstImageId",(function(){return g})),n.d(t,"setLabelmap3DForElement",(function(){return f}));var a=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),i=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),l=n("./util/segmentation/index.js"),s=n("./store/modules/segmentationModule/arrayTypes.js"),u=n("./store/index.js"),d=s.default.UINT_16_ARRAY,c=s.default.FLOAT_32_ARRAY;function f(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=Object(a.default)(e);if(u){var d=Object(o.getToolState)(u,"stack"),c=d.data[0].imageIds.length,f=d.data[0].imageIds[0];g(f,t,n,r,c,i,s),Object(l.triggerLabelmapModifiedEvent)(u,n)}}function g(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,f=Object(u.getModule)("segmentation"),g=f.configuration,m=r.default.series[e];m||(r.default.series[e]={activeLabelmapIndex:n,labelmaps3D:[]},m=r.default.series[e]),m.labelmaps3D[n]={buffer:t,labelmaps2D:[],metadata:a,activeSegmentIndex:1,colorLUTIndex:s,segmentsHidden:[],undo:[],redo:[]};for(var h=m.labelmaps3D[n].labelmaps2D,v=t.byteLength/o,p=0;p<o;p++){var b=void 0;switch(g.arrayType){case d:b=new Uint16Array(t,v*p,v/2);break;case c:b=new Float32Array(t,v*p,v/4);break;default:throw new Error("Unsupported Array Type ".concat(g.arrayType))}var j=l?l[p]:Object(i.default)(b);j&&j.some((function(e){return e}))&&(h[p]={pixelData:b,segmentsOnLabelmap:j})}}},"./store/modules/segmentationModule/setRadius.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./store/index.js");function o(e){var t=Object(a.getModule)("segmentation").configuration;t.radius=Math.min(Math.max(e,t.minRadius),t.maxRadius)}},"./store/modules/segmentationModule/state.js":function(e,t,n){"use strict";n.r(t),t.default={series:{},colorLutTables:[]}},"./store/removeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"removeTool",(function(){return r})),n.d(t,"removeToolForElement",(function(){return o}));var a=n("./store/index.js"),o=function(e,t){var n=a.default.state.tools.findIndex((function(n){return n.element===e&&n.name===t}));n>=0&&a.default.state.tools.splice(n,1)},r=function(e){i(e),a.default.state.enabledElements.forEach((function(t){o(t,e)}))},i=function(e){Object(a.getModule)("globalConfiguration").configuration.globalToolSyncEnabled&&a.default.state.globalTools[e]&&delete a.default.state.globalTools[e]}},"./store/setToolCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolCursor",(function(){return r})),n.d(t,"resetToolCursor",(function(){return i})),n.d(t,"hideToolCursor",(function(){return l}));var a=n("./store/index.js"),o=a.modules.globalConfiguration;function r(e,t){if(o.configuration.showSVGCursors){var n=t.getIconWithPointerSVG(),r=t.mousePoint,i=window.URL.createObjectURL(n);e.style.cursor="url('".concat(i,"') ").concat(r,", auto"),a.state.svgCursorUrl=i}}function i(e){s(e,"initial")}function l(e){o.configuration.showSVGCursors&&s(e,"none")}function s(e,t){a.state.svgCursorUrl&&window.URL.revokeObjectURL(a.state.svgCursorUrl),a.state.svgCursorUrl=null,e.style.cursor=t}},"./store/setToolMode.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolActive",(function(){return f})),n.d(t,"setToolActiveForElement",(function(){return c})),n.d(t,"setToolDisabled",(function(){return m})),n.d(t,"setToolDisabledForElement",(function(){return g})),n.d(t,"setToolEnabled",(function(){return v})),n.d(t,"setToolEnabledForElement",(function(){return h})),n.d(t,"setToolPassive",(function(){return b})),n.d(t,"setToolPassiveForElement",(function(){return p})),n.d(t,"setToolMode",(function(){return x})),n.d(t,"setToolModeForElement",(function(){return j})),n.d(t,"_getNormalizedOptions",(function(){return C})),n.d(t,"_mergeMouseButtonMask",(function(){return O}));var a=n("./events.js"),o=n("./util/triggerEvent.js"),r=n("./store/getToolForElement.js"),i=n("./store/setToolCursor.js"),l=n("./util/logger.js"),s=n("./store/index.js"),u=Object(s.getModule)("globalConfiguration"),d=Object(l.getLogger)("store:setToolMode"),c=function(e,t,n,a){void 0===a&&Array.isArray(n)&&(a=n,n=null);var o=Object(r.default)(e,t);o&&(function(e,t,n,a){t.supportedInteractionTypes.forEach((function(o){if(void 0===a||a.includes(o)){var r=w[o];r?r(t,e,n):d.warn("Unable to resolve input conflicts for type %s",o)}})),s.default.state.tools.filter((function(t){return t.element===e&&"active"===t.mode&&t.supportedInteractionTypes.length>0})).forEach((function(t){var n=!1;t.supportedInteractionTypes.forEach((function(e){t.options["is".concat(e,"Active")]&&(n=!0)})),n||(d.log("Setting tool %s's to PASSIVE",t.name),p(e,t.name))}))}(e,o,n,a),o.supportedInteractionTypes.forEach((function(e){void 0===a||a.includes(e)?n["is".concat(e,"Active")]=!0:n["is".concat(e,"Active")]=!1})),u.configuration.showSVGCursors&&o.supportedInteractionTypes.includes("Mouse")&&function(e,t,n){("number"==typeof t?[t]:t.mouseButtonMask).includes(1)&&(n.svgCursor?Object(i.setToolCursor)(n.element,n.svgCursor):n.hideDefaultCursor?Object(i.hideToolCursor)(e):Object(i.resetToolCursor)(e))}(e,n,o)),j("active",null,e,t,n)},f=function(e,t,n){T("active",e,t,n),s.default.state.enabledElements.forEach((function(a){c(a,e,t,n)}))},g=j.bind(null,"disabled",null),m=x.bind(null,"disabled",null),h=j.bind(null,"enabled",null),v=x.bind(null,"enabled",null),p=j.bind(null,"passive",a.default.TOOL_DEACTIVATED),b=x.bind(null,"passive",a.default.TOOL_DEACTIVATED);function j(e,t,n,a,i){var l=Object(r.default)(n,a);if(l){if(i=C(i),Array.isArray(i.mouseButtonMask)&&0!==i.mouseButtonMask.length&&Array.isArray(l.options.mouseButtonMask)&&(i.mouseButtonMask=O(i.mouseButtonMask,l.options.mouseButtonMask)),l.mode=e,l.mergeOptions(i),l["".concat(e,"Callback")]&&l["".concat(e,"Callback")](n,i),t){var s={options:i,toolName:a,toolType:a,type:t};Object(o.default)(n,t,s)}}else d.warn('Unable to find tool "%s" for enabledElement',a)}function x(e,t,n,a){T(e,n,a),s.default.state.enabledElements.forEach((function(o){j(e,t,o,n,a)}))}function y(e,t,n){var a="is".concat(e,"Active"),o=s.default.state.tools.find((function(e){return e.element===n&&"active"===e.mode&&!0===e.options[a]}));o&&(d.log("Setting tool %s's %s to false",o.name,a),o.options[a]=!1)}function T(e,t,n,a){if(u.configuration.globalToolSyncEnabled){var o={mode:e,args:[t,n]};a&&o.push(a),s.default.state.globalToolChangeHistory.push(o),s.default.state.globalToolChangeHistory.length>50&&s.default.state.globalToolChangeHistory.shift();var r=s.default.state.globalTools[t];if(r)if("active"===e){var i=function(e,t,n){void 0===n&&Array.isArray(t)&&(n=t,t=null);var a=[],o=s.default.state.globalTools[e];if(o){var r=new o.tool(o.props);r.supportedInteractionTypes.forEach((function(e){if(void 0===n||n.includes(e))if("Mouse"===e){var o=C(t).mouseButtonMask;Array.isArray(o)&&o.length>0?o.forEach((function(t){return a.push("".concat(e,"-").concat(t))})):Array.isArray(o)&&0===o.length&&a.push("".concat(e,"-DELETE"))}else"MultiTouch"===e?a.push("".concat(e,"-").concat(r.configuration.touchPointers)):a.push(e)}))}return a}(t,n,a);Object.keys(s.default.state.globalTools).forEach((function(e){var t=s.default.state.globalTools[e];t.activeBindings=t.activeBindings.filter((function(e){return!i.includes(e)}))})),i.some((function(e){return e.includes("Mouse-DELETE")}))&&(r.activeBindings=r.activeBindings.filter((function(e){return!e.includes("Mouse")})),i=i.filter((function(e){return!e.includes("Mouse")}))),r.activeBindings=r.activeBindings.concat(i)}else r.activeBindings=[];else d.warn("setToolMode call for tool not available globally: ".concat(t))}}var w={Mouse:function(e,t,n){var a=C(n).mouseButtonMask;if(Array.isArray(a)&&a.length>0){var o=s.default.state.tools.find((function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isMouseActive&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.some((function(e){return a.includes(e)}))}));o&&(o.options.mouseButtonMask=o.options.mouseButtonMask.filter((function(e){return!a.includes(e)})),0===o.options.mouseButtonMask.length&&(o.options.isMouseActive=!1))}},MouseWheel:y.bind(void 0,"MouseWheel"),Touch:function(e,t){var n=s.default.state.tools.find((function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isTouchActive})),a=s.default.state.tools.find((function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isMultiTouchActive&&1===e.configuration.touchPointers}));n&&(d.log("Setting tool %s's isTouchActive to false",n.name),n.options.isTouchActive=!1),a&&(d.log("Setting tool %s's isTouchActive to false",a.name),a.options.isMultiTouchActive=!1)},TouchPinch:y.bind(void 0,"TouchPinch"),TouchRotate:y.bind(void 0,"TouchRotate"),DoubleTap:y.bind(void 0,"DoubleTap"),MultiTouch:function(e,t){var n,a=s.default.state.tools.find((function(n){return n.element===t&&"active"===n.mode&&!0===n.options.isMultiTouchActive&&n.configuration.touchPointers===e.configuration.touchPointers}));1===e.configuration.touchPointers&&(n=s.default.state.tools.find((function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isTouchActive}))),a&&(d.log("Setting tool %s's isMultiTouchActive to false",a.name),a.options.isMultiTouchActive=!1),n&&(d.log("Setting tool %s's isTouchActive to false",n.name),n.options.isTouchActive=!1)}};function C(e){return Array.isArray(e)?e={mouseButtonMask:e}:e!==Object(e)&&(e={mouseButtonMask:[e]}),e.hasOwnProperty("mouseButtonMask")||(e.mouseButtonMask=[]),Array.isArray(e.mouseButtonMask)||(e.mouseButtonMask=[e.mouseButtonMask]),e.mouseButtonMask=e.mouseButtonMask.filter((function(e){return"number"==typeof e&&0!==e})),e}function O(e,t){return e.concat(t).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[])}},"./store/setToolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolOptions",(function(){return i})),n.d(t,"setToolOptionsForElement",(function(){return r}));var a=n("./store/getToolForElement.js"),o=n("./store/index.js"),r=function(e,t,n){var o=Object(a.default)(e,t);o&&o.mergeOptions(n)},i=function(e,t){o.state.enabledElements.forEach((function(n){r(n,e,t)}))}},"./synchronization/Synchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./util/convertToVector3.js"),r=n("./toolOptions.js");function i(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))}t.default=function(e,t){a.default.cornerstone;var n=this,l=[],s=[],u=!1,d={},c=t;function f(e){var t=e.detail.element;n.remove(t),Object(r.clearToolOptionsByElement)(t)}this.enabled=!0,this.setHandler=function(e){c=e},this.getHandler=function(){return c},this.getDistances=function(){if(l.length&&s.length){var e=a.default.cornerstone;d.distances={},d.imageIds={sourceElements:[],targetElements:[]},l.forEach((function(t){var n=e.getEnabledElement(t);if(n&&n.image){var a=n.image.imageId,r=e.metaData.get("imagePlaneModule",a);if(r&&r.imagePositionPatient){var i=Object(o.default)(r.imagePositionPatient);d.hasOwnProperty(n)||(d.distances[a]={},d.imageIds.sourceElements.push(a),s.forEach((function(n){var r=e.getEnabledElement(n);if(r&&r.image){var l=r.image.imageId;if(d.imageIds.targetElements.push(l),t!==n&&a!==l&&!d.distances[a].hasOwnProperty(l)){var s=e.metaData.get("imagePlaneModule",l);if(s&&s.imagePositionPatient){var u=Object(o.default)(s.imagePositionPatient);d.distances[a][l]=u.clone().sub(i)}}}})),Object.keys(d.distances[a]).length||delete d.distances[a])}}}))}},this.fireEvent=function(e,t){var a=!n.enabled,o=!l.length||!s.length;a||o||(u=!0,s.forEach((function(a){var o=s.indexOf(a);if(-1!==o){var r=d.imageIds.targetElements[o],i=l.indexOf(e);if(-1!==i){var u,f=d.imageIds.sourceElements[i];f===r?u=0:void 0!==d.distances[f]&&(u=d.distances[f][r]),c(n,e,a,t,u)}}})),u=!1)},this.onEvent=function(e){var t=e.detail;!0!==u&&n.fireEvent(e.currentTarget,t)},this.addSource=function(t){-1===l.indexOf(t)&&(l.push(t),e.split(" ").forEach((function(e){t.addEventListener(e,n.onEvent)})),n.getDistances(),n.updateDisableHandlers())},this.addTarget=function(e){-1===s.indexOf(e)&&(s.push(e),n.getDistances(),c(n,e,e,0),n.updateDisableHandlers())},this.add=function(e){n.addSource(e),n.addTarget(e)},this.removeSource=function(t){var a=l.indexOf(t);-1!==a&&(l.splice(a,1),e.split(" ").forEach((function(e){t.removeEventListener(e,n.onEvent)})),n.getDistances(),n.fireEvent(t),n.updateDisableHandlers())},this.removeTarget=function(e){var t=s.indexOf(e);-1!==t&&(s.splice(t,1),n.getDistances(),c(n,e,e,0),n.updateDisableHandlers())},this.remove=function(e){n.removeTarget(e),n.removeSource(e)},this.getSourceElements=function(){return l},this.getTargetElements=function(){return s},this.displayImage=function(e,t,n){u=!0,a.default.cornerstone.displayImage(e,t,n),u=!1},this.setViewport=function(e,t){u=!0,a.default.cornerstone.setViewport(e,t),u=!1},this.updateDisableHandlers=function(){i(l.concat(s)).forEach((function(e){e.removeEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,f),e.addEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,f)}))},this.destroy=function(){i(l.concat(s)).forEach((function(e){n.remove(e)}))}}},"./synchronization/panZoomSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var o=a.default.cornerstone,r=o.getViewport(t),i=o.getViewport(n);i.scale===r.scale&&i.translation.x===r.translation.x&&i.translation.y===r.translation.y||(i.scale=r.scale,i.translation.x=r.translation.x,i.translation.y=r.translation.y,e.setViewport(n,i))}}},"./synchronization/stackImageIndexSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),r=n("./stateManagement/loadHandlerManager.js"),i=n("./util/clip.js");t.default=function(e,t,n){if(n!==t){var l=a.default.cornerstone,s=Object(o.getToolState)(t,"stack").data[0],u=Object(o.getToolState)(n,"stack").data[0],d=s.currentImageIdIndex;if((d=Object(i.default)(d,0,u.imageIds.length-1))!==u.currentImageIdIndex){var c=r.default.getStartLoadHandler(n),f=r.default.getEndLoadHandler(n),g=r.default.getErrorLoadingHandler(n);c&&c(n),(!0===u.preventCache?l.loadImage(u.imageIds[d]):l.loadAndCacheImage(u.imageIds[d])).then((function(t){var a=l.getViewport(n);u.currentImageIdIndex=d,e.displayImage(n,t,a),f&&f(n,t)}),(function(e){var t=u.imageIds[d];g&&g(n,t,e)}))}}}},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),r=n("./stateManagement/loadHandlerManager.js"),i=n("./util/convertToVector3.js");t.default=function(e,t,n,l,s){if(n!==t){var u=a.default.cornerstone,d=Object(o.getToolState)(t,"stack").data[0],c=d.imageIds[d.currentImageIdIndex],f=u.metaData.get("imagePlaneModule",c);if(void 0!==f&&void 0!==f.imagePositionPatient){var g=Object(i.default)(f.imagePositionPatient),m=Object(o.getToolState)(n,"stack").data[0],h=Number.MAX_VALUE,v=-1;if(s){var p=g.clone().add(s);if(m.imageIds.forEach((function(e,t){var n=u.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient),o=p.distanceToSquared(a);o<h&&(h=o,v=t)}})),v!==m.currentImageIdIndex&&-1!==v){var b=r.default.getStartLoadHandler(n),j=r.default.getEndLoadHandler(n),x=r.default.getErrorLoadingHandler(n);m.currentImageIdIndex=v;var y=m.imageIds[v];b&&b(n),(!0===m.preventCache?u.loadImage(y):u.loadAndCacheImage(y)).then((function(t){var a=u.getViewport(n);m.currentImageIdIndex===v&&(e.displayImage(n,t,a),j&&j(n,t))}),(function(e){var t=m.imageIds[v];x&&x(n,t,e)}))}}}}}},"./synchronization/stackImagePositionSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),r=n("./stateManagement/loadHandlerManager.js"),i=n("./util/convertToVector3.js");t.default=function(e,t,n){if(n!==t){var l=a.default.cornerstone,s=Object(o.getToolState)(t,"stack").data[0],u=s.imageIds[s.currentImageIdIndex],d=l.metaData.get("imagePlaneModule",u);if(void 0!==d&&void 0!==d.imagePositionPatient){var c=Object(i.default)(d.imagePositionPatient),f=Object(o.getToolState)(n,"stack").data[0],g=Number.MAX_VALUE,m=-1;if(f.imageIds.forEach((function(e,t){var n=l.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient).distanceToSquared(c);a<g&&(g=a,m=t)}})),m!==f.currentImageIdIndex){var h=r.default.getStartLoadHandler(n),v=r.default.getEndLoadHandler(n),p=r.default.getErrorLoadingHandler(n);f.currentImageIdIndex=m;var b=f.imageIds[m];h&&h(n),-1!==m&&(!0===f.preventCache?l.loadImage(b):l.loadAndCacheImage(b)).then((function(t){var a=l.getViewport(n);f.currentImageIdIndex===m&&(e.displayImage(n,t,a),v&&v(n,t))}),(function(e){var t=f.imageIds[m];p&&p(n,t,e)}))}}}}},"./synchronization/stackScrollSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),r=n("./stateManagement/loadHandlerManager.js"),i=n("./util/clip.js");t.default=function(e,t,n,l){if(t!==n&&l&&l.direction){var s=a.default.cornerstone,u=Object(o.getToolState)(n,"stack").data[0],d=u.currentImageIdIndex+l.direction;if(d=Object(i.default)(d,0,u.imageIds.length-1),u.currentImageIdIndex!==d){var c=r.default.getStartLoadHandler(n),f=r.default.getEndLoadHandler(n),g=r.default.getErrorLoadingHandler(n);u.currentImageIdIndex=d;var m=u.imageIds[d];c&&c(n),(!0===u.preventCache?s.loadImage(m):s.loadAndCacheImage(m)).then((function(t){var a=s.getViewport(n);u.currentImageIdIndex===d&&(e.displayImage(n,t,a),f&&f(n,t))}),(function(e){var t=u.imageIds[d];g&&g(n,t,e)}))}}}},"./synchronization/updateImageSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){n!==t&&a.default.cornerstone.updateImage(n)}},"./synchronization/wwwcSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var o=a.default.cornerstone,r=o.getViewport(t),i=o.getViewport(n);i.voi.windowWidth===r.voi.windowWidth&&i.voi.windowCenter===r.voi.windowCenter&&i.invert===r.invert||(i.voi.windowWidth=r.voi.windowWidth,i.voi.windowCenter=r.voi.windowCenter,i.invert=r.invert,e.setViewport(n,i))}}},"./thirdParty/register.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n("./thirdParty/registerModule.js"),i=n("./thirdParty/registerMixin.js"),l=n("./thirdParty/registerItem.js"),s=n("./util/logger.js"),u=Object(s.getLogger)("thirdParty:register");function d(e,t,n){return e?t?"object"===o()(n)||"function"==typeof n||(u.warn("The %s is a %s, it should be an Object or a function.",n,o()(n)),!1):(u.warn("The %s must have a name in order to register.",e),!1):(u.warn("The type must be given in order to register."),!1)}t.default=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(d(e,t,n))switch(e){case"module":Object(r.default)(t,n,a);break;case"mixin":Object(i.default)(t,n,a);break;default:Object(l.default)(e,t,n,a)}}},"./thirdParty/registerItem.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js"),o=n("./util/logger.js"),r=Object(o.getLogger)("thirdParty:registerType");function i(e){return void 0!==a.lib[e]}t.default=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l="".concat(e,"/").concat(t),s=i(l);!s||o?(s&&r.warn("Overwriting %s",l),a.lib[l]=n):r.warn("%s is already registered",l)}},"./thirdParty/registerMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js"),o=n("./mixins/index.js"),r=n("./util/logger.js"),i=Object(r.getLogger)("thirdParty:registerMixin");function l(e){return void 0!==o.default[e]}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=l(e);!r||n?(r&&i.warn("Overwriting mixins/%s",e),o.default[e]=t,a.lib["mixins/".concat(e)]=o.default[e]):i.warn("mixins/%s is already registered",e)}},"./thirdParty/registerModule.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),o=n("./util/logger.js"),r=Object(o.getLogger)("thirdParty:registerModule");function i(e){return void 0!==a.modules[e]}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=i(e);!o||n?(o&&r.warn("Overwriting module %s",e),a.modules[e]=t,"function"==typeof a.modules[e].onRegisterCallback&&a.modules[e].onRegisterCallback()):r.warn("A module with the name %s is already registered",e)}},"./thirdParty/registerSome.js":function(e,t,n){"use strict";n.r(t);var a=n("./thirdParty/register.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach((function(e){var n=e.type,o=e.name,r=e.item;Object(a.default)(n,o,r,t)}))}},"./toolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getToolOptions",(function(){return o})),n.d(t,"setToolOptions",(function(){return r})),n.d(t,"clearToolOptions",(function(){return i})),n.d(t,"clearToolOptionsByToolType",(function(){return l})),n.d(t,"clearToolOptionsByToolName",(function(){return s})),n.d(t,"clearToolOptionsByElement",(function(){return u}));var a={};function o(e,t){if(!a[e])return{};var n=a[e].find((function(e){return e.element===t}));return n?n.options:{}}function r(e,t,n){if(a[e]){var o=a[e].findIndex((function(e){return e.element===t}));if(-1===o)a[e].push({element:t,options:n});else{var r=a[e][o].options||{};a[e][o].options=Object.assign(r,n)}}else a[e]=[{element:t,options:n}]}function i(e,t){var n=a[e];n&&(a[e]=n.filter((function(e){return e.element!==t})))}function l(e){return s(e)}function s(e){delete a[e]}function u(e){for(var t in a)a[t]=a[t].filter((function(t){return t.element!==e}))}},"./tools/CrosshairsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./tools/base/BaseTool.js"),v=n("./externalModules.js"),p=n("./stateManagement/loadHandlerManager.js"),b=n("./stateManagement/toolState.js"),j=n("./util/pointProjector.js"),x=n("./util/convertToVector3.js"),y=n("./toolOptions.js"),T=n("./tools/cursors/index.js"),w=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Crosshairs",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.crosshairsCursor};return(e=s()(this,d()(t).call(this,n,a))).preMouseDownCallback=e._chooseLocation.bind(f()(e)),e.mouseDragCallback=e._chooseLocation.bind(f()(e)),e.touchDragCallback=e._chooseLocation.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_chooseLocation",value:function(e){var t=e.detail,n=t.element;e.stopImmediatePropagation();var a=Object(b.getToolState)(n,this.name);if(a){var o=n,r=v.default.cornerstone.getEnabledElement(o).image.imageId,i=v.default.cornerstone.metaData.get("imagePlaneModule",r);if(i){var l=t.currentPoints.image,s=Object(j.imagePointToPatientPoint)(l,i);a.data[0].synchronizationContext.getSourceElements().forEach((function(e){if(e!==o){var t=Number.MAX_VALUE,n=-1,a=Object(b.getToolState)(e,"stack");if(void 0!==a){var r=a.data[0];if(r.imageIds.forEach((function(e,a){var o=v.default.cornerstone.metaData.get("imagePlaneModule",e);if(o&&o.imagePositionPatient&&o.rowCosines&&o.columnCosines){var r=Object(x.default)(o.imagePositionPatient),i=Object(x.default)(o.rowCosines),l=Object(x.default)(o.columnCosines).clone().cross(i.clone()),u=Math.abs(l.clone().dot(r)-l.clone().dot(s));u<t&&(t=u,n=a)}})),n!==r.currentImageIdIndex&&-1!==n&&void 0!==r.imageIds[n]){var i=p.default.getStartLoadHandler(e),l=p.default.getEndLoadHandler(e),u=p.default.getErrorLoadingHandler(e);i&&i(e),(!0===r.preventCache?v.default.cornerstone.loadImage(r.imageIds[n]):v.default.cornerstone.loadAndCacheImage(r.imageIds[n])).then((function(t){var a=v.default.cornerstone.getViewport(e);r.currentImageIdIndex=n,v.default.cornerstone.displayImage(e,t,a),l&&l(e,t)}),(function(t){var a=r.imageIds[n];u&&u(e,a,t)}))}}}}))}}}},{key:"activeCallback",value:function(e,t){var n=t.mouseButtonMask,a=t.synchronizationContext;Object(y.setToolOptions)(this.name,e,{mouseButtonMask:n}),Object(b.clearToolState)(e,this.name),Object(b.addToolState)(e,this.name,{synchronizationContext:a})}}]),t}(h.default)},"./tools/DoubleTapFitToWindowTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"DoubleTapFitToWindow",supportedInteractionTypes:["DoubleTap"]};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"doubleTapCallback",value:function(e){var t=e.detail;g.default.cornerstone.fitToWindow(t.element)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/DragProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./stateManagement/textStyle.js"),b=n("./stateManagement/toolColors.js"),j=n("./util/getRGBPixels.js"),x=n("./util/calculateSUV.js"),y=n("./drawing/index.js"),T=n("./drawing/drawTextBox.js"),w=n("./tools/cursors/index.js"),C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"DragProbe",strategies:{default:O,minimal:E},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:w.probeCursor};return(e=s()(this,d()(t).call(this,n,a))).touchDragCallback=e._movingEventCallback.bind(f()(e)),e.touchEndCallback=e._endMovingEventCallback.bind(f()(e)),e.mouseDragCallback=e._movingEventCallback.bind(f()(e)),e.mouseUpCallback=e._endMovingEventCallback.bind(f()(e)),e.dragEventData={},e}return m()(t,e),i()(t,[{key:"_movingEventCallback",value:function(e){var t=e.detail,n=t.element;this.dragEventData=t,h.default.cornerstone.updateImage(n)}},{key:"_endMovingEventCallback",value:function(e){var t=e.detail.element;this.dragEventData={},h.default.cornerstone.updateImage(t)}},{key:"renderToolData",value:function(e){this.dragEventData.currentPoints&&e&&e.detail&&Boolean(Object.keys(this.dragEventData.currentPoints).length)&&(e.detail.currentPoints=this.dragEventData.currentPoints,this.applyActiveStrategy(e))}}]),t}(v.default);function O(e){var t=this.configuration,n=h.default.cornerstone,a=e.detail,o=a.element,r=a.image,i=a.currentPoints,l=a.canvasContext,s=Object(y.getNewContext)(l.canvas),u=b.default.getActiveColor(),d=p.default.getFontSize(),c=Math.round(i.image.x),f=Math.round(i.image.y);c<0||f<0||c>=r.columns||f>=r.rows||Object(y.draw)(s,(function(e){Object(y.setShadow)(e,t);var a,l,s="".concat(c,", ").concat(f);if(r.color)a=Object(j.default)(o,c,f,1,1),l="R: ".concat(a[0]," G: ").concat(a[1]," B: ").concat(a[2]," A: ").concat(a[3]);else{var g=(a=n.getStoredPixels(o,c,f,1,1))[0],m=g*r.slope+r.intercept,h=Object(x.default)(r,g);l="SP: ".concat(g," MO: ").concat(parseFloat(m.toFixed(3))),h&&(l+=" SUV: ".concat(parseFloat(h.toFixed(3))))}var v={x:i.canvas.x+5,y:i.canvas.y-5};Object(T.default)(e,l,v.x,v.y+d+5,u),Object(T.default)(e,s,v.x,v.y,u)}))}function E(e){var t=this.configuration,n=h.default.cornerstone,a=e.detail,o=a.element,r=a.image,i=a.currentPoints,l=a.canvasContext,s=a.isTouchEvent,u=Object(y.getNewContext)(l.canvas),d=b.default.getActiveColor(),c=i.page.y-p.default.getFontSize()/2;s&&(c=i.page.y-4*p.default.getFontSize());var f=n.pageToPixel(o,i.page.x,c);f.x<0||f.y<0||f.x>=r.columns||f.y>=r.rows||Object(y.draw)(u,(function(e){Object(y.setShadow)(e,t);var a,i=n.metaData.get("generalSeriesModule",r.imageId),l=i&&i.modality,u="";if(r.color)a=Object(j.default)(o,f.x,f.y,1,1),u="R: ".concat(a[0]," G: ").concat(a[1]," B: ").concat(a[2]);else{var c=(a=n.getStoredPixels(o,f.x,f.y,1,1))[0],g=c*r.slope+r.intercept,m=parseFloat(g.toFixed(2));if("CT"===l)u+="HU: ".concat(m);else if("PT"===l){u+=m;var h=Object(x.default)(r,c);h&&(u+=" SUV: ".concat(parseFloat(h.toFixed(2))))}else u+=m}var v=n.pixelToCanvas(o,f),b={x:12,y:-(p.default.getFontSize()+10)/2},w=Object(T.textBoxWidth)(e,u,5);s&&(b={x:-w/2,y:-p.default.getFontSize()-10-12}),Object(y.drawCircle)(e,o,v,6,{color:d},"canvas"),Object(T.default)(e,u,v.x+b.x,v.y+b.y,d)}))}},"./tools/EraserTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./stateManagement/toolState.js"),b=n("./store/index.js"),j=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Eraser",supportedInteractionTypes:["Mouse","Touch"],svgCursor:j.eraserCursor};return(e=s()(this,d()(t).call(this,n,a))).preMouseDownCallback=e._deleteAllNearbyTools.bind(f()(e)),e.preTouchStartCallback=e._deleteAllNearbyTools.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_deleteAllNearbyTools",value:function(e){var t=e.detail.currentPoints.canvas,n=e.detail.element;return b.state.tools.forEach((function(e){var a=Object(p.getToolState)(n,e.name);a&&a.data.forEach((function(a){"function"==typeof e.pointNearTool&&e.pointNearTool(n,a,t)&&(Object(p.removeToolState)(n,e.name,a),h.default.cornerstone.updateImage(n))}))})),!0}}]),t}(v.default)},"./tools/FreehandRoiSculptorTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return I}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./events.js"),v=n("./externalModules.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/drawHandles.js"),j=n("./store/index.js"),x=n("./stateManagement/toolState.js"),y=n("./util/clip.js"),T=n("./store/getToolForElement.js"),w=n("./tools/base/BaseTool.js"),C=n("./store/setToolCursor.js"),O=n("./tools/cursors/index.js"),E=n("./util/freehand/index.js"),M=E.default.FreehandHandleData,I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"FreehandRoiSculptor",referencedToolName:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch","DoubleTap"],mixins:["activeOrDisabledBinaryTool"],configuration:S(),svgCursor:O.freehandRoiSculptorCursor};return(e=s()(this,d()(t).call(this,n,a))).updateOnMouseMove=!0,e.isMultiPartTool=!0,e.referencedToolName=e.initialConfiguration.referencedToolName,e._active=!1,e.activeMouseUpCallback=e.activeMouseUpCallback.bind(f()(e)),e.activeTouchEndCallback=e.activeTouchEndCallback.bind(f()(e)),e.activeMouseDragCallback=e.activeMouseDragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"renderToolData",value:function(e){var t=e.detail;if(null===this.configuration.currentTool)return!1;var n=t.element,a=this.configuration;if(!Object(x.getToolState)(n,this.referencedToolName).data[a.currentTool])return!1;if(this._active){var o=t.canvasContext.canvas.getContext("2d"),r={color:this.configuration.dragColor,fill:null,handleRadius:this._toolSizeCanvas};Object(b.default)(o,t,this.configuration.mouseLocation.handles,r)}else this.configuration.showCursorOnHover&&!this._recentTouchEnd&&this._renderHoverCursor(e)}},{key:"doubleClickCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),v.default.cornerstone.updateImage(t.element)}},{key:"doubleTapCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),v.default.cornerstone.updateImage(t.element)}},{key:"preTouchStartCallback",value:function(e){return this._initialiseSculpting(e),!0}},{key:"preMouseDownCallback",value:function(e){if(this.options.mouseButtonMask.includes(e.detail.buttons))return this._initialiseSculpting(e),!0}},{key:"activeMouseDragCallback",value:function(e){var t=this.configuration;if(this._active){var n=e.detail,a=Object(x.getToolState)(n.element,this.referencedToolName);if(a){var o=a.data[t.currentTool].handles.points;this._getMouseLocation(n),this._sculpt(n,o),v.default.cornerstone.updateImage(n.element)}}}},{key:"activeMouseUpCallback",value:function(e){this._activeEnd(e)}},{key:"activeTouchEndCallback",value:function(e){this._activeEnd(e),this._deselectAllTools(e),this._recentTouchEnd=!0}},{key:"_activeEnd",value:function(e){var t=e.detail,n=t.element,a=this.configuration;this._active=!1,j.state.isMultiPartToolActive=!1,this._getMouseLocation(t),this._invalidateToolData(t),a.mouseUpRender=!0,this._deactivateSculpt(n),v.default.cornerstone.updateImage(t.element),function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}(e)}},{key:"_renderHoverCursor",value:function(e){var t,n=e.detail,a=n.element,o=n.canvasContext.canvas.getContext("2d"),r=Object(x.getToolState)(a,this.referencedToolName).data[this.configuration.currentTool];this._recentTouchEnd=!1,this.configuration.mouseUpRender?(t=this.configuration.mouseLocation.handles.start,this.configuration.mouseUpRender=!1):t=j.state.mousePositionImage;var i=Object(T.default)(a,this.referencedToolName).distanceFromPointCanvas(a,r,t);if(this.configuration.mouseLocation.handles.start.x=t.x,this.configuration.mouseLocation.handles.start.y=t.y,this.configuration.limitRadiusOutsideRegion){var l=i;i=this._limitCursorRadiusCanvas(n,i),l>this.configuration.hoverCursorFadeDistance*i&&(o.globalAlpha=this.configuration.hoverCursorFadeAlpha)}var s={fill:null,color:this.configuration.hoverColor,handleRadius:i};Object(b.default)(o,n,this.configuration.mouseLocation.handles,s),this.configuration.limitRadiusOutsideRegion&&(o.globalAlpha=1)}},{key:"newImageCallback",value:function(e){this._deselectAllTools(e)}},{key:"enabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"passiveCallback",value:function(e){this._deselectAllTools(e)}},{key:"disabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"_selectFreehandTool",value:function(e){var t=this.configuration,n=e.element,a=this._getClosestFreehandToolOnElement(n,e);void 0!==a&&(t.currentTool=a,Object(C.hideToolCursor)(n))}},{key:"_activateFreehandTool",value:function(e,t){var n=Object(x.getToolState)(e,this.referencedToolName).data;this.configuration.currentTool=t;for(var a=0;a<n.length;a++)n[a].active=a===t}},{key:"_initialiseSculpting",value:function(e){var t=e.detail,n=this.configuration,a=t.element;null===n.currentTool&&(this._selectFreehandTool(t),null===n.currentTool)||(this._active=!0,j.state.isMultiPartToolActive=!0,this._configureToolSize(t),this._getMouseLocation(t),this._activateFreehandTool(a,n.currentTool),this._activateSculpt(a),v.default.cornerstone.updateImage(t.element))}},{key:"_sculpt",value:function(e,t){var n=this.configuration;this._sculptData={element:e.element,image:e.image,mousePoint:e.currentPoints.image,points:t,toolSize:this._toolSizeImage,minSpacing:n.minSpacing,maxSpacing:Math.max(this._toolSizeImage,2*n.minSpacing)};var a=this._pushHandles();void 0!==a.first&&(this._insertNewHandles(a),this._consolidateHandles())}},{key:"_pushHandles",value:function(){for(var e=this._sculptData,t=e.points,n=e.mousePoint,a=e.toolSize,o={},r=0;r<t.length;r++){var i=v.default.cornerstoneMath.point.distance(t[r],n);i>a||(this._pushOneHandle(r,i),void 0===o.first?(o.first=r,o.last=r):o.last=r)}return o}},{key:"_pushOneHandle",value:function(e,t){var n=this._sculptData,a=n.points,o=n.mousePoint,r=n.toolSize,i=n.image,l=a[e],s=(l.x-o.x)/t,u=(l.y-o.y)/t,d={x:o.x+r*s,y:o.y+r*u};Object(y.clipToBox)(d,i),l.x=d.x,l.y=d.y;var c=this.constructor._getPreviousHandleIndex(e,a.length);a[c].lines.pop(),a[c].lines.push(l)}},{key:"_insertNewHandles",value:function(e){for(var t=this._findNewHandleIndicies(e),n=0,a=0;a<t.length;a++){var o=t[a]+1+n;this._insertHandleRadially(o),n++}}},{key:"_findNewHandleIndicies",value:function(e){for(var t=this._sculptData,n=t.points,a=t.maxSpacing,o=[],r=e.first;r<=e.last;r++)this._checkSpacing(r,n,o,a);var i=this.constructor._getNextHandleIndex(e.last,n.length);if(i!==e.first){this._checkSpacing(i,n,o,a);var l=this.constructor._getPreviousHandleIndex(e.first,n.length);l!==i&&this._checkSpacing(l,n,o,a)}return o}},{key:"_checkSpacing",value:function(e,t,n,a){var o=this.constructor._getNextHandleIndex(e,t.length);v.default.cornerstoneMath.point.distance(t[e],t[o])>a&&n.push(e)}},{key:"_insertHandleRadially",value:function(e){var t=this._sculptData.points,n=e-1,a=this.constructor._getNextHandleIndexBeforeInsert(e,t.length),o=this._getInsertPosition(e,n,a),r=new M(o);t.splice(e,0,r),t[n].lines.pop(),t[n].lines.push(t[e]),E.default.addLine(t,e)}},{key:"_consolidateHandles",value:function(){if(!(this._sculptData.points.length<=3)){var e=this._findCloseHandlePairs();this._mergeCloseHandles(e)}}},{key:"_findCloseHandlePairs",value:function(){for(var e=this._sculptData,t=e.points,n=e.minSpacing,a=[],o=t.length,r=0;r<o;r++){var i=this.constructor._getNextHandleIndex(r,t.length);if(v.default.cornerstoneMath.point.distance(t[r],t[i])<n){var l=[r,i];a.push(l),0===r&&(o-=1),r++}}return a}},{key:"_mergeCloseHandles",value:function(e){for(var t=0,n=0;n<e.length;n++){var a=this.constructor._getCorrectedPair(e[n],t);this._combineHandles(a),t++}var o=this._findCloseHandlePairs();o.length&&this._mergeCloseHandles(o)}},{key:"_combineHandles",value:function(e){var t=this._sculptData,n=t.points,a=t.image,o={x:(n[e[0]].x+n[e[1]].x)/2,y:(n[e[0]].y+n[e[1]].y)/2};Object(y.clipToBox)(o,a),n[e[0]].x=o.x,n[e[0]].y=o.y;var r=this.constructor._getNextHandleIndex(e[1],n.length);n[e[0]].lines.pop(),n[e[0]].lines.push(n[r]),n.splice(e[1],1)}},{key:"_configureToolSize",value:function(e){var t=e.element,n=this.configuration,a=n.currentTool,o=e.currentPoints.image,r=Object(x.getToolState)(t,this.referencedToolName).data[a],i=Object(T.default)(t,this.referencedToolName),l=i.distanceFromPoint(t,r,o),s=i.distanceFromPointCanvas(t,r,o);n.limitRadiusOutsideRegion&&(l=this._limitCursorRadiusImage(e,l),s=this._limitCursorRadiusCanvas(e,s)),this._toolSizeImage=l,this._toolSizeCanvas=s}},{key:"_getMouseLocation",value:function(e){var t=this.configuration;t.mouseLocation.handles.start.x=e.currentPoints.image.x,t.mouseLocation.handles.start.y=e.currentPoints.image.y,Object(y.clipToBox)(t.mouseLocation.handles.start,e.image)}},{key:"_activateSculpt",value:function(e){this._deactivateSculpt(e),e.addEventListener(h.default.MOUSE_UP,this.activeMouseUpCallback),e.addEventListener(h.default.MOUSE_CLICK,this.activeMouseUpCallback),e.addEventListener(h.default.MOUSE_DRAG,this.activeMouseDragCallback),e.addEventListener(h.default.TOUCH_END,this.activeTouchEndCallback),e.addEventListener(h.default.TOUCH_TAP,this.activeTouchEndCallback),e.addEventListener(h.default.TOUCH_DRAG,this.activeMouseDragCallback),v.default.cornerstone.updateImage(e)}},{key:"_deactivateSculpt",value:function(e){e.removeEventListener(h.default.MOUSE_UP,this.activeMouseUpCallback),e.removeEventListener(h.default.MOUSE_CLICK,this.activeMouseUpCallback),e.removeEventListener(h.default.MOUSE_DRAG,this.activeMouseDragCallback),e.removeEventListener(h.default.TOUCH_END,this.activeTouchEndCallback),e.removeEventListener(h.default.TOUCH_TAP,this.activeTouchEndCallback),e.removeEventListener(h.default.TOUCH_DRAG,this.activeMouseDragCallback),v.default.cornerstone.updateImage(e)}},{key:"_invalidateToolData",value:function(e){var t=this.configuration,n=e.element;Object(x.getToolState)(n,this.referencedToolName).data[t.currentTool].invalidated=!0}},{key:"_deselectAllTools",value:function(e){var t=this.configuration,n=Object(x.getToolState)(this.element,this.referencedToolName);if(t.currentTool=null,n)for(var a=0;a<n.data.length;a++)n.data[a].active=!1;Object(C.setToolCursor)(this.element,this.svgCursor),v.default.cornerstone.updateImage(this.element)}},{key:"_limitCursorRadiusCanvas",value:function(e,t){return this._limitCursorRadius(e,t,!0)}},{key:"_limitCursorRadiusImage",value:function(e,t){return this._limitCursorRadius(e,t,!1)}},{key:"_limitCursorRadius",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.element,o=e.image,r=this.configuration,i=Object(x.getToolState)(a,this.referencedToolName),l=i.data[r.currentTool],s=1;if(n){var u=v.default.cornerstone.pixelToCanvas(a,{x:0,y:0}),d=v.default.cornerstone.pixelToCanvas(a,{x:o.width,y:o.height}),c=(d.x-u.x)*(d.y-u.y);s=c/(o.width*o.height)}var f=l.area*s,g=Math.pow(f/Math.PI,.5);return Math.min(t,g)}},{key:"_getClosestFreehandToolOnElement",value:function(e,t){var n=Object(T.default)(e,this.referencedToolName),a=Object(x.getToolState)(e,this.referencedToolName);if(a){for(var o=a.data,r=t.currentPoints.image,i={distance:1/0,toolIndex:null},l=0;l<o.length;l++){var s=n.distanceFromPoint(e,o[l],r);-1!==s&&s<i.distance&&(i.distance=s,i.toolIndex=l)}return i.toolIndex}}},{key:"_getInsertPosition",value:function(e,t,n){var a,o=this._sculptData,r=o.points,i=o.toolSize,l=o.mousePoint,s=o.image,u={x:(r[t].x+r[n].x)/2,y:(r[t].y+r[n].y)/2},d=v.default.cornerstoneMath.point.distance(l,u);if(d<i){var c={x:(u.x-l.x)/d,y:(u.y-l.y)/d};a={x:l.x+i*c.x,y:l.y+i*c.y}}else a=u;return Object(y.clipToBox)(a,s),a}},{key:"minSpacing",get:function(){return this.configuration.minSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter minSpacing to a value other than a number.");this.configuration.minSpacing=e}},{key:"maxSpacing",get:function(){return this.configuration.maxSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.");this.configuration.maxSpacing=e}},{key:"showCursorOnHover",get:function(){return this.configuration.showCursorOnHover},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.");this.configuration.showCursorOnHover=e,v.default.cornerstone.updateImage(this.element)}},{key:"limitRadiusOutsideRegion",get:function(){return this.configuration.limitRadiusOutsideRegion},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.");this.configuration.limitRadiusOutsideRegion=e,v.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeAlpha",get:function(){return this.configuration.hoverCursorFadeAlpha},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.");e=Math.max(Math.min(e,1),0),this.configuration.hoverCursorFadeAlpha=e,v.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeDistance",get:function(){return this.configuration.hoverCursorFadeDistance},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.");e=Math.max(e,1),this.configuration.hoverCursorFadeDistance=e,v.default.cornerstone.updateImage(this.element)}}],[{key:"_getCorrectedPair",value:function(e,t){var n=[e[0]-t,e[1]-t];return n[1]<0&&(n[1]=0),n}},{key:"_getNextHandleIndex",value:function(e,t){return e===t-1?0:e+1}},{key:"_getPreviousHandleIndex",value:function(e,t){return 0===e?t-1:e-1}},{key:"_getNextHandleIndexBeforeInsert",value:function(e,t){return e===t?0:e}}]),t}(w.default);function S(){return{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},minSpacing:1,currentTool:null,dragColor:p.default.getActiveColor(),hoverColor:p.default.getToolColor(),showCursorOnHover:!0,limitRadiusOutsideRegion:!0,hoverCursorFadeAlpha:.5,hoverCursorFadeDistance:1.2}}},"./tools/MagnifyTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./externalModules.js"),v=n("./drawing/index.js"),p=n("./tools/base/BaseTool.js"),b=n("./store/setToolCursor.js"),j=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Magnify",supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:300,magnificationLevel:2},svgCursor:j.magnifyCursor};return(e=s()(this,d()(t).call(this,n,a))).zoomCanvas=void 0,e.zoomElement=void 0,e.activeCallback=e._createMagnificationCanvas.bind(f()(e)),e.enabledCallback=e._createMagnificationCanvas.bind(f()(e)),e.disabledCallback=e._destroyMagnificationCanvas.bind(f()(e)),e.postTouchStartCallback=e._addMagnifyingGlass.bind(f()(e)),e.touchDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.touchEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.touchDragEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.postMouseDownCallback=e._addMagnifyingGlass.bind(f()(e)),e.mouseDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.mouseUpCallback=e._removeMagnifyingGlass.bind(f()(e)),e.mouseClickCallback=e._removeMagnifyingGlass.bind(f()(e)),e.newImageCallback=e._drawMagnificationTool.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_addMagnifyingGlass",value:function(e){var t=this;this._removeZoomElement(),this._drawZoomedElement(e),window.requestAnimationFrame((function(){return t._drawMagnificationTool(e)})),Object(b.hideToolCursor)(e.detail.element),e.preventDefault(),e.stopPropagation()}},{key:"_updateMagnifyingGlass",value:function(e){this._drawMagnificationTool(e),e.preventDefault(),e.stopPropagation()}},{key:"_removeMagnifyingGlass",value:function(e){var t=e.detail.element;Object(b.setToolCursor)(this.element,this.svgCursor),t.querySelector(".magnifyTool").style.display="none",this._removeZoomElement()}},{key:"_drawMagnificationTool",value:function(e){var t=e.detail.element,n=t.querySelector(".magnifyTool");if(n||this._createMagnificationCanvas(t),void 0!==this.zoomCanvas){var a=t.querySelector("canvas:not(.magnifyTool)"),o=Object(v.getNewContext)(n),r=h.default.cornerstone.pixelToCanvas(e.detail.element,e.detail.currentPoints.image),i=Math.min(this.configuration.magnifySize,a.width,a.height),l=this.configuration.magnificationLevel;n.width=i,n.height=i,r.x=Math.max(r.x,.5*i/l),r.x=Math.min(r.x,a.width-.5*i/l),r.y=Math.max(r.y,.5*i/l),r.y=Math.min(r.y,a.height-.5*i/l);var s={x:r.x*l-.5*i,y:r.y*l-.5*i};s.x=Math.max(s.x,0),s.y=Math.max(s.y,0),o.drawImage(this.zoomCanvas,s.x,s.y,i,i,0,0,i,i);var u=e.detail.isTouchEvent?120:0,d={top:Math.max(r.y-.5*i-u,0),left:Math.max(r.x-.5*i,0)},c=n.getBoundingClientRect();d.top=Math.min(d.top,a.height-c.height),d.left=Math.min(d.left,a.width-c.width),n.style.top="".concat(d.top,"px"),n.style.left="".concat(d.left,"px"),n.style.display="block"}}},{key:"_drawZoomedElement",value:function(e){var t=e.detail.element,n=e.detail.enabledElement;void 0===n&&(n=h.default.cornerstone.getEnabledElement(t));var a=this.configuration.magnificationLevel,o=n.canvas,r=n.image;this.zoomElement||(this.zoomElement=document.createElement("div"),this.zoomElement.width=o.width*a,this.zoomElement.height=o.height*a,h.default.cornerstone.enable(this.zoomElement,n.options));var i=h.default.cornerstone.getEnabledElement(this.zoomElement),l=h.default.cornerstone.getViewport(n.element);this.zoomCanvas=i.canvas,this.zoomCanvas.width=o.width*a,this.zoomCanvas.height=o.height*a,i.viewport=Object.assign({},l),l.scale*=a,h.default.cornerstone.displayImage(this.zoomElement,r),h.default.cornerstone.setViewport(this.zoomElement,l)}},{key:"_removeZoomElement",value:function(){void 0!==this.zoomElement&&(h.default.cornerstone.disable(this.zoomElement),this.zoomElement=void 0,this.zoomCanvas=void 0)}},{key:"_createMagnificationCanvas",value:function(e){if(null===e.querySelector(".magnifyTool")){var t=document.createElement("canvas");t.classList.add("magnifyTool"),t.width=this.configuration.magnifySize,t.height=this.configuration.magnifySize,t.style.position="absolute",t.style.display="none",e.appendChild(t)}}},{key:"_destroyMagnificationCanvas",value:function(e){var t=e.querySelector(".magnifyTool");t&&e.removeChild(t)}}]),t}(p.default)},"./tools/OrientationMarkersTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),h=n("./orientation/index.js"),v=n("./drawing/index.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/drawTextBox.js"),j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"OrientationMarkers",configuration:{drawAllMarkers:!0},mixins:["enabledOrDisabledBinaryTool"]};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){var t=g.default.cornerstone;t.getEnabledElement(e).image&&t.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(v.getNewContext)(t.canvasContext.canvas),a=t.element,o=T(a);if(o){var r=w(a,o),i=p.default.getToolColor(),l={top:Object(b.textBoxWidth)(n,o.top,0),left:Object(b.textBoxWidth)(n,o.left,0),right:Object(b.textBoxWidth)(n,o.right,0),bottom:Object(b.textBoxWidth)(n,o.bottom,0),height:Object(b.textBoxWidth)(n,"M",0)};x(n,o,r,l,i),this.configuration.drawAllMarkers&&y(n,o,r,l,i)}}}]),t}(m.default),x=function(e,t,n,a,o){Object(b.default)(e,t.top,n.top.x-a.top/2,n.top.y,o),Object(b.default)(e,t.left,n.left.x-a.left/2,n.left.y,o)},y=function(e,t,n,a,o){Object(b.default)(e,t.right,n.right.x-a.right,n.right.y,o),Object(b.default)(e,t.bottom,n.bottom.x-a.bottom/2,n.bottom.y-a.height,o)},T=function(e){var t=g.default.cornerstone,n=t.getEnabledElement(e),a=t.metaData.get("imagePlaneModule",n.image.imageId);if(a&&a.rowCosines&&a.columnCosines){var o=h.default.getOrientationString(a.rowCosines),r=h.default.getOrientationString(a.columnCosines),i=h.default.invertOrientationString(o);return{top:h.default.invertOrientationString(r),bottom:r,left:i,right:o}}},w=function(e){var t=g.default.cornerstone.getEnabledElement(e);return{top:g.default.cornerstone.pixelToCanvas(e,{x:t.image.width/2,y:5}),bottom:g.default.cornerstone.pixelToCanvas(e,{x:t.image.width/2,y:t.image.height-15}),left:g.default.cornerstone.pixelToCanvas(e,{x:5,y:t.image.height/2}),right:g.default.cornerstone.pixelToCanvas(e,{x:t.image.width-10,y:t.image.height/2})}}},"./tools/OverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./store/index.js"),m=n("./externalModules.js"),h=n("./tools/base/BaseTool.js"),v=g.modules.globalConfiguration,p=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Overlay",configuration:{},mixins:["enabledOrDisabledBinaryTool"]},r=Object.assign(a,n);return(e=s()(this,d()(t).call(this,r))).initialConfiguration=r,e}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){m.default.cornerstone.getEnabledElement(e).image&&m.default.cornerstone.updateImage(e)}},{key:"setupRender",value:function(e){if(e){var t=m.default.cornerstone.metaData.get("overlayPlaneModule",e.imageId);if(t&&t.overlays&&t.overlays.length)return t}}},{key:"setupViewport",value:function(e){if(void 0===e.overlayColor&&(e.overlayColor=v.configuration.overlayColor||"white"),!1!==e.overlayColor)return!0}},{key:"renderToolData",value:function(e){var t=e.detail,n=t.enabledElement,a=t.image,o=t.viewport,r=t.canvasContext,i=this.setupRender(a);if(t&&n&&i&&this.setupViewport(o)){var l=a.columns,s=a.rows;i.overlays.forEach((function(e){if(!1!==e.visible){var t=document.createElement("canvas");t.width=l,t.height=s;var n=t.getContext("2d");n.fillStyle=e.fillStyle||o.overlayColor,"R"===e.type&&(n.fillRect(0,0,t.width,t.height),n.globalCompositeOperation="xor");for(var a=0,i=0;i<e.rows;i++)for(var u=0;u<e.columns;u++)e.pixelData[a++]>0&&n.fillRect(u,i,1,1);var d=!isNaN(parseFloat(e.x))&&isFinite(e.x)?e.x:0,c=!isNaN(parseFloat(e.y))&&isFinite(e.y)?e.y:0;r.drawImage(t,d,c)}}))}}}]),t}(h.default)},"./tools/PanMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./externalModules.js"),v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"PanMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{touchPointers:2}};return(e=s()(this,d()(t).call(this,n,a))).multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport;if(t.numPointers===this.configuration.touchPointers){var o=this._getTranslation(t);this._applyTranslation(a,o),h.default.cornerstone.setViewport(n,a)}}},{key:"_getTranslation",value:function(e){var t=e.viewport,n=e.image,a=e.deltaPoints,o=t.scale,r=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?o*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(r*=n.rowPixelSpacing/n.columnPixelSpacing),{x:a.page.x/o,y:a.page.y/r}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/PanTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./tools/cursors/index.js"),b=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Pan",supportedInteractionTypes:["Mouse","Touch"],svgCursor:p.panCursor};return(e=s()(this,d()(t).call(this,n,a))).touchDragCallback=e._dragCallback.bind(f()(e)),e.mouseDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,o=this._getTranslation(t);this._applyTranslation(a,o),h.default.cornerstone.setViewport(n,a)}},{key:"_getTranslation",value:function(e){var t=e.viewport,n=e.image,a=e.deltaPoints,o=t.scale,r=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?o*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(r*=n.rowPixelSpacing/n.columnPixelSpacing),{x:a.page.x/o,y:a.page.y/r}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(v.default)},"./tools/ReferenceLinesTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C}));var a=n("../node_modules/@babel/runtime/regenerator/index.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/createClass.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(g),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),v=n.n(h),p=n("./externalModules.js"),b=n("./tools/base/BaseTool.js"),j=n("./drawing/index.js"),x=n("./tools/referenceLines/renderActiveReferenceLine.js"),y=n("./util/wait.js"),T=n("./util/logger.js"),w=Object(T.getLogger)("tools:ReferenceLinesTool"),C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,t);var a={name:"ReferenceLines",mixins:["enabledOrDisabledBinaryTool"],configuration:{renderer:x.default}};return(e=f()(this,m()(t).call(this,n,a))).renderer=null,e.synchronizationContext=null,e}var n;return v()(t,e),d()(t,[{key:"enabledCallback",value:(n=i()(o.a.mark((function e(t){var n,a,r,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},a=n.synchronizationContext,r=this.configuration.renderer,e.next=4,Object(y.waitForEnabledElementImageToLoad)(t);case 4:if(e.sent&&r&&a){e.next=8;break}return w.warn("Unable to enable ".concat(this.name,". Exiting enable callback. Tool will be enabled, but will not render.")),e.abrupt("return");case 8:this.renderer=r,this.synchronizationContext=a,this.forceImageUpdate(t);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){p.default.cornerstone.getEnabledElement(e).image&&p.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=this,n=e.detail;if(this.renderer&&this.synchronizationContext){var a=this.synchronizationContext.getSourceElements(),o=Object(j.getNewContext)(n.canvasContext.canvas);p.default.cornerstone.setToPixelCoordinateSystem(n.enabledElement,o),a.forEach((function(a){a!==e.currentTarget&&t.renderer(o,n,e.currentTarget,a)}))}}}]),t}(b.default)},"./tools/RotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),h=n("./util/angleBetweenPoints.js"),v=n("./tools/cursors/index.js"),p=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Rotate",strategies:{default:b,horizontal:j,vertical:x},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{roundAngles:!1,flipHorizontal:!1,flipVertical:!1,rotateScale:1},svgCursor:v.rotateCursor};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function(e){this.dragCallback(e)}},{key:"mouseDragCallback",value:function(e){this.dragCallback(e)}},{key:"postMouseDownCallback",value:function(e){this.initialRotation=e.detail.viewport.rotation}},{key:"dragCallback",value:function(e){e.detail.viewport.initialRotation=this.initialRotation,this.applyActiveStrategy(e),g.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(m.default);function b(e){var t=this.configuration,n=t.roundAngles,a=t.rotateScale,o=e.detail,r=o.element,i=o.viewport,l=o.startPoints,s=o.currentPoints,u=i.initialRotation?i.initialRotation:i.rotation,d=r.getBoundingClientRect(r),c=r.clientWidth,f=r.clientHeight,g=i.scale,m=i.translation,v={x:d.left+c/2+m.x*g,y:d.top+f/2+m.y*g},p=Object(h.default)(v,l.client,s.client);p.angle*=a,n&&(p.angle=Math.ceil(p.angle)),p.direction<0&&(p.angle=-p.angle),i.rotation=u+p.angle}function j(e){var t=this.configuration,n=t.roundAngles,a=t.flipHorizontal,o=t.rotateScale,r=e.detail,i=r.viewport,l=r.startPoints,s=r.currentPoints,u=i.initialRotation,d=l.client.x,c=(s.client.x-d)*o;n&&(c=Math.round(Math.abs(c))*(c>0?1:-1)),a&&(c=-c),i.rotation=u+c}function x(e){var t=this.configuration,n=t.roundAngles,a=t.flipVertical,o=t.rotateScale,r=e.detail,i=r.viewport,l=r.startPoints,s=r.currentPoints,u=i.initialRotation,d=l.client.y,c=(s.client.y-d)*o;n&&(c=Math.round(Math.abs(c))*(c>0?1:-1)),a&&(c=-c),i.rotation=u+c}},"./tools/RotateTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"RotateTouch",supportedInteractionTypes:["TouchRotate"]};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchRotateCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,o=t.rotation;a.rotation+=o,g.default.cornerstone.setViewport(n,a)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/ScaleOverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),h=n("./drawing/index.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./util/logger.js"),j=Object(b.getLogger)("tools:ScaleOverlayTool"),x=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"ScaleOverlay",configuration:{minorTickLength:12.5,majorTickLength:25},mixins:["enabledOrDisabledBinaryTool"]};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){g.default.cornerstone.getEnabledElement(e).image&&g.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(h.getNewContext)(t.canvasContext.canvas),a=t.image,o=t.viewport,r=t.element,i=a.rowPixelSpacing,l=a.columnPixelSpacing,s=g.default.cornerstone.metaData.get("imagePlaneModule",a.imageId);if(s&&(i=s.rowPixelSpacing||s.rowImagePixelSpacing,l=s.columnPixelSpacing||s.colImagePixelSpacing),i&&l){var u={width:n.canvas.width,height:n.canvas.height},d=10/i*o.scale,c=10/l*o.scale,f=y(u,.25,.05),m=y(u,.05,.15);if(u.width&&u.height&&f&&m){var b=p.default.getToolColor(),x=v.default.getToolWidth(),C=Object.assign({},{hscaleBounds:f,vscaleBounds:m,verticalMinorTick:d,horizontalMinorTick:c,verticalLine:{start:{x:m.bottomRight.x,y:m.topLeft.y},end:{x:m.bottomRight.x,y:m.bottomRight.y}},horizontalLine:{start:{x:f.topLeft.x,y:f.bottomRight.y},end:{x:f.bottomRight.x,y:f.bottomRight.y}},color:b,lineWidth:x},this.configuration);Object(h.draw)(n,(function(e){Object(h.setShadow)(e,C),Object(h.drawLine)(e,r,C.verticalLine.start,C.verticalLine.end,{color:C.color,lineWidth:C.lineWidth},"canvas"),T(e,r,C),Object(h.drawLine)(e,r,C.horizontalLine.start,C.horizontalLine.end,{color:C.color,lineWidth:C.lineWidth},"canvas"),w(e,r,C)}))}}else j.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name,"'s renderToolData"))}}]),t}(m.default),y=function(e,t,n){var a=t*Math.min(1e3,e.width),o=n*Math.min(1e3,e.height),r={left:a,top:o,width:e.width-2*a,height:e.height-2*o};return{topLeft:{x:r.left,y:r.top},bottomRight:{x:r.left+r.width,y:r.top+r.height}}},T=function(e,t,n){for(var a=0;n.verticalLine.start.y+a*n.verticalMinorTick<=n.vscaleBounds.bottomRight.y;){var o=n.color,r=n.lineWidth,i={x:n.verticalLine.start.x,y:n.verticalLine.start.y+a*n.verticalMinorTick},l={x:0,y:n.verticalLine.start.y+a*n.verticalMinorTick};l.x=a%5==0?n.verticalLine.start.x-n.majorTickLength:n.verticalLine.start.x-n.minorTickLength,Object(h.drawLine)(e,t,i,l,{color:o,lineWidth:r},"canvas"),a++}},w=function(e,t,n){for(var a=0;n.horizontalLine.start.x+a*n.horizontalMinorTick<=n.hscaleBounds.bottomRight.x;){var o=n.color,r=n.lineWidth,i={x:n.horizontalLine.start.x+a*n.horizontalMinorTick,y:n.horizontalLine.start.y},l={x:n.horizontalLine.start.x+a*n.horizontalMinorTick,y:0};l.y=a%5==0?n.horizontalLine.start.y-n.majorTickLength:n.horizontalLine.start.y-n.minorTickLength,Object(h.drawLine)(e,t,i,l,{color:o,lineWidth:r},"canvas"),a++}}},"./tools/StackScrollMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./tools/base/BaseTool.js"),m=n("./util/scroll.js"),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"StackScrollMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{loop:!1,allowSkipping:!0,invert:!1}};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.direction,a=t.element,o=this.configuration,r=o.loop,i=o.allowSkipping,l=o.invert?-n:n;Object(m.default)(a,l,r,i)}}]),t}(g.default)},"./tools/StackScrollMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./tools/base/BaseTool.js"),v=n("./util/scroll.js"),p=n("./stateManagement/toolState.js"),b=n("./toolOptions.js"),j=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"StackScrollMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{loop:!1,allowSkipping:!0,touchPointers:3}};return(e=s()(this,d()(t).call(this,n,a))).multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail;if(t.numPointers===this.configuration.touchPointers){var n=t.element,a=t.deltaPoints,o=this.configuration,r=o.loop,i=o.allowSkipping,l=Object(b.getToolOptions)(this.name,n),s=this._getPixelPerImage(n),u=this._getDeltaY(n,a.page.y);if(!s)return;if(Math.abs(u)>=s){var d=Math.round(u/s);Object(v.default)(n,d,r,i),l.deltaY=u%s}else l.deltaY=u;Object(b.setToolOptions)(this.name,n,l)}}},{key:"_getDeltaY",value:function(e,t){return(Object(b.getToolOptions)(this.name,e).deltaY||0)+t}},{key:"_getPixelPerImage",value:function(e){var t=Object(p.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];return this.configuration.stackScrollSpeed||Math.max(2,e.offsetHeight/Math.max(n.imageIds.length,8))}}}]),t}(h.default)},"./tools/StackScrollTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./tools/base/BaseTool.js"),v=n("./util/scroll.js"),p=n("./stateManagement/toolState.js"),b=n("./toolOptions.js"),j=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"StackScroll",supportedInteractionTypes:["Mouse","Touch"],configuration:{loop:!1,allowSkipping:!0},svgCursor:j.stackScrollCursor};return(e=s()(this,d()(t).call(this,n,a))).mouseDragCallback=e._dragCallback.bind(f()(e)),e.touchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.deltaPoints,o=this.configuration,r=o.loop,i=o.allowSkipping,l=Object(b.getToolOptions)(this.name,n),s=this._getPixelPerImage(n),u=this._getDeltaY(n,a.page.y);if(s){if(Math.abs(u)>=s){var d=Math.round(u/s);Object(v.default)(n,d,r,i),l.deltaY=u%s}else l.deltaY=u;Object(b.setToolOptions)(this.name,n,l)}}},{key:"_getDeltaY",value:function(e,t){return(Object(b.getToolOptions)(this.name,e).deltaY||0)+t}},{key:"_getPixelPerImage",value:function(e){var t=Object(p.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];return this.configuration.stackScrollSpeed||Math.max(2,e.offsetHeight/Math.max(n.imageIds.length,8))}}}]),t}(h.default)},"./tools/WwwcRegionTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./drawing/index.js"),b=n("./util/clip.js"),j=n("./util/getLuminance.js"),x=n("./stateManagement/toolColors.js"),y=n("./tools/cursors/index.js"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"WwwcRegion",supportedInteractionTypes:["Mouse","Touch"],configuration:{minWindowWidth:10},svgCursor:y.wwwcRegionCursor};return(e=s()(this,d()(t).call(this,n,a)))._resetHandles(),e.postTouchStartCallback=e._startOutliningRegion.bind(f()(e)),e.touchDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.touchEndCallback=e._applyStrategy.bind(f()(e)),e.postMouseDownCallback=e._startOutliningRegion.bind(f()(e)),e.mouseClickCallback=e._startOutliningRegion.bind(f()(e)),e.mouseDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseMoveCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseUpCallback=e._applyStrategy.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.element,o=x.default.getColorIfActive({active:!0}),r=Object(p.getNewContext)(n.canvasContext.canvas);Object(p.draw)(r,(function(e){Object(p.drawRect)(e,a,t.handles.start,t.handles.end,{color:o})}))}},{key:"_startOutliningRegion",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.image;return w(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),h.default.cornerstone.updateImage(t),!0}},{key:"_setHandlesAndUpdate",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.image;this.handles.end=n,h.default.cornerstone.updateImage(t)}},{key:"_applyStrategy",value:function(e){w(this.handles.start)||w(this.handles.end)||(e.detail.handles=this.handles,C(e,this.configuration),this._resetHandles())}},{key:"_resetHandles",value:function(){this.handles={start:{},end:{}}}}]),t}(v.default),w=function(e){return 0===Object.keys(e).length&&e.constructor===Object},C=function(e,t){var n=e.detail,a=n.image,o=n.element,r=e.detail.handles,i=r.start,l=r.end,s=Math.min(i.x,l.x),u=Math.min(i.y,l.y),d=Math.abs(i.x-l.x),c=Math.abs(i.y-l.y);s=Object(b.default)(s,0,a.width),u=Object(b.default)(u,0,a.height),d=Math.floor(Math.min(d,Math.abs(a.width-s))),c=Math.floor(Math.min(c,Math.abs(a.height-u)));var f=Object(j.default)(o,s,u,d,c),g=O(f,a.minPixelValue,a.maxPixelValue),m=n.viewport;void 0===t.minWindowWidth&&(t.minWindowWidth=10),m.voi.windowWidth=Math.max(Math.abs(g.max-g.min),t.minWindowWidth),m.voi.windowCenter=g.mean,m.voiLUT=void 0,h.default.cornerstone.setViewport(o,m),h.default.cornerstone.updateImage(o)},O=function(e,t,n){var a=e.length,o=n,r=t,i=0;if(a<2)return{min:o,max:r,mean:(t+n)/2};for(var l=0;l<a;l++){var s=e[l];o=Math.min(o,s),r=Math.max(r,s),i+=s}return{min:o,max:r,mean:i/a}}},"./tools/WwwcTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),h=n("./tools/cursors/index.js"),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Wwwc",strategies:{basicLevelingStrategy:p},supportedInteractionTypes:["Mouse","Touch"],configuration:{orientation:0},svgCursor:h.wwwcCursor};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseDragCallback",value:function(e){this.applyActiveStrategy(e),g.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}},{key:"touchDragCallback",value:function(e){e.stopImmediatePropagation(),this.applyActiveStrategy(e),g.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(m.default);function p(e){var t=this.configuration.orientation,n=e.detail,a=(n.image.maxPixelValue*n.image.slope+n.image.intercept-(n.image.minPixelValue*n.image.slope+n.image.intercept))/1024,o=n.deltaPoints.page.x*a,r=n.deltaPoints.page.y*a;0===t?(n.viewport.voi.windowWidth+=o,n.viewport.voi.windowCenter+=r):(n.viewport.voi.windowWidth+=r,n.viewport.voi.windowCenter+=o),n.viewport.voiLUT=void 0}},"./tools/ZoomMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),h=n("./util/zoom/index.js"),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"ZoomMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{minScale:.25,maxScale:20,invert:!1}};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,o=t.spinY,r=this.configuration,i=r.invert,l=r.maxScale,s=r.minScale,u=i?o/4:-o/4,d=Object(h.changeViewportScale)(a,u,{maxScale:l,minScale:s});g.default.cornerstone.setViewport(n,d)}}]),t}(m.default)},"./tools/ZoomTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),h=n("./util/clip.js"),v=n("./util/zoom/index.js"),p=n("./tools/cursors/index.js"),b=v.default.correctShift,j=v.default.changeViewportScale,x=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Zoom",strategies:{default:T,translate:w,zoomToCenter:C},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{invert:!1,preventZoomOutsideImage:!1,minScale:.25,maxScale:20},svgCursor:p.zoomCursor};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function(e){y.call(this,e)}},{key:"mouseDragCallback",value:function(e){y.call(this,e)}}]),t}(m.default),y=function(e){if(!e.detail.deltaPoints.page.y)return!1;this.applyActiveStrategy(e,this.configuration),g.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)};function T(e){var t=this.configuration,n=t.invert,a=t.maxScale,o=t.minScale,r=e.detail.deltaPoints.page.y,i=n?-r/100:r/100,l=e.detail,s=l.element,u=l.viewport,d=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],c=d[0],f=d[1],m=d[2],h=d[3],v=j(u,i,{maxScale:a,minScale:o});g.default.cornerstone.setViewport(s,v);var p=g.default.cornerstone.pageToPixel(s,c,f),x={x:m-p.x,y:h-p.y};x=b(x,v),u.translation.x-=x.x,u.translation.y-=x.y}function w(e){var t=this.configuration,n=t.invert,a=t.preventZoomOutsideImage,o=t.maxScale,r=t.minScale,i=e.detail.deltaPoints.page.y,l=n?-i/100:i/100,s=e.detail.image,u=e.detail.viewport,d=[e.detail.startPoints.image.x,e.detail.startPoints.image.y],c=d[0],f=d[1],g=j(u,l,{maxScale:o,minScale:r}),m={x:0,y:0},v=.01;if(l<0)g.scale<3&&(Math.abs(g.translation.x)<v?g.translation.x=0:m.x=g.translation.x/8,Math.abs(g.translation.y)<v?g.translation.y=0:m.y=g.translation.y/8);else{a&&Object(h.clipToBox)(e.detail.startPoints.image,s);var p={x:s.width/2-c,y:s.height/2-f};p=b(p,g);var x={x:g.translation.x-p.x,y:g.translation.y-p.y};Math.abs(x.x)<v?g.translation.x=p.x:m.x=x.x/8,Math.abs(x.y)<v?g.translation.y=p.y:m.y=x.y/8}g.translation.x-=m.x,g.translation.y-=m.y}function C(e){var t=this.configuration,n=t.invert,a=t.maxScale,o=t.minScale,r=e.detail.deltaPoints.page.y,i=n?-r/100:r/100,l=e.detail.viewport;j(l,i,{maxScale:a,minScale:o})}},"./tools/ZoomTouchPinchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),h=n("./util/zoom/index.js").default.correctShift,v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"ZoomTouchPinch",supportedInteractionTypes:["TouchPinch"],configuration:{minScale:.25,maxScale:20}};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchPinchCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,o=t.scaleChange,r=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],i=r[0],l=r[1],s=r[2],u=r[3],d=this.configuration,c=d.maxScale,f=d.minScale;a.scale+=o*a.scale,c&&a.scale>c?a.scale=c:f&&a.scale<f&&(a.scale=f),g.default.cornerstone.setViewport(n,a);var m=g.default.cornerstone.pageToPixel(n,i,l),v={x:s-m.x,y:u-m.y};v=h(v,a),a.translation.x-=v.x,a.translation.y-=v.y,g.default.cornerstone.setViewport(n,a)}}]),t}(m.default)},"./tools/annotation/AngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./manipulators/index.js"),j=n("./drawing/index.js"),x=n("./drawing/drawLinkedTextBox.js"),y=n("./drawing/drawTextBox.js"),T=n("./drawing/drawHandles.js"),w=n("./util/lineSegDistance.js"),C=n("./util/roundToDecimal.js"),O=n("./tools/cursors/index.js"),E=n("./util/triggerEvent.js"),M=n("./events.js"),I=n("./util/getPixelSpacing.js"),S=n("./util/throttle.js"),P=n("./store/index.js"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Angle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:O.angleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=s()(this,d()(t).call(this,n,a))).preventNewMeasurement=!1,e.throttledUpdateCachedStats=Object(S.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&(Object(w.default)(e,t.handles.start,t.handles.middle,n)<25||Object(w.default)(e,t.handles.middle,t.handles.end,n)<25)}},{key:"updateCachedStats",value:function(e,t,n){var a=L(e,n.handles.middle,n.handles.start),o=L(e,n.handles.end,n.handles.middle),r=L(e,n.handles.end,n.handles.start),i=D(a),l=D(o),s=D(r),u=Math.acos((Math.pow(i,2)+Math.pow(l,2)-Math.pow(s,2))/(2*i*l));u*=180/Math.PI,n.rAngle=Object(C.default)(u,2),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.enabledElement,o=this.configuration,r=o.handleRadius,i=o.drawHandlesOnHover,l=o.hideHandlesIfMoving,s=o.renderDashed,u=Object(h.getToolState)(e.currentTarget,this.name),d=Object(P.getModule)("globalConfiguration").configuration.lineDash;if(u)for(var c=Object(j.getNewContext)(n.canvasContext.canvas),f=n.image,m=n.element,b=Object(I.default)(f),w=b.rowPixelSpacing,C=b.colPixelSpacing,O=v.default.getToolWidth(),E=function(e){var o=u.data[e];if(!1===o.visible)return"continue";Object(j.draw)(c,(function(e){Object(j.setShadow)(e,t.configuration);var u=p.default.getColorIfActive(o),c=g.default.cornerstone.pixelToCanvas(n.element,o.handles.start),h=g.default.cornerstone.pixelToCanvas(n.element,o.handles.middle),v={color:u};s&&(v.lineDash=d),Object(j.drawJoinedLines)(e,n.element,o.handles.start,[o.handles.middle,o.handles.end],v);var b={color:u,handleRadius:r,drawHandlesIfActive:i,hideHandlesIfMoving:l};if(t.configuration.drawHandles&&Object(T.default)(e,n,o.handles,b),!0===o.invalidated&&(o.rAngle?t.throttledUpdateCachedStats(f,m,o):t.updateCachedStats(f,m,o)),o.rAngle){var E,M=function(e,t,n){var a=t&&n?"":" (isotropic)";return e.rAngle.toString()+String.fromCharCode(parseInt("00B0",16))+a}(o,w,C);if(!o.handles.textBox.hasMoved){E={x:h.x,y:h.y};var I=Object(y.textBoxWidth)(e,M,5);h.x<c.x?E.x-=15+I+10:E.x+=15;var P=g.default.cornerstone.internal.getTransform(a);P.invert();var _=P.transformPoint(E.x,E.y);o.handles.textBox.x=_.x,o.handles.textBox.y=_.y}Object(x.default)(e,n.element,o.handles.textBox,M,o.handles,S,u,O,0,!0)}}))},M=0;M<u.data.length;M++)E(M);function S(e){return[e.start,e.middle,e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this;if(!this.preventNewMeasurement){this.preventNewMeasurement=!0,e.preventDefault(),e.stopPropagation();var a=e.detail,o=this.createNewMeasurement(a),r=e.detail.element;Object(h.addToolState)(r,this.name,o),g.default.cornerstone.updateImage(r),Object(b.moveNewHandle)(a,this.name,o,o.handles.middle,this.options,t,(function(e){if(o.active=!1,!e)return Object(h.removeToolState)(r,n.name,o),void(n.preventNewMeasurement=!1);o.handles.end.active=!0,g.default.cornerstone.updateImage(r),Object(b.moveNewHandle)(a,n.name,o,o.handles.end,n.options,t,(function(e){e?(o.active=!1,g.default.cornerstone.updateImage(r)):Object(h.removeToolState)(r,n.name,o),n.preventNewMeasurement=!1,g.default.cornerstone.updateImage(r);var t={toolName:n.name,toolType:n.name,element:r,measurementData:o};Object(E.default)(r,M.default.MEASUREMENT_COMPLETED,t)}))}))}}}]),t}(m.default);function D(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function L(e,t,n){var a=Object(I.default)(e),o=a.rowPixelSpacing,r=a.colPixelSpacing;return{x:(t.x-n.x)*(r||1),y:(t.y-n.y)*(o||1)}}},"./tools/annotation/ArrowAnnotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),h=n("./events.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/textStyle.js"),b=n("./stateManagement/toolColors.js"),j=n("./manipulators/index.js"),x=n("./util/pointInsideBoundingBox.js"),y=n("./util/lineSegDistance.js"),T=n("./util/triggerEvent.js"),w=n("./stateManagement/toolState.js"),C=n("./drawing/drawLinkedTextBox.js"),O=n("./drawing/index.js"),E=n("./drawing/drawArrow.js"),M=n("./drawing/drawHandles.js"),I=n("./drawing/drawTextBox.js"),S=n("./tools/cursors/index.js"),P=n("./store/index.js"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"ArrowAnnotate",supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextCallback:D,changeTextCallback:L,drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,arrowFirst:!0,renderDashed:!1,allowEmptyLabel:!1},svgCursor:S.arrowAnnotateCursor};return(e=s()(this,d()(t).call(this,n,a))).preventNewMeasurement=!1,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&Object(y.default)(e,t.handles.start,t.handles.end,n)<25}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.element,o=n.enabledElement,r=this.configuration,i=r.handleRadius,l=r.drawHandlesOnHover,s=r.hideHandlesIfMoving,u=r.renderDashed,d=Object(w.getToolState)(a,this.name);if(d){var c,f=e.detail.canvasContext.canvas,m=Object(O.getNewContext)(f),h=v.default.getToolWidth();u&&(c=Object(P.getModule)("globalConfiguration").configuration.lineDash);for(var j=function(n){var r=d.data[n];if(!1===r.visible)return"continue";Object(O.draw)(m,(function(n){Object(O.setShadow)(n,t.configuration);var u=b.default.getColorIfActive(r),d=g.default.cornerstone.pixelToCanvas(a,r.handles.start),f=g.default.cornerstone.pixelToCanvas(a,r.handles.end);t.configuration.arrowFirst?Object(E.default)(n,f,d,u,h,c):Object(E.default)(n,d,f,u,h,c);var m={color:u,handleRadius:i,drawHandlesIfActive:l,hideHandlesIfMoving:s};t.configuration.drawHandles&&Object(M.default)(n,e.detail,r.handles,m);var v=function(e){return e.text}(r);if(v&&""!==v){var j=Object(I.textBoxWidth)(n,v,5),x=p.default.getFontSize()+10,T=Math.max(j,x)/2+5;if(f.x<d.x&&(T=-T),!r.handles.textBox.hasMoved){var w;w=t.configuration.arrowFirst?{x:f.x-j/2+T,y:f.y-x/2}:{x:d.x-j/2-T,y:d.y-x/2};var S=g.default.cornerstone.internal.getTransform(o);S.invert();var P=S.transformPoint(w.x,w.y);r.handles.textBox.x=P.x,r.handles.textBox.y=P.y}Object(C.default)(n,a,r.handles.textBox,v,r.handles,y,u,h,0,!1)}}))},x=0;x<d.data.length;x++)j(x)}function y(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this,a=e.detail.element,o=this.createNewMeasurement(e),r=this.configuration.allowEmptyLabel;Object(w.addToolState)(a,this.name,o),g.default.cornerstone.updateImage(a),Object(j.moveNewHandle)(e.detail,this.name,o,o.handles.end,this.options,t,(function(t){t?void 0===o.text&&n.configuration.getTextCallback((function(e){if(e||r){o.text=e,o.active=!1;var t={toolName:n.name,toolType:n.name,element:a,measurementData:o};g.default.cornerstone.updateImage(a),Object(T.default)(a,h.default.MEASUREMENT_COMPLETED,t)}else Object(w.removeToolState)(a,n.name,o)}),e.detail):Object(w.removeToolState)(a,n.name,o),g.default.cornerstone.updateImage(a)}))}},{key:"doubleClickCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"touchPressCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"_updateTextForNearbyAnnotation",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.canvas,a=Object(w.getToolState)(t,this.name);if(!a)return!1;for(var o=0;o<a.data.length;o++){var r=a.data[o];if(this.pointNearTool(t,r,n)||Object(x.default)(r.handles.textBox,n))return r.active=!0,g.default.cornerstone.updateImage(t),this.configuration.changeTextCallback(r,e.detail,this._doneChangingTextCallback.bind(this,t,r)),e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),!0}}},{key:"_doneChangingTextCallback",value:function(e,t,n,a){!0===a?Object(w.removeToolState)(e,this.name,t):t.text=n,t.active=!1,g.default.cornerstone.updateImage(e),Object(T.default)(e,h.default.MEASUREMENT_MODIFIED,{toolName:this.name,toolType:this.name,element:e,measurementData:t})}}]),t}(m.default);function D(e){e(prompt("Enter your annotation:"))}function L(e,t,n){n(prompt("Change your annotation:"))}},"./tools/annotation/BidirectionalTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./tools/base/BaseAnnotationTool.js"),v=n("./tools/annotation/bidirectionalTool/createNewMeasurement.js"),p=n("./tools/annotation/bidirectionalTool/pointNearTool.js"),b=n("./tools/annotation/bidirectionalTool/renderToolData.js"),j=n("./tools/annotation/bidirectionalTool/addNewMeasurement.js"),x=n("./tools/annotation/bidirectionalTool/mouseMoveCallback.js"),y=n("./tools/annotation/bidirectionalTool/handleSelectedCallback.js"),T=n("./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js"),w=n("./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js"),C=n("./tools/cursors/index.js"),O=n("./util/throttle.js"),E=n("./util/getPixelSpacing.js"),M=n("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),I=function(e,t,n){return n()},S=function(e){function t(e){var n;o()(this,t);var a={name:"Bidirectional",supportedInteractionTypes:["Mouse","Touch"],configuration:{changeMeasurementLocationCallback:I,getMeasurementLocationCallback:I,textBox:"",shadow:"",drawHandles:!0,drawHandlesOnHover:!0,hideHandlesIfMoving:!1,renderDashed:!1,additionalData:[]},svgCursor:C.bidirectionalCursor};return(n=s()(this,d()(t).call(this,e,a))).throttledUpdateCachedStats=Object(O.default)(n.updateCachedStats,110),n.createNewMeasurement=v.default.bind(f()(n)),n.pointNearTool=p.default.bind(f()(n)),n.renderToolData=b.default.bind(f()(n)),n.addNewMeasurement=j.default.bind(f()(n)),n._moveCallback=x.default.bind(f()(n)),n.handleSelectedCallback=y.default.bind(f()(n)),n.handleSelectedMouseCallback=T.default.bind(f()(n)),n.handleSelectedTouchCallback=w.default.bind(f()(n)),n}return m()(t,e),i()(t,[{key:"updateCachedStats",value:function(e,t,n){if(n.toolName===this.name){var a=Object(E.default)(e),o=Object(M.default)(n,a),r=o.longestDiameter,i=o.shortestDiameter;n.longestDiameter=r,n.shortestDiameter=i,n.invalidated=!1}}}]),t}(h.default)},"./tools/annotation/CircleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return P}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./store/index.js"),j=n("./drawing/index.js"),x=n("./util/calculateSUV.js"),y=n("./util/ellipse/index.js"),T=n("./util/getROITextBoxCoords.js"),w=n("./util/numbersWithCommas.js"),C=n("./util/throttle.js"),O=n("./util/logger.js"),E=n("./util/getPixelSpacing.js"),M=n("./tools/cursors/index.js"),I=n("./util/getCircleCoords.js"),S=Object(O.getLogger)("tools:annotation:CircleRoiTool"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"CircleRoi",supportedInteractionTypes:["Mouse","Touch"],svgCursor:M.circleRoiCursor,configuration:{centerPointRadius:0,renderDashed:!1,hideHandlesIfMoving:!1}};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(C.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};S.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var o=t&&t.handles&&t.handles.start&&t.handles.end,r=g.default.cornerstoneMath.point.distance;if(o||S.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!o||!1===t.visible)return!1;var i="mouse"===a?15:25,l=g.default.cornerstone.pixelToCanvas(e,t.handles.start),s=g.default.cornerstone.pixelToCanvas(e,t.handles.end),u=r(l,n),d=r(l,s);return u>d-i/2&&u<d+i/2}},{key:"updateCachedStats",value:function(e,t,n){var a=(g.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,o=Object(E.default)(e),r=function(e,t,n,a,o){var r,i=Object(I.default)(n.start,n.end),l=g.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),s=Object(y.calculateEllipseStatistics)(l,i);"PT"===a&&(r={mean:Object(x.default)(e,s.mean,!0)||0,stdDev:Object(x.default)(e,s.stdDev,!0)||0});var u=i.width*(o&&o.colPixelSpacing||1)/2,d=2*Math.PI*u;return{area:Math.PI*(i.width*(o&&o.colPixelSpacing||1)/2)*(i.height*(o&&o.rowPixelSpacing||1)/2)||0,radius:u||0,perimeter:d||0,count:s.count||0,mean:s.mean||0,variance:s.variance||0,stdDev:s.stdDev||0,min:s.min||0,max:s.max||0,meanStdDevSUV:r}}(e,t,n.handles,a,o);n.cachedStats=r,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(h.getToolState)(e.currentTarget,this.name);if(n){var a=g.default.cornerstoneMath.point.distance,o=e.detail,r=o.image,i=o.element,l=o.canvasContext,s=v.default.getToolWidth(),u=this.configuration,d=u.handleRadius,c=u.drawHandlesOnHover,f=u.hideHandlesIfMoving,m=u.renderDashed,x=u.centerPointRadius,y=Object(j.getNewContext)(l.canvas),w=Object(E.default)(r),C=w.rowPixelSpacing,O=w.colPixelSpacing,M=Object(b.getModule)("globalConfiguration").configuration.lineDash,S=(g.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{}).modality,P=C&&O;Object(j.draw)(y,(function(e){for(var l=0;l<n.data.length;l++){var u=n.data[l];if(!1!==u.visible){var h=p.default.getColorIfActive(u),v={color:h,handleRadius:d,drawHandlesIfActive:c,hideHandlesIfMoving:f};Object(j.setShadow)(e,t.configuration);var b=g.default.cornerstone.pixelToCanvas(i,u.handles.start),y=g.default.cornerstone.pixelToCanvas(i,u.handles.end),w=a(b,y),C={color:h};if(m&&(C.lineDash=M),Object(j.drawCircle)(e,i,u.handles.start,w,C,"pixel"),x&&w>3*x&&Object(j.drawCircle)(e,i,u.handles.start,x,C,"pixel"),u.handles&&(u.handles.start.drawnIndependently=!0,u.handles.end.drawnIndependently=!0),Object(j.drawHandles)(e,o,u.handles,v),!0===u.invalidated&&(u.cachedStats?t.throttledUpdateCachedStats(r,i,u):t.updateCachedStats(r,i,u)),!u.handles.textBox.hasMoved){var O=Object(T.default)(o.viewport,u.handles);Object.assign(u.handles.textBox,O)}var E=D(e,r.color,u.cachedStats,S,P,t.configuration);u.unit=_(S,t.configuration.showHounsfieldUnits),Object(j.drawLinkedTextBox)(e,i,u.handles.textBox,E,u.handles,(function(e){return t=e.start,n=e.end,o=(a=Object(I.default)(t,n)).left,r=a.top,[{x:o+(i=a.width)/2,y:r},{x:o,y:r+(l=a.height)/2},{x:o+i/2,y:r+l},{x:o+i,y:r+l/2}];var t,n,a,o,r,i,l}),h,s,10,!0)}}}))}}}]),t}(m.default);function _(e,t){return"CT"===e&&!1!==t?"HU":""}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.area,o=void 0===a?0:a,r=n.radius,i=void 0===r?0:r,l=n.perimeter,s=void 0===l?0:l,u=n.mean,d=void 0===u?0:u,c=n.stdDev,f=void 0===c?0:c,g=n.min,m=void 0===g?0:g,h=n.max,v=void 0===h?0:h,p=n.meanStdDevSUV,b=void 0===p?0:p,j=arguments.length>3?arguments[3]:void 0,x=arguments.length>4?arguments[4]:void 0,y=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},T=y.showMinMax||!1,C=[],O=[];if(!t){var E=b&&0!==b.mean,M=_(j,y.showHounsfieldUnits),I="Mean: ".concat(Object(w.default)(d.toFixed(2))," ").concat(M),S="Std Dev: ".concat(Object(w.default)(f.toFixed(2))," ").concat(M);if(E){for(var P=" SUV: ",D="".concat(P).concat(Object(w.default)(b.mean.toFixed(2))),A="".concat(P).concat(Object(w.default)(b.stdDev.toFixed(2))),R=Math.floor(e.measureText("".concat(S,"     ")).width);e.measureText(I).width<R;)I+=" ";O.push("".concat(I).concat(D)),O.push("".concat(S,"     ").concat(A))}else O.push("".concat(I,"     ").concat(S));if(T){for(var H="Min: ".concat(m," ").concat(M),B="Max: ".concat(v," ").concat(M),U=E?Math.floor(e.measureText("".concat(S,"     ")).width):Math.floor(e.measureText("".concat(I,"     ")).width);e.measureText(H).width<U;)H+=" ";O.push("".concat(H).concat(B))}}return C.push(L(o,x)),i&&C.push(k(i,"Radius",x)),s&&C.push(k(s,"Perimeter",x)),O.forEach((function(e){return C.push(e)})),C}function L(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(w.default)(e.toFixed(2))).concat(n)}function k(e,t,n){if(!e)return"";var a=n?" mm":" px";return"".concat(t,": ").concat(Object(w.default)(e.toFixed(1))).concat(a)}},"./tools/annotation/CobbAngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/textStyle.js"),v=n("./stateManagement/toolState.js"),p=n("./stateManagement/toolStyle.js"),b=n("./stateManagement/toolColors.js"),j=n("./manipulators/index.js"),x=n("./drawing/index.js"),y=n("./drawing/drawHandles.js"),T=n("./drawing/drawLinkedTextBox.js"),w=n("./util/lineSegDistance.js"),C=n("./util/roundToDecimal.js"),O=n("./events.js"),E=n("./tools/cursors/index.js"),M=n("./util/triggerEvent.js"),I=n("./util/throttle.js"),S=n("./util/getPixelSpacing.js"),P=n("./store/index.js"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"CobbAngle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:E.cobbAngleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=s()(this,d()(t).call(this,n,a))).hasIncomplete=!1,e.throttledUpdateCachedStats=Object(I.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return this.hasIncomplete=!0,{visible:!0,active:!0,color:void 0,invalidated:!0,complete:!1,value:"",handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},end2:{x:e.currentPoints.image.x+1,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){if(!1===t.visible)return!1;if(this.hasIncomplete)return!1;var a=Object(w.default)(e,t.handles.start,t.handles.end,n)<25,o=Object(w.default)(e,t.handles.start2,t.handles.end2,n)<25;return a||o}},{key:"updateCachedStats",value:function(e,t,n){var a=Object(S.default)(e),o=a.rowPixelSpacing,r=a.colPixelSpacing,i=(Math.ceil(n.handles.start.x)-Math.ceil(n.handles.end.x))*(r||1),l=(Math.ceil(n.handles.start.y)-Math.ceil(n.handles.end.y))*(o||1),s=(Math.ceil(n.handles.start2.x)-Math.ceil(n.handles.end2.x))*(r||1),u=(Math.ceil(n.handles.start2.y)-Math.ceil(n.handles.end2.y))*(o||1),d=Math.acos(Math.abs((i*s+l*u)/(Math.sqrt(i*i+l*l)*Math.sqrt(s*s+u*u))));d*=180/Math.PI,n.rAngle=Object(C.default)(d,2),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,o=a.handleRadius,r=a.drawHandlesOnHover,i=a.hideHandlesIfMoving,l=a.renderDashed,s=Object(v.getToolState)(e.currentTarget,this.name);if(s)for(var u=Object(x.getNewContext)(n.canvasContext.canvas),d=p.default.getToolWidth(),c=Object(P.getModule)("globalConfiguration").configuration.lineDash,f=h.default.getFont(),m=e.detail.element,j=g.default.cornerstone.getEnabledElement(m).image,w=Object(S.default)(j),C=w.rowPixelSpacing,O=w.colPixelSpacing,E=function(e){var a=s.data[e];if(!1===a.visible)return"continue";a.value||(a.value=t.textBoxText(a,C,O)),Object(x.draw)(u,(function(e){Object(x.setShadow)(e,t.configuration);var s=b.default.getColorIfActive(a),u={color:s};l&&(u.lineDash=c),Object(x.drawLine)(e,n.element,a.handles.start,a.handles.end,u),a.complete&&Object(x.drawLine)(e,n.element,a.handles.start2,a.handles.end2,u);var g={color:s,handleRadius:o,drawHandlesIfActive:r,hideHandlesIfMoving:i};t.configuration.drawHandles&&Object(y.default)(e,n,a.handles,g),e.fillStyle=s;var m=a.value;if(!a.handles.textBox.hasMoved){var h={x:(a.handles.start.x+a.handles.end.x)/2,y:(a.handles.start.y+a.handles.end.y)/2-10};e.font=f,a.handles.textBox.x=h.x,a.handles.textBox.y=h.y}Object(T.default)(e,n.element,a.handles.textBox,m,a.handles,I,s,d,0,!0)}))},M=0;M<s.data.length;M++)E(M);function I(e){return[e.start,e.start2,e.end,e.end2]}}},{key:"getIncomplete",value:function(e){var t=Object(v.getToolState)(e,this.name);if(t&&Array.isArray(t.data))return t.data.find((function(e){return!1===e.complete}))}},{key:"addNewMeasurement",value:function(e,t){var n=this;e.preventDefault(),e.stopPropagation();var a,o,r=e.detail,i=function(e){if(e){var t=O.default.MEASUREMENT_COMPLETED,o={toolName:n.name,toolType:n.name,element:l,measurementData:a};Object(M.default)(l,t,o)}else Object(v.removeToolState)(l,n.name,a)},l=e.detail.element,s=this.getIncomplete(l);s?((a=s).complete=!0,a.handles.start2={x:r.currentPoints.image.x,y:r.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!1},a.handles.end2={x:r.currentPoints.image.x,y:r.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!0},o=a.handles.end2,this.hasIncomplete=!1,i=function(e){if(e){var t=O.default.MEASUREMENT_COMPLETED,o={toolName:n.name,toolType:n.name,element:l,measurementData:a};Object(M.default)(l,t,o)}else Object(v.removeToolState)(l,n.name,a)}):(a=this.createNewMeasurement(r),Object(v.addToolState)(l,this.name,a),o=a.handles.end),g.default.cornerstone.updateImage(l),Object(j.moveNewHandle)(r,this.name,a,o,this.options,t,i)}},{key:"onMeasureModified",value:function(e){var t=e.detail.element,n=g.default.cornerstone.getEnabledElement(t).image,a=Object(S.default)(n),o=a.rowPixelSpacing,r=a.colPixelSpacing;if(e.detail.toolName===this.name){var i=e.detail.measurementData;!0===i.invalidated&&(i.rAngle?this.throttledUpdateCachedStats(n,t,i):this.updateCachedStats(n,t,i)),i.value=this.textBoxText(i,o,r)}}},{key:"textBoxText",value:function(e,t,n){var a=e.rAngle;if(void 0===a)return"";if(Number.isNaN(a))return"";var o=t&&n?"":" (isotropic)";return"".concat(a,"").concat(o)}},{key:"activeCallback",value:function(e){this.onMeasureModified=this.onMeasureModified.bind(this),e.addEventListener(O.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"passiveCallback",value:function(e){this.onMeasureModified=this.onMeasureModified.bind(this),e.addEventListener(O.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"enabledCallback",value:function(e){e.removeEventListener(O.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"disabledCallback",value:function(e){e.removeEventListener(O.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}}]),t}(m.default)},"./tools/annotation/EllipticalRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return P}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./manipulators/getHandleNearImagePoint.js"),j=n("./drawing/index.js"),x=n("./util/calculateSUV.js"),y=n("./util/ellipse/index.js"),T=n("./util/getROITextBoxCoords.js"),w=n("./util/numbersWithCommas.js"),C=n("./util/throttle.js"),O=n("./tools/cursors/index.js"),E=n("./util/logger.js"),M=n("./util/getPixelSpacing.js"),I=n("./store/index.js"),S=Object(E.getLogger)("tools:annotation:EllipticalRoiTool"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"EllipticalRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:O.ellipticalRoiCursor};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(C.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};S.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var o=t&&t.handles&&t.handles.start&&t.handles.end;if(o||S.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!o||!1===t.visible)return!1;if(Object(b.default)(e,t.handles,n,6))return!0;var r="mouse"===a?15:25,i=g.default.cornerstone.pixelToCanvas(e,t.handles.start),l=g.default.cornerstone.pixelToCanvas(e,t.handles.end),s={left:Math.min(i.x,l.x)+r/2,top:Math.min(i.y,l.y)+r/2,width:Math.abs(i.x-l.x)-r,height:Math.abs(i.y-l.y)-r},u={left:Math.min(i.x,l.x)-r/2,top:Math.min(i.y,l.y)-r/2,width:Math.abs(i.x-l.x)+r,height:Math.abs(i.y-l.y)+r},d=Object(y.pointInEllipse)(s,n);return!(!Object(y.pointInEllipse)(u,n)||d)}},{key:"updateCachedStats",value:function(e,t,n){var a=(g.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,o=Object(M.default)(e),r=function(e,t,n,a,o){var r,i=k(n.start,n.end),l=g.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),s=Object(y.calculateEllipseStatistics)(l,i);return"PT"===a&&(r={mean:Object(x.default)(e,s.mean,!0)||0,stdDev:Object(x.default)(e,s.stdDev,!0)||0}),{area:Math.PI*(i.width*(o.colPixelSpacing||1)/2)*(i.height*(o.rowPixelSpacing||1)/2)||0,count:s.count||0,mean:s.mean||0,variance:s.variance||0,stdDev:s.stdDev||0,min:s.min||0,max:s.max||0,meanStdDevSUV:r}}(e,t,n.handles,a,o);n.cachedStats=r,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(h.getToolState)(e.currentTarget,this.name);if(n){var a=e.detail,o=a.image,r=a.element,i=v.default.getToolWidth(),l=Object(I.getModule)("globalConfiguration").configuration.lineDash,s=this.configuration,u=s.handleRadius,d=s.drawHandlesOnHover,c=s.hideHandlesIfMoving,f=s.renderDashed,m=Object(j.getNewContext)(a.canvasContext.canvas),b=Object(M.default)(o),x=b.rowPixelSpacing,y=b.colPixelSpacing,w=(g.default.cornerstone.metaData.get("generalSeriesModule",o.imageId)||{}).modality,C=x&&y;Object(j.draw)(m,(function(e){for(var s=0;s<n.data.length;s++){var g=n.data[s];if(!1!==g.visible){var m=p.default.getColorIfActive(g),h={color:m,handleRadius:u,drawHandlesIfActive:d,hideHandlesIfMoving:c};Object(j.setShadow)(e,t.configuration);var v={color:m};if(f&&(v.lineDash=l),Object(j.drawEllipse)(e,r,g.handles.start,g.handles.end,v,"pixel",g.handles.initialRotation),Object(j.drawHandles)(e,a,g.handles,h),!0===g.invalidated&&(g.cachedStats?t.throttledUpdateCachedStats(o,r,g):t.updateCachedStats(o,r,g)),!g.handles.textBox.hasMoved){var b=Object(T.default)(a.viewport,g.handles);Object.assign(g.handles.textBox,b)}var x=D(e,o.color,g.cachedStats,w,C,t.configuration);g.unit=_(w,t.configuration.showHounsfieldUnits),Object(j.drawLinkedTextBox)(e,r,g.handles.textBox,x,g.handles,(function(e){return n=(t=k(e.start,e.end)).left,a=t.top,[{x:n+(o=t.width)/2,y:a},{x:n,y:a+(r=t.height)/2},{x:n+o/2,y:a+r},{x:n+o,y:a+r/2}];var t,n,a,o,r}),m,i,10,!0)}}}))}}}]),t}(m.default);function _(e,t){return"CT"===e&&!1!==t?"HU":""}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.area,o=n.mean,r=n.stdDev,i=n.min,l=n.max,s=n.meanStdDevSUV,u=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=c.showMinMax||!1,g=[],m=[];if(!t){var h=s&&0!==s.mean,v=_(u,c.showHounsfieldUnits),p="Mean: ".concat(Object(w.default)(o.toFixed(2))," ").concat(v),b="Std Dev: ".concat(Object(w.default)(r.toFixed(2))," ").concat(v);if(h){for(var j=" SUV: ",x="".concat(j).concat(Object(w.default)(s.mean.toFixed(2))),y="".concat(j).concat(Object(w.default)(s.stdDev.toFixed(2))),T=Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(p).width<T;)p+=" ";m.push("".concat(p).concat(x)),m.push("".concat(b,"     ").concat(y))}else m.push("".concat(p)),m.push("".concat(b));if(f){for(var C="Min: ".concat(i," ").concat(v),O="Max: ".concat(l," ").concat(v),E=h?Math.floor(e.measureText("".concat(b,"     ")).width):Math.floor(e.measureText("".concat(p,"     ")).width);e.measureText(C).width<E;)C+=" ";m.push("".concat(C).concat(O))}}return g.push(L(a,d)),m.forEach((function(e){return g.push(e)})),g}function L(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(w.default)(e.toFixed(2))).concat(n)}function k(e,t){return{left:Math.round(Math.min(e.x,t.x)),top:Math.round(Math.min(e.y,t.y)),width:Math.round(Math.abs(e.x-t.x)),height:Math.round(Math.abs(e.y-t.y))}}},"./tools/annotation/FreehandRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return z}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./events.js"),v=n("./externalModules.js"),p=n("./tools/base/BaseAnnotationTool.js"),b=n("./stateManagement/toolState.js"),j=n("./stateManagement/toolStyle.js"),x=n("./stateManagement/toolColors.js"),y=n("./store/index.js"),T=n("./util/triggerEvent.js"),w=n("./util/findAndMoveHelpers.js"),C=n("./util/pointInsideBoundingBox.js"),O=n("./util/calculateSUV.js"),E=n("./util/numbersWithCommas.js"),M=n("./util/getPixelSpacing.js"),I=n("./drawing/index.js"),S=n("./drawing/drawLinkedTextBox.js"),P=n("./drawing/drawHandles.js"),_=n("./util/clip.js"),D=n("./store/setToolCursor.js"),L=n("./tools/cursors/index.js"),k=n("./util/freehand/index.js"),A=n("./util/logger.js"),R=n("./util/throttle.js"),H=Object(A.getLogger)("tools:annotation:FreehandRoiTool"),B=k.default.insertOrDelete,U=k.default.freehandArea,F=k.default.calculateFreehandStatistics,N=k.default.freehandIntersect,V=k.default.FreehandHandleData,z=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},spacing:1,activeHandleRadius:3,completeHandleRadius:6,completeHandleRadiusTouch:28,alwaysShowHandles:!1,invalidColor:"crimson",currentHandle:0,currentTool:-1,drawHandles:!0,renderDashed:!1},svgCursor:L.freehandRoiCursor};return(e=s()(this,d()(t).call(this,n,a))).isMultiPartTool=!0,e._drawing=!1,e._dragging=!1,e._modifying=!1,e._drawingMouseDownCallback=e._drawingMouseDownCallback.bind(f()(e)),e._drawingMouseMoveCallback=e._drawingMouseMoveCallback.bind(f()(e)),e._drawingMouseDragCallback=e._drawingMouseDragCallback.bind(f()(e)),e._drawingMouseUpCallback=e._drawingMouseUpCallback.bind(f()(e)),e._drawingMouseDoubleClickCallback=e._drawingMouseDoubleClickCallback.bind(f()(e)),e._editMouseUpCallback=e._editMouseUpCallback.bind(f()(e)),e._editMouseDragCallback=e._editMouseDragCallback.bind(f()(e)),e._drawingTouchStartCallback=e._drawingTouchStartCallback.bind(f()(e)),e._drawingTouchDragCallback=e._drawingTouchDragCallback.bind(f()(e)),e._drawingDoubleTapClickCallback=e._drawingDoubleTapClickCallback.bind(f()(e)),e._editTouchDragCallback=e._editTouchDragCallback.bind(f()(e)),e.throttledUpdateCachedStats=Object(R.default)(e.updateCachedStats,110),e}return m()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{points:[]}};return t.handles.textBox={active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0},t}H.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){var a=t&&t.handles&&t.handles.points;if(!a)throw new Error("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"));return!(!a||!1===t.visible)&&void 0!==this._pointNearHandle(e,t,n)}},{key:"distanceFromPoint",value:function(e,t,n){for(var a=1/0,o=0;o<t.handles.points.length;o++){var r=v.default.cornerstoneMath.point.distance(t.handles.points[o],n);a=Math.min(a,r)}return a===1/0?-1:a}},{key:"distanceFromPointCanvas",value:function(e,t,n){var a=1/0;if(!t)return-1;for(var o=v.default.cornerstone.pixelToCanvas(e,n),r=t.handles.points,i=0;i<r.length;i++){var l=v.default.cornerstone.pixelToCanvas(e,r[i]),s=v.default.cornerstoneMath.point.distance(l,o);a=Math.min(a,s)}return a===1/0?-1:a}},{key:"updateCachedStats",value:function(e,t,n){for(var a,o,r=v.default.cornerstone.metaData.get("generalSeriesModule",e.imageId),i=r?r.modality:null,l=n.handles.points,s={left:l[0].x,right:l[0].x,bottom:l[0].y,top:l[0].x},u=0;u<l.length;u++)s.left=Math.min(s.left,l[u].x),s.right=Math.max(s.right,l[u].x),s.bottom=Math.min(s.bottom,l[u].y),s.top=Math.max(s.top,l[u].y);var d={left:s.left,top:s.bottom,width:Math.abs(s.right-s.left),height:Math.abs(s.top-s.bottom)};if(n.polyBoundingBox=d,!e.color){var c=v.default.cornerstone.getPixels(t,d.left,d.top,d.width,d.height);a=F.call(this,c,d,n.handles.points),"PT"===i&&(o={mean:Object(O.default)(e,(a.mean-e.intercept)/e.slope),stdDev:Object(O.default)(e,(a.stdDev-e.intercept)/e.slope)}),a&&!isNaN(a.mean)&&(n.meanStdDev=a,n.meanStdDevSUV=o)}var f=Object(M.default)(e),g=(f.colPixelSpacing||1)*(f.rowPixelSpacing||1),m=U(n.handles.points,g);isNaN(m)||(n.area=m),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=Object(b.getToolState)(e.currentTarget,this.name);if(a)for(var o=n.image,r=n.element,i=this.configuration,l=v.default.cornerstone.metaData.get("generalSeriesModule",o.imageId),s=l?l.modality:null,u=Object(I.getNewContext)(n.canvasContext.canvas),d=j.default.getToolWidth(),c=i.renderDashed,f=Object(y.getModule)("globalConfiguration").configuration.lineDash,g=function(e){var l=a.data[e];if(!1===l.visible)return"continue";Object(I.draw)(u,(function(e){var a,s=x.default.getColorIfActive(l);l.active?l.handles.invalidHandlePlacement?(s=i.invalidColor,a=i.invalidColor):(s=x.default.getColorIfActive(l),a=x.default.getFillColor()):a=x.default.getToolColor();var u={color:s};if(c&&(u.lineDash=f),l.handles.points.length){var g=l.handles.points;Object(I.drawJoinedLines)(e,r,g[0],g,u),l.polyBoundingBox?Object(I.drawJoinedLines)(e,r,g[g.length-1],[g[0]],u):Object(I.drawJoinedLines)(e,r,g[g.length-1],[i.mouseLocation.handles.start],u)}if(u={color:s,fill:a},(i.alwaysShowHandles||l.active&&l.polyBoundingBox)&&(u.handleRadius=i.activeHandleRadius,t.configuration.drawHandles&&Object(P.default)(e,n,l.handles.points,u)),l.canComplete){u.handleRadius=i.completeHandleRadius;var m=l.handles.points[0];t.configuration.drawHandles&&Object(P.default)(e,n,[m],u)}if(l.active&&!l.polyBoundingBox){u.handleRadius=i.activeHandleRadius,t.configuration.drawHandles&&Object(P.default)(e,n,i.mouseLocation.handles,u);var v=l.handles.points[0];t.configuration.drawHandles&&Object(P.default)(e,n,[v],u)}if(!0!==l.invalidated||l.active||(l.meanStdDev&&l.meanStdDevSUV&&l.area?t.throttledUpdateCachedStats(o,r,l):t.updateCachedStats(o,r,l)),l.polyBoundingBox&&!l.handles.textBox.freehand){l.handles.textBox.hasMoved||(l.handles.textBox.x=l.polyBoundingBox.left+l.polyBoundingBox.width,l.handles.textBox.y=l.polyBoundingBox.top+l.polyBoundingBox.height/2);var b=h.call(t,l);Object(S.default)(e,r,l.handles.textBox,b,l.handles.points,p,s,d,0,!0)}}))},m=0;m<a.data.length;m++)g(m);function h(e){var t=e.meanStdDev,n=e.meanStdDevSUV,a=e.area,r=[];if(t&&void 0!==t.mean){var i="";"CT"===s&&(i="HU"),e.unit=i;var l="Mean: ".concat(Object(E.default)(t.mean.toFixed(2))," ").concat(i),u="StdDev: ".concat(Object(E.default)(t.stdDev.toFixed(2))," ").concat(i);if(n&&void 0!==n.mean){var d=" SUV: ";l+=d+Object(E.default)(n.mean.toFixed(2)),u+=d+Object(E.default)(n.stdDev.toFixed(2))}r.push(l),r.push(u)}if(a){var c=" mm".concat(String.fromCharCode(178)),f=Object(M.default)(o),g=f.rowPixelSpacing,m=f.colPixelSpacing;g&&m||(c=" pixels".concat(String.fromCharCode(178)));var h="Area: ".concat(Object(E.default)(a.toFixed(2))).concat(c);r.push(h)}return r}function p(e){return e}}},{key:"addNewMeasurement",value:function(e){var t=e.detail;this._startDrawing(e),this._addPoint(t),W(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,n=this._pointNearHandleAllTools(t);return!!t.event.ctrlKey&&(void 0!==n&&n.handleNearby.hasBoundingBox||B.call(this,e,n),W(e),!0)}},{key:"handleSelectedCallback",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",o=e.detail.element,r=Object(b.getToolState)(o,this.name);if(n.hasBoundingBox)Object(w.moveHandleNearImagePoint)(e,this,t,n,a);else{var i=this.configuration;i.dragOrigin={x:n.x,y:n.y};for(var l=0;l<r.data.length;l++)for(var s=r.data[l].handles.points,u=0;u<s.length;u++)s[u]===n&&(i.currentHandle=u,i.currentTool=l);this._modifying=!0,this._activateModify(o),W(e)}}},{key:"_drawingMouseMoveCallback",value:function(e){var t=e.detail,n=t.currentPoints,a=t.element,o=Object(b.getToolState)(a,this.name),r=this.configuration,i=r.currentTool,l=o.data[i],s=n.canvas;this._getMouseLocation(t),this._checkInvalidHandleLocation(l,t);var u=this._pointNearHandle(a,l,s),d=l.handles.points;void 0!==u&&!u.hasBoundingBox&&u<d.length-1&&(r.mouseLocation.handles.start.x=d[u].x,r.mouseLocation.handles.start.y=d[u].y),v.default.cornerstone.updateImage(a)}},{key:"_drawingMouseDragCallback",value:function(e){this.options.mouseButtonMask.includes(e.detail.buttons)&&this._drawingDrag(e)}},{key:"_drawingTouchDragCallback",value:function(e){this._drawingDrag(e)}},{key:"_drawingDrag",value:function(e){var t=e.detail,n=t.element,a=Object(b.getToolState)(n,this.name),o=this.configuration.currentTool,r=a.data[o];this._getMouseLocation(t),this._checkInvalidHandleLocation(r,t),this._addPointPencilMode(t,r.handles.points),this._dragging=!0,v.default.cornerstone.updateImage(n)}},{key:"_drawingMouseUpCallback",value:function(e){var t=e.detail.element;if(this._dragging){this._dragging=!1;var n=this.configuration,a=n.currentTool,o=Object(b.getToolState)(t,this.name).data[a];if(!N.end(o.handles.points)&&o.canComplete){var r=n.currentHandle;this._endDrawing(t,r)}W(e)}}},{key:"_drawingMouseDownCallback",value:function(e){var t=e.detail,n=t.buttons,a=t.currentPoints,o=t.element;if(this.options.mouseButtonMask.includes(n)){var r=a.canvas,i=this.configuration,l=i.currentTool,s=Object(b.getToolState)(o,this.name).data[l],u=this._pointNearHandle(o,s,r);if(!N.end(s.handles.points)&&s.canComplete){var d=i.currentHandle;this._endDrawing(o,d)}else void 0===u&&this._addPoint(t);W(e)}}},{key:"_drawingTouchStartCallback",value:function(e){var t=e.detail,n=t.currentPoints,a=t.element,o=n.canvas,r=this.configuration,i=r.currentTool,l=Object(b.getToolState)(a,this.name).data[i],s=this._pointNearHandle(a,l,o);if(!N.end(l.handles.points)&&l.canComplete){var u=r.currentHandle;this._endDrawing(a,u)}else void 0===s&&this._addPoint(t);W(e)}},{key:"completeDrawing",value:function(e){if(this._drawing){var t=Object(b.getToolState)(e,this.name),n=this.configuration,a=t.data[n.currentTool];if(!N.end(a.handles.points)&&a.handles.points.length>=2){var o=n.currentHandle;a.polyBoundingBox={},this._endDrawing(e,o)}}}},{key:"_drawingMouseDoubleClickCallback",value:function(e){var t=e.detail.element;this.completeDrawing(t),W(e)}},{key:"_drawingDoubleTapClickCallback",value:function(e){var t=e.detail.element;this.completeDrawing(t),W(e)}},{key:"_editMouseDragCallback",value:function(e){var t=e.detail,n=t.element,a=t.buttons;if(this.options.mouseButtonMask.includes(a)){var o,r=Object(b.getToolState)(n,this.name),i=this.configuration,l=r.data[i.currentTool],s=i.currentHandle,u=l.handles.points;if(this._getMouseLocation(t),l.handles.invalidHandlePlacement=N.modify(u,s),l.active=!0,l.highlight=!0,u[s].x=i.mouseLocation.handles.start.x,u[s].y=i.mouseLocation.handles.start.y,o=this._getPrevHandleIndex(s,u),s>=0){var d=u[o].lines.length-1,c=u[o].lines[d];c.x=i.mouseLocation.handles.start.x,c.y=i.mouseLocation.handles.start.y}v.default.cornerstone.updateImage(n)}}},{key:"_editTouchDragCallback",value:function(e){var t,n=e.detail,a=n.element,o=Object(b.getToolState)(a,this.name),r=this.configuration,i=o.data[r.currentTool],l=r.currentHandle,s=i.handles.points;if(this._getMouseLocation(n),i.handles.invalidHandlePlacement=N.modify(s,l),i.active=!0,i.highlight=!0,s[l].x=r.mouseLocation.handles.start.x,s[l].y=r.mouseLocation.handles.start.y,t=this._getPrevHandleIndex(l,s),l>=0){var u=s[t].lines.length-1,d=s[t].lines[u];d.x=r.mouseLocation.handles.start.x,d.y=r.mouseLocation.handles.start.y}v.default.cornerstone.updateImage(a)}},{key:"_getPrevHandleIndex",value:function(e,t){return 0===e?t.length-1:e-1}},{key:"_editMouseUpCallback",value:function(e){var t=e.detail,n=t.element,a=Object(b.getToolState)(n,this.name);this._deactivateModify(n),this._dropHandle(t,a),this._endDrawing(n),v.default.cornerstone.updateImage(n)}},{key:"_dropHandle",value:function(e,t){var n=this.configuration,a=n.currentTool,o=t.data[a].handles,r=o.points;if(o.invalidHandlePlacement){var i,l=n.currentHandle,s=r[l];i=0===l?r[r.length-1]:r[l-1],s.x=n.dragOrigin.x,s.y=n.dragOrigin.y,i.lines[0]=s,o.invalidHandlePlacement=!1}}},{key:"_startDrawing",value:function(e){var t,n=e.detail,a=this.createNewMeasurement(n),o=n.element,r=this.configuration;e.type===h.default.MOUSE_DOWN_ACTIVATE?t="Mouse":e.type===h.default.TOUCH_START_ACTIVE&&(t="Touch"),this._activateDraw(o,t),this._getMouseLocation(n),Object(b.addToolState)(o,this.name,a);var i=Object(b.getToolState)(o,this.name);r.currentTool=i.data.length-1,this._activeDrawingToolReference=i.data[r.currentTool]}},{key:"_addPoint",value:function(e){var t=e.currentPoints,n=e.element,a=Object(b.getToolState)(n,this.name),o=this.configuration,r=a.data[o.currentTool];if(!r.handles.invalidHandlePlacement){var i=new V(t.image);r.handles.points.length&&r.handles.points[o.currentHandle-1].lines.push(t.image),r.handles.points.push(i),o.currentHandle+=1,v.default.cornerstone.updateImage(n),this.fireModifiedEvent(n,r)}}},{key:"_addPointPencilMode",value:function(e,t){var n=this,a=this.configuration,o=e.element,r=a.mouseLocation.handles.start;t.every((function(e){return n._isDistanceLargerThanSpacing(o,e,r)}))&&this._addPoint(e)}},{key:"_endDrawing",value:function(e,t){var n=Object(b.getToolState)(e,this.name),a=this.configuration,o=n.data[a.currentTool];if(o.active=!1,o.highlight=!1,o.handles.invalidHandlePlacement=!1,void 0!==t){var r=o.handles.points;r[a.currentHandle-1].lines.push(r[0])}this._modifying&&(this._modifying=!1,o.invalidated=!0),a.currentHandle=0,a.currentTool=-1,o.canComplete=!1,this._drawing&&this._deactivateDraw(e),v.default.cornerstone.updateImage(e),this.fireModifiedEvent(e,o),this.fireCompletedEvent(e,o)}},{key:"_pointNearHandle",value:function(e,t,n){if(void 0!==t.handles&&void 0!==t.handles.points&&!1!==t.visible){for(var a=0;a<t.handles.points.length;a++){var o=v.default.cornerstone.pixelToCanvas(e,t.handles.points[a]);if(v.default.cornerstoneMath.point.distance(o,n)<6)return a}return t.handles.textBox&&Object(C.default)(t.handles.textBox,n)?t.handles.textBox:void 0}}},{key:"_pointNearHandleAllTools",value:function(e){var t=e.currentPoints,n=e.element,a=t.canvas,o=Object(b.getToolState)(n,this.name);if(o)for(var r,i=0;i<o.data.length;i++)if(void 0!==(r=this._pointNearHandle(n,o.data[i],a)))return{handleNearby:r,toolIndex:i}}},{key:"_getMouseLocation",value:function(e){var t=e.currentPoints,n=e.image,a=this.configuration;a.mouseLocation.handles.start.x=t.image.x,a.mouseLocation.handles.start.y=t.image.y,Object(_.clipToBox)(a.mouseLocation.handles.start,n)}},{key:"_checkInvalidHandleLocation",value:function(e,t){if(e.handles.points.length<2)return!0;var n;n=this._dragging?this._checkHandlesPencilMode(e,t):this._checkHandlesPolygonMode(e,t),e.handles.invalidHandlePlacement=n}},{key:"_checkHandlesPolygonMode",value:function(e,t){var n=this.configuration,a=t.element,o=n.mouseLocation.handles.start,r=e.handles.points,i=!1;return e.canComplete=!1,this._isDistanceSmallerThanCompleteSpacingCanvas(a,r[0],o)&&!N.end(r)&&r.length>2?(e.canComplete=!0,i=!1):i=N.newHandle(o,r),i}},{key:"_checkHandlesPencilMode",value:function(e,t){var n=this.configuration.mouseLocation.handles.start,a=e.handles.points,o=N.newHandle(n,a);return!1===o&&(o=this._invalidHandlePencilMode(e,t)),o}},{key:"_invalidHandlePencilMode",value:function(e,t){var n=this.configuration,a=t.element,o=n.mouseLocation.handles.start,r=e.handles.points;if(this._isDistanceSmallerThanCompleteSpacingCanvas(a,r[0],o))return e.canComplete=!0,!1;e.canComplete=!1;for(var i=1;i<r.length-1;i++)if(this._isDistanceSmallerThanSpacing(a,r[i],o))return!0;return!1}},{key:"_isDistanceSmallerThanCompleteSpacingCanvas",value:function(e,t,n){var a,o=v.default.cornerstone.pixelToCanvas(e,t),r=v.default.cornerstone.pixelToCanvas(e,n);return"Mouse"===this._drawingInteractionType?a=this.configuration.completeHandleRadius:"Touch"===this._drawingInteractionType&&(a=this.configuration.completeHandleRadiusTouch),this._compareDistanceToSpacing(e,o,r,"<",a)}},{key:"_isDistanceSmallerThanSpacing",value:function(e,t,n){return this._compareDistanceToSpacing(e,t,n,"<")}},{key:"_isDistanceLargerThanSpacing",value:function(e,t,n){return this._compareDistanceToSpacing(e,t,n,">")}},{key:"_compareDistanceToSpacing",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:">",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.configuration.spacing;return">"===a?v.default.cornerstoneMath.point.distance(t,n)>o:v.default.cornerstoneMath.point.distance(t,n)<o}},{key:"_activateDraw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Mouse";this._drawing=!0,this._drawingInteractionType=t,y.state.isMultiPartToolActive=!0,Object(D.hideToolCursor)(this.element),e.addEventListener(h.default.MOUSE_DOWN,this._drawingMouseDownCallback),e.addEventListener(h.default.MOUSE_MOVE,this._drawingMouseMoveCallback),e.addEventListener(h.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),e.addEventListener(h.default.MOUSE_DRAG,this._drawingMouseDragCallback),e.addEventListener(h.default.MOUSE_UP,this._drawingMouseUpCallback),e.addEventListener(h.default.TOUCH_START,this._drawingMouseMoveCallback),e.addEventListener(h.default.TOUCH_START,this._drawingTouchStartCallback),e.addEventListener(h.default.TOUCH_DRAG,this._drawingTouchDragCallback),e.addEventListener(h.default.TOUCH_END,this._drawingMouseUpCallback),e.addEventListener(h.default.DOUBLE_TAP,this._drawingDoubleTapClickCallback),v.default.cornerstone.updateImage(e)}},{key:"_deactivateDraw",value:function(e){this._drawing=!1,y.state.isMultiPartToolActive=!1,this._activeDrawingToolReference=null,this._drawingInteractionType=null,Object(D.setToolCursor)(this.element,this.svgCursor),e.removeEventListener(h.default.MOUSE_DOWN,this._drawingMouseDownCallback),e.removeEventListener(h.default.MOUSE_MOVE,this._drawingMouseMoveCallback),e.removeEventListener(h.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),e.removeEventListener(h.default.MOUSE_DRAG,this._drawingMouseDragCallback),e.removeEventListener(h.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(h.default.TOUCH_START,this._drawingTouchStartCallback),e.removeEventListener(h.default.TOUCH_DRAG,this._drawingTouchDragCallback),e.removeEventListener(h.default.TOUCH_START,this._drawingMouseMoveCallback),e.removeEventListener(h.default.TOUCH_END,this._drawingMouseUpCallback),v.default.cornerstone.updateImage(e)}},{key:"_activateModify",value:function(e){y.state.isToolLocked=!0,e.addEventListener(h.default.MOUSE_UP,this._editMouseUpCallback),e.addEventListener(h.default.MOUSE_DRAG,this._editMouseDragCallback),e.addEventListener(h.default.MOUSE_CLICK,this._editMouseUpCallback),e.addEventListener(h.default.TOUCH_END,this._editMouseUpCallback),e.addEventListener(h.default.TOUCH_DRAG,this._editTouchDragCallback),v.default.cornerstone.updateImage(e)}},{key:"_deactivateModify",value:function(e){y.state.isToolLocked=!1,e.removeEventListener(h.default.MOUSE_UP,this._editMouseUpCallback),e.removeEventListener(h.default.MOUSE_DRAG,this._editMouseDragCallback),e.removeEventListener(h.default.MOUSE_CLICK,this._editMouseUpCallback),e.removeEventListener(h.default.TOUCH_END,this._editMouseUpCallback),e.removeEventListener(h.default.TOUCH_DRAG,this._editTouchDragCallback),v.default.cornerstone.updateImage(e)}},{key:"passiveCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"enabledCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"disabledCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"_closeToolIfDrawing",value:function(e){if(this._drawing){var t=this.configuration.currentHandle;this._endDrawing(e,t),v.default.cornerstone.updateImage(e)}}},{key:"fireModifiedEvent",value:function(e,t){var n=h.default.MEASUREMENT_MODIFIED,a={toolName:this.name,toolType:this.name,element:e,measurementData:t};Object(T.default)(e,n,a)}},{key:"fireCompletedEvent",value:function(e,t){var n=h.default.MEASUREMENT_COMPLETED,a={toolName:this.name,toolType:this.name,element:e,measurementData:t};Object(T.default)(e,n,a)}},{key:"cancelDrawing",value:function(e){if(this._drawing){var t=Object(b.getToolState)(e,this.name),n=this.configuration,a=t.data[n.currentTool];a.active=!1,a.highlight=!1,a.handles.invalidHandlePlacement=!1,n.currentHandle=0,n.currentTool=-1,a.canComplete=!1,Object(b.removeToolState)(e,this.name,a),this._deactivateDraw(e),v.default.cornerstone.updateImage(e)}}},{key:"newImageCallback",value:function(e){var t=this.configuration;if(this._drawing&&this._activeDrawingToolReference){var n=e.detail.element,a=this._activeDrawingToolReference;a.active=!1,a.highlight=!1,a.handles.invalidHandlePlacement=!1;var o=a.handles.points;o[t.currentHandle-1].lines.push(o[0]),t.currentHandle=0,t.currentTool=-1,a.canComplete=!1,this._deactivateDraw(n),v.default.cornerstone.updateImage(n)}}},{key:"spacing",get:function(){return this.configuration.spacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand spacing to a value other than a number.");this.configuration.spacing=e,v.default.cornerstone.updateImage(this.element)}},{key:"activeHandleRadius",get:function(){return this.configuration.activeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand activeHandleRadius to a value other than a number.");this.configuration.activeHandleRadius=e,v.default.cornerstone.updateImage(this.element)}},{key:"completeHandleRadius",get:function(){return this.configuration.completeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand completeHandleRadius to a value other than a number.");this.configuration.completeHandleRadius=e,v.default.cornerstone.updateImage(this.element)}},{key:"alwaysShowHandles",get:function(){return this.configuration.alwaysShowHandles},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.");this.configuration.alwaysShowHandles=e,v.default.cornerstone.updateImage(this.element)}},{key:"invalidColor",get:function(){return this.configuration.invalidColor},set:function(e){this.configuration.invalidColor=e,v.default.cornerstone.updateImage(this.element)}}]),t}(p.default);function W(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/LengthTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return M}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/toolState.js"),h=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/toolColors.js"),p=n("./drawing/index.js"),b=n("./drawing/drawLinkedTextBox.js"),j=n("./drawing/drawHandles.js"),x=n("./util/lineSegDistance.js"),y=n("./tools/cursors/index.js"),T=n("./util/logger.js"),w=n("./util/getPixelSpacing.js"),C=n("./util/throttle.js"),O=n("./store/index.js"),E=Object(T.getLogger)("tools:annotation:LengthTool"),M=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Length",supportedInteractionTypes:["Mouse","Touch"],svgCursor:y.lengthCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1,digits:2}};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(C.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t=e.currentPoints.image,n=t.x,a=t.y;return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:n,y:a,highlight:!0,active:!1},end:{x:n,y:a,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}E.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){return t&&t.handles&&t.handles.start&&t.handles.end?!1!==t.visible&&Object(x.default)(e,t.handles.start,t.handles.end,n)<25:(E.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!1)}},{key:"updateCachedStats",value:function(e,t,n){var a=Object(w.default)(e),o=a.rowPixelSpacing,r=a.colPixelSpacing,i=(n.handles.end.x-n.handles.start.x)*(r||1),l=(n.handles.end.y-n.handles.start.y)*(o||1),s=Math.sqrt(i*i+l*l);n.length=s,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,o=a.handleRadius,r=a.drawHandlesOnHover,i=a.hideHandlesIfMoving,l=a.renderDashed,s=a.digits,u=Object(m.getToolState)(e.currentTarget,this.name);if(u)for(var d=Object(p.getNewContext)(n.canvasContext.canvas),c=n.image,f=n.element,g=Object(w.default)(c),x=g.rowPixelSpacing,y=g.colPixelSpacing,T=h.default.getToolWidth(),C=Object(O.getModule)("globalConfiguration").configuration.lineDash,E=function(e){var a=u.data[e];if(!1===a.visible)return"continue";Object(p.draw)(d,(function(e){Object(p.setShadow)(e,t.configuration);var u=v.default.getColorIfActive(a),d={color:u};l&&(d.lineDash=C),Object(p.drawLine)(e,f,a.handles.start,a.handles.end,d);var g={color:u,handleRadius:o,drawHandlesIfActive:r,hideHandlesIfMoving:i};if(t.configuration.drawHandles&&Object(j.default)(e,n,a.handles,g),!a.handles.textBox.hasMoved){var m={x:Math.max(a.handles.start.x,a.handles.end.x)};m.x===a.handles.start.x?m.y=a.handles.start.y:m.y=a.handles.end.y,a.handles.textBox.x=m.x,a.handles.textBox.y=m.y}!0===a.invalidated&&(a.length?t.throttledUpdateCachedStats(c,f,a):t.updateCachedStats(c,f,a));var h=function(e,t,n){var a,o,r=(a=e.length,o=Number(a),isNaN(o)?void 0:o);if(!r)return"";var i="mm";return t&&n||(i="pixels"),e.unit=i,"".concat(r.toFixed(s)," ").concat(i)}(a,x,y);Object(b.default)(e,f,a.handles.textBox,h,a.handles,I,u,T,10,!0)}))},M=0;M<u.data.length;M++)E(M);function I(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}}]),t}(g.default)},"./tools/annotation/ProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return I}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/textStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),j=n("./drawing/drawTextBox.js"),x=n("./drawing/drawHandles.js"),y=n("./util/getRGBPixels.js"),T=n("./util/calculateSUV.js"),w=n("./tools/cursors/index.js"),C=n("./util/logger.js"),O=n("./util/throttle.js"),E=n("./store/index.js"),M=Object(C.getLogger)("tools:annotation:ProbeTool"),I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Probe",supportedInteractionTypes:["Mouse","Touch"],svgCursor:w.probeCursor,configuration:{drawHandles:!0,renderDashed:!1}};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(O.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};M.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){var a=t&&t.handles&&t.handles.end;if(a||M.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!a||!1===t.visible)return!1;var o=g.default.cornerstone.pixelToCanvas(e,t.handles.end);return g.default.cornerstoneMath.point.distance(o,n)<5}},{key:"updateCachedStats",value:function(e,t,n){var a=Math.round(n.handles.end.x),o=Math.round(n.handles.end.y),r={};a>=0&&o>=0&&a<e.columns&&o<e.rows&&(r.x=a,r.y=o,e.color?r.storedPixels=Object(y.default)(t,a,o,1,1):(r.storedPixels=g.default.cornerstone.getStoredPixels(t,a,o,1,1),r.sp=r.storedPixels[0],r.mo=r.sp*e.slope+e.intercept,r.suv=Object(T.default)(e,r.sp))),n.cachedStats=r,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,o=a.handleRadius,r=a.renderDashed,i=Object(h.getToolState)(e.currentTarget,this.name);if(i)for(var l=Object(b.getNewContext)(n.canvasContext.canvas),s=n.image,u=n.element,d=v.default.getFontSize(),c=Object(E.getModule)("globalConfiguration").configuration.lineDash,f=function(e){var a=i.data[e];if(!1===a.visible)return"continue";Object(b.draw)(l,(function(e){var i,l,f=p.default.getColorIfActive(a);if(t.configuration.drawHandles){var m={handleRadius:o,color:f};r&&(m.lineDash=c),Object(x.default)(e,n,a.handles,m)}!0===a.invalidated&&(a.cachedStats?t.throttledUpdateCachedStats(s,u,a):t.updateCachedStats(s,u,a));var h=a.cachedStats,v=h.x,b=h.y,y=h.storedPixels,T=h.sp,w=h.mo,C=h.suv;if(v>=0&&b>=0&&v<s.columns&&b<s.rows){i="".concat(v,", ").concat(b),s.color?l="R: ".concat(y[0]," G: ").concat(y[1]," B: ").concat(y[2]):(l="SP: ".concat(T," MO: ").concat(parseFloat(w.toFixed(3))),C&&(l+=" SUV: ".concat(parseFloat(C.toFixed(3)))));var O={x:a.handles.end.x+3,y:a.handles.end.y-3},E=g.default.cornerstone.pixelToCanvas(n.element,O);Object(j.default)(e,l,E.x,E.y+d+5,f),Object(j.default)(e,i,E.x,E.y,f)}}))},m=0;m<i.data.length;m++)f(m)}}]),t}(m.default)},"./tools/annotation/RectangleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return I}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),j=n("./util/calculateSUV.js"),x=n("./util/getROITextBoxCoords.js"),y=n("./util/numbersWithCommas.js"),T=n("./util/throttle.js"),w=n("./tools/cursors/index.js"),C=n("./util/logger.js"),O=n("./util/getPixelSpacing.js"),E=n("./store/index.js"),M=Object(C.getLogger)("tools:annotation:RectangleRoiTool"),I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"RectangleRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:w.rectangleRoiCursor};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(T.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};M.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var o=t&&t.handles&&t.handles.start&&t.handles.end;if(o||M.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!o||!1===t.visible)return!1;var r="mouse"===a?15:25,i=g.default.cornerstone.pixelToCanvas(e,t.handles.start),l=g.default.cornerstone.pixelToCanvas(e,t.handles.end),s={left:Math.min(i.x,l.x),top:Math.min(i.y,l.y),width:Math.abs(i.x-l.x),height:Math.abs(i.y-l.y)};return g.default.cornerstoneMath.rect.distanceToPoint(s,n)<r}},{key:"updateCachedStats",value:function(e,t,n){var a=(g.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,o=Object(O.default)(e),r=function(e,t,n,a,o){var r,i=S(n.start,n.end),l=function(e,t){for(var n=0,a=0,o=0,r=0,i=e?e[0]:null,l=e?e[0]:null,s=t.top;s<t.top+t.height;s++)for(var u=t.left;u<t.left+t.width;u++)n+=e[r],a+=e[r]*e[r],i=Math.min(i,e[r]),l=Math.max(l,e[r]),o++,r++;if(0===o)return{count:o,mean:0,variance:0,stdDev:0,min:0,max:0};var d=n/o,c=a/o-d*d;return{count:o,mean:d,variance:c,stdDev:Math.sqrt(c),min:i,max:l}}(g.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),i);return"PT"===a&&(r={mean:Object(j.default)(e,l.mean,!0)||0,stdDev:Object(j.default)(e,l.stdDev,!0)||0}),{area:i.width*(o.colPixelSpacing||1)*(i.height*(o.rowPixelSpacing||1))||0,perimeter:2*i.width*(o.colPixelSpacing||1)+2*i.height*(o.rowPixelSpacing||1),count:l.count||0,mean:l.mean||0,variance:l.variance||0,stdDev:l.stdDev||0,min:l.min||0,max:l.max||0,meanStdDevSUV:r}}(e,t,n.handles,a,o);n.cachedStats=r,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(h.getToolState)(e.currentTarget,this.name);if(n){var a=e.detail,o=a.image,r=a.element,i=v.default.getToolWidth(),l=Object(E.getModule)("globalConfiguration").configuration.lineDash,s=this.configuration,u=s.handleRadius,d=s.drawHandlesOnHover,c=s.hideHandlesIfMoving,f=s.renderDashed,m=Object(b.getNewContext)(a.canvasContext.canvas),j=Object(O.default)(o),y=j.rowPixelSpacing,T=j.colPixelSpacing,w=(g.default.cornerstone.metaData.get("generalSeriesModule",o.imageId)||{}).modality,C=y&&T;Object(b.draw)(m,(function(e){for(var s=0;s<n.data.length;s++){var g=n.data[s];if(!1!==g.visible){var m=p.default.getColorIfActive(g),h={color:m,handleRadius:u,drawHandlesIfActive:d,hideHandlesIfMoving:c};Object(b.setShadow)(e,t.configuration);var v={color:m};if(f&&(v.lineDash=l),Object(b.drawRect)(e,r,g.handles.start,g.handles.end,v,"pixel",g.handles.initialRotation),t.configuration.drawHandles&&Object(b.drawHandles)(e,a,g.handles,h),!0===g.invalidated&&(g.cachedStats?t.throttledUpdateCachedStats(o,r,g):t.updateCachedStats(o,r,g)),!g.handles.textBox.hasMoved){var j=Object(x.default)(a.viewport,g.handles);Object.assign(g.handles.textBox,j)}var y=D(e,o.color,g.cachedStats,w,C,t.configuration);g.unit=_(w,t.configuration.showHounsfieldUnits),Object(b.drawLinkedTextBox)(e,r,g.handles.textBox,y,g.handles,(function(e){return n=(t=S(e.start,e.end)).left,a=t.top,[{x:n+(o=t.width)/2,y:a},{x:n,y:a+(r=t.height)/2},{x:n+o/2,y:a+r},{x:n+o,y:a+r/2}];var t,n,a,o,r}),m,i,10,!0)}}}))}}}]),t}(m.default);function S(e,t){return{left:Math.min(e.x,t.x),top:Math.min(e.y,t.y),width:Math.abs(e.x-t.x),height:Math.abs(e.y-t.y)}}function P(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(y.default)(e.toFixed(2))).concat(n)}function _(e,t){return"CT"===e&&!1!==t?"HU":""}function D(e,t,n,a,o){var r=n.area,i=n.mean,l=n.stdDev,s=n.min,u=n.max,d=n.meanStdDevSUV,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=c.showMinMax||!1,g=[],m=[];if(!t){var h=d&&0!==d.mean,v=_(a,c.showHounsfieldUnits),p="Mean: ".concat(Object(y.default)(i.toFixed(2))," ").concat(v),b="Std Dev: ".concat(Object(y.default)(l.toFixed(2))," ").concat(v);if(h){for(var j=" SUV: ",x="".concat(j).concat(Object(y.default)(d.mean.toFixed(2))),T="".concat(j).concat(Object(y.default)(d.stdDev.toFixed(2))),w=Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(p).width<w;)p+=" ";m.push("".concat(p).concat(x)),m.push("".concat(b,"     ").concat(T))}else m.push("".concat(p)),m.push("".concat(b));if(f){for(var C="Min: ".concat(s," ").concat(v),O="Max: ".concat(u," ").concat(v),E=h?Math.floor(e.measureText("".concat(b,"     ")).width):Math.floor(e.measureText("".concat(p,"     ")).width);e.measureText(C).width<E;)C+=" ";m.push("".concat(C).concat(O))}}return g.push(P(r,o)),m.forEach((function(e){return g.push(e)})),g}},"./tools/annotation/TextMarkerTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./tools/base/BaseAnnotationTool.js"),v=n("./externalModules.js"),p=n("./util/pointInsideBoundingBox.js"),b=n("./stateManagement/toolColors.js"),j=n("./drawing/index.js"),x=n("./drawing/drawTextBox.js"),y=n("./stateManagement/toolState.js"),T=n("./tools/cursors/index.js"),w=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"TextMarker",supportedInteractionTypes:["Mouse","Touch"],configuration:{markers:[],current:"",ascending:!0,loop:!1,changeTextCallback:C},svgCursor:T.textMarkerCursor};return(e=s()(this,d()(t).call(this,n,a))).touchPressCallback=e._changeText.bind(f()(e)),e.doubleClickCallback=e._changeText.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){var t=this.configuration;if(t.current){var n={visible:!0,active:!0,text:t.current,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},a={left:0,top:0,width:e.image.width,height:e.image.height};if(v.default.cornerstoneMath.point.insideRect(n.handles.end,a)){var o=t.markers.indexOf(t.current);return(o+=t.ascending?1:-1)>=t.markers.length?o=t.loop?0:-1:o<0&&(o=t.loop?t.markers.length:-1),t.current=t.markers[o],n}}}},{key:"pointNearTool",value:function(e,t,n){if(!1===t.visible)return!1;if(t.handles.end.boundingBox){var a=v.default.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,n),o=Object(p.default)(t.handles.end,n);return a<10||o}}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(e){var t=e.detail,n=this.configuration,a=Object(y.getToolState)(t.element,this.name);if(a)for(var o=Object(j.getNewContext)(t.canvasContext.canvas),r=function(e){var r=a.data[e];if(!1===r.visible)return"continue";var i=b.default.getColorIfActive(r);Object(j.draw)(o,(function(e){Object(j.setShadow)(e,n);var a=v.default.cornerstone.pixelToCanvas(t.element,r.handles.end);r.handles.end.boundingBox=Object(x.default)(e,r.text,a.x,a.y-10,i,{centering:{x:!0,y:!0}})}))},i=0;i<a.data.length;i++)r(i)}},{key:"_changeText",value:function(e){var t,n=e.detail,a=n.element,o=n.currentPoints;function r(e,t,n){!0===n?Object(y.removeToolState)(a,this.name,e):e.text=t,e.active=!1,v.default.cornerstone.updateImage(a)}var i=this.configuration,l=o.canvas,s=Object(y.getToolState)(a,this.name);if(s)for(var u=0;u<s.data.length;u++)if(t=s.data[u],this.pointNearTool(a,t,l))return t.active=!0,v.default.cornerstone.updateImage(a),i.changeTextCallback(t,n,r),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation()}}]),t}(h.default),C=function(e,t,n){n(e,prompt("Change your annotation:"))}},"./tools/annotation/bidirectionalTool/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./events.js"),r=n("./manipulators/index.js"),i=n("./manipulators/anyHandlesOutsideImage.js"),l=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),u=n("./util/getActiveTool.js"),d=n("./tools/annotation/BidirectionalTool.js"),c=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js");t.default=function(e,t){var n=this,g=e.detail,m=g.element,h=g.image,v=g.buttons,p=this.configuration;if(!f(h)){var b=this.createNewMeasurement(g),j=function(){b.active=!1,a.default.cornerstone.updateImage(m)};Object(l.addToolState)(m,this.name,b),a.default.cornerstone.updateImage(m);var x=(new Date).getTime(),y=b.handles,T=y.end,w=y.perpendicularStart;Object(r.moveNewHandle)(g,this.name,b,T,{},t,(function(e){if(e){var r=b.handles,f=b.longestDiameter,y=b.shortestDiameter,T=Object(i.default)(g,r),C=parseFloat(f)||0,O=parseFloat(y)||0,E=C<1||O<1,M=(new Date).getTime()-x<150;T||E||M?(b.cancelled=!0,Object(l.removeToolState)(m,n.name,b)):p.getMeasurementLocationCallback(b,g,j),Object(c.default)(g,b),w.locked=!1,b.invalidated=!0,a.default.cornerstone.updateImage(m);var I=Object(u.default)(m,v,t);I instanceof d.default&&I.updateCachedStats(h,m,b);var S={toolName:n.name,toolType:n.name,element:m,measurementData:b};Object(s.default)(m,o.default.MEASUREMENT_MODIFIED,S),Object(s.default)(m,o.default.MEASUREMENT_COMPLETED,S)}else Object(l.removeToolState)(m,n.name,b)}))}};var f=function(e){var t=a.default.cornerstone.metaData.get("imagePlaneModule",e.imageId),n=e.rowPixelSpacing,o=e.columnPixelSpacing;return t&&(n=t.rowPixelSpacing||t.rowImagePixelSpacing,o=t.columnPixelSpacing||t.colImagePixelSpacing),!n||!o}},"./tools/annotation/bidirectionalTool/createNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object.assign({x:e,y:t,index:n,drawnIndependently:!1,allowedOutsideImage:!1,highlight:!0,active:!1},a)};t.default=function(e){var t=e.currentPoints.image,n=t.x,o=t.y;return{toolName:this.name,toolType:this.name,isCreating:!0,visible:!0,active:!0,invalidated:!0,handles:{start:a(n,o,0),end:a(n,o,1,{active:!0}),perpendicularStart:a(n,o,2,{locked:!0}),perpendicularEnd:a(n,o,3),textBox:a(n-50,o-70,null,{highlight:!1,hasMoved:!0,active:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0})},longestDiameter:0,shortestDiameter:0}}},"./tools/annotation/bidirectionalTool/handleSelectedCallback.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";"touch"===a?this.handleSelectedTouchCallback(e):this.handleSelectedMouseCallback(e)}},"./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n("./externalModules.js"),i=n("./events.js"),l=n("./stateManagement/toolState.js"),s=n("./manipulators/anyHandlesOutsideImage.js"),u=n("./manipulators/getHandleNearImagePoint.js"),d=n("./manipulators/index.js"),c=n("./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js"),f=n("./tools/annotation/bidirectionalTool/invertHandles.js"),g=n("./store/setToolCursor.js"),m=n("./util/getProximityThreshold.js");t.default=function(e){var t,n=this,a=e.detail,b=a.element,j=Object(m.default)("mouse",this.name),x=function(e){t.invalidated=!0,Object(s.default)(a,t.handles)&&Object(l.removeToolState)(b,n.name,t),e&&(e.moving=!1,e.selected=!0),Object(g.setToolCursor)(n.element,n.svgCursor),r.default.cornerstone.updateImage(b),b.addEventListener(i.default.MOUSE_MOVE,n._moveCallback),b.addEventListener(i.default.TOUCH_START,n._moveCallback)},y=a.startPoints.canvas,T=Object(l.getToolState)(e.currentTarget,this.name);if(T){for(var w=function(o){t=T.data[o];var r=[b,t.handles,y,j],l=u.default.apply(void 0,r);if(l)return b.removeEventListener(i.default.MOUSE_MOVE,n._moveCallback),b.removeEventListener(i.default.TOUCH_START,n._moveCallback),t.active=!0,h(t.handles),l.moving=!0,(l=Object(f.default)(a,t,l)).hasBoundingBox||Object(g.hideToolCursor)(n.element),Object(c.default)(a,n.name,t,l,(function(){return x(l)})),p(e),{v:!0}},C=0;C<T.data.length;C++){var O=w(C);if("object"===o()(O))return O.v}var E=function(e){return function(){v(e,!1),x()}};for(C=0;C<T.data.length;C++)if(t=T.data[C],this.pointNearTool(b,t,y,"mouse")){b.removeEventListener(i.default.MOUSE_MOVE,this._moveCallback),b.removeEventListener(i.default.TOUCH_START,this._moveCallback),t.active=!0,h(t.handles),v(t.handles,!0);var M=E(t.handles);return Object(d.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"mouse",M),p(e),!0}}};var h=function(e){var t=!1;return Object.keys(e).forEach((function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)})),t},v=function(e,t){Object.keys(e).forEach((function(n){"textBox"!==n&&(e[n].moving=t)}))},p=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n("./externalModules.js"),i=n("./store/index.js"),l=n("./events.js"),s=n("./stateManagement/toolState.js"),u=n("./manipulators/anyHandlesOutsideImage.js"),d=n("./manipulators/getHandleNearImagePoint.js"),c=n("./manipulators/index.js"),f=n("./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js");t.default=function(e){var t,n=this,a=e.detail,v=a.element,p=i.state.touchProximity,b=function(e){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(s.removeToolState)(v,n.name,t),e&&(e.moving=!1,e.selected=!0),r.default.cornerstone.updateImage(v),v.addEventListener(l.default.TOUCH_DRAG,n._moveCallback)},j=a.startPoints.canvas,x=Object(s.getToolState)(e.currentTarget,this.name);if(x){for(var y=function(o){t=x.data[o];var r=[v,t.handles,j,p],i=d.default.apply(void 0,r);if(i)return v.removeEventListener(l.default.TOUCH_DRAG,n._moveCallback),t.active=!0,g(t.handles),i.moving=!0,Object(f.default)(a,n.name,t,i,(function(){return b(i)})),h(e),{v:!0}},T=0;T<x.data.length;T++){var w=y(T);if("object"===o()(w))return w.v}var C=function(e){return function(){m(e,!1),b()}};for(T=0;T<x.data.length;T++)if(t=x.data[T],this.pointNearTool(v,t,j,"touch")){v.removeEventListener(l.default.TOUCH_DRAG,this._moveCallback),t.active=!0,g(t.handles),m(t.handles,!0);var O=C(t.handles);return Object(c.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"touch",O),h(e),!0}}};var g=function(e){var t=!1;return Object.keys(e).forEach((function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)})),t},m=function(e,t){Object.keys(e).forEach((function(n){"textBox"!==n&&(e[n].moving=t)}))},h=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/invertHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var a=function(e,t,n){var a=e[n],o=t[n];e[n]=o,t[n]=a},o=function(e,t){a(e,t,"x"),a(e,t,"y"),a(e,t,"moving"),a(e,t,"hover"),a(e,t,"active"),a(e,t,"selected")};function r(e,t,n){var a=e.image,r=a.rowPixelSpacing,i=a.columnPixelSpacing,l=t.handles,s=l.start,u=l.end,d=l.perpendicularStart,c=l.perpendicularEnd,f=(s.x-u.x)*(i||1),g=(s.y-u.y)*(r||1),m=Math.sqrt(f*f+g*g),h=(d.x-c.x)*(i||1),v=(d.y-c.y)*(r||1);return(Math.sqrt(h*h+v*v)||0)>m?(o(s,u),o(s,d),o(u,c),Object.values(l).find((function(e){return!0===e.moving}))):n}},"./tools/annotation/bidirectionalTool/mouseMoveCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./stateManagement/toolCoordinates.js"),r=n("./manipulators/getHandleNearImagePoint.js"),i=n("./stateManagement/toolState.js");t.default=function(e){var t=this,n=e.detail,l=n.element;o.default.setCoords(n);var s=Object(i.getToolState)(l,this.name);if(s){for(var u=!1,d=function(e){var a=n.currentPoints.canvas,o=s.data[e],i=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,o=Object(r.default)(e,t,n,a),i=!1;return Object.keys(t).forEach((function(e){if("textBox"!==e){var n=t[e],a=n===o;n.active!==a&&(i=!0),n.active=a}})),i}(l,o.handles,a);Object.keys(o.handles).forEach((function(e){if("textBox"!==e){var t=o.handles[e];t.hover=t.active}})),i&&(u=!0);var d=t.pointNearTool(l,o,a,"mouse"),c=d&&!o.active,f=!d&&o.active;(c||f)&&(o.active=!o.active,u=!0)},c=0;c<s.data.length;c++)d(c);!0===u&&a.default.cornerstone.updateImage(l)}}},"./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var a=n("./externalModules.js"),o=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function r(e,t){return{start:e,end:t}}function i(e,t,n){var i=a.default.cornerstoneMath.lineSegment,l=e.handles,s=l.start,u=l.end,d=l.perpendicularStart,c=l.perpendicularEnd,f=t.image,g=f.columnPixelSpacing,m=void 0===g?1:g,h=f.rowPixelSpacing,v=void 0===h?1:h,p=r(s,u),b=r(d,c),j=i.intersectLine(p,b);return{columnPixelSpacing:m,rowPixelSpacing:v,start:s,end:u,perpendicularStart:d,perpendicularEnd:c,longLine:p,intersection:j,distanceToFixed:Object(o.default)(m,v,n,j),fixedPoint:n}}},"./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./store/index.js"),r=n("./events.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),l=n("./util/getActiveTool.js"),s=n("./tools/base/BaseAnnotationTool.js");t.default=function(e,t,n,u,d,c){var f=e.element,g=e.image,m=e.buttons,h={x:u.x-e.currentPoints.image.x,y:u.y-e.currentPoints.image.y},v=function(e){var o=e.detail;u.hasMoved=!0,void 0===u.index||null===u.index?(u.x=o.currentPoints.image.x+h.x,u.y=o.currentPoints.image.y+h.y):Object(i.default)(u,o,n,h),c&&(u.x=Math.max(u.x,0),u.x=Math.min(u.x,o.image.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,o.image.height)),n.invalidated=!0,a.default.cornerstone.updateImage(f);var d=Object(l.default)(f,m,"mouse");d instanceof s.default&&d.updateCachedStats(g,f,n);var v={toolName:t,toolType:t,element:f,measurementData:n};a.default.cornerstone.triggerEvent(f,r.default.MEASUREMENT_MODIFIED,v)};u.active=!0,u.moving=!0,o.state.isToolLocked=!0,f.addEventListener(r.default.MOUSE_DRAG,v),f.addEventListener(r.default.TOUCH_DRAG,v);var p=a.default.cornerstone.getImage(f),b=function(){a.default.cornerstone.getImage(f).imageId!==p.imageId&&j()};f.addEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,b);var j=function e(){u.active=!1,o.state.isToolLocked=!1,f.removeEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,b),f.removeEventListener(r.default.MOUSE_DRAG,v),f.removeEventListener(r.default.MOUSE_UP,e),f.removeEventListener(r.default.MOUSE_CLICK,e),f.removeEventListener(r.default.TOUCH_DRAG,v),f.removeEventListener(r.default.TOUCH_DRAG_END,e),f.removeEventListener(r.default.TAP,e),a.default.cornerstone.updateImage(f),"function"==typeof d&&d()};f.addEventListener(r.default.MOUSE_UP,j),f.addEventListener(r.default.MOUSE_CLICK,j),f.addEventListener(r.default.TOUCH_DRAG_END,j),f.addEventListener(r.default.TAP,j)}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var a=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),r=n("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js");function i(e,t,n,i){var l=Object(o.default)(t,n,i),s=l.columnPixelSpacing,u=l.rowPixelSpacing,d=l.distanceToFixed,c=Object(a.default)(s,u,i,e);if(c<=d)return!1;var f=d/c,g={x:i.x+(e.x-i.x)*f,y:i.y+(e.y-i.y)*f},m=Object(r.default)(l,g);return t.handles.perpendicularStart.x=m.start.x,t.handles.perpendicularStart.y=m.start.y,t.handles.perpendicularEnd.x=m.end.x,t.handles.perpendicularEnd.y=m.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var a=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),o=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function r(e,t){var n=e.columnPixelSpacing,r=e.rowPixelSpacing,i=e.start,l=e.perpendicularStart,s=e.perpendicularEnd,u=e.intersection,d=e.fixedPoint,c=Object(o.default)(n,r,l,u),f=Object(o.default)(n,r,s,u),g=Object(a.default)(n,r,d,t),m=d===i?1:-1,h=m*r,v=m*n;return{start:{x:t.x+g.y*c*h,y:t.y+g.x*c*v*-1},end:{x:t.x+g.y*f*h*-1,y:t.y+g.x*f*v}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function o(e,t){return Object(a.default)(e,t)?-1:1}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js");function o(e,t,n){var o=e.columnPixelSpacing,r=e.rowPixelSpacing,i=e.perpendicularEnd,l=e.fixedPoint,s=Number.MAX_SAFE_INTEGER,u=Object(a.default)(l,i)*s;return{start:t,end:{x:t.x+n.y*r*u,y:t.y+n.x*o*u*-1}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function o(e,t,n){return Object(a.default)(e,n)?t:n}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js":function(e,t,n){"use strict";function a(e,t){return e===t}n.r(t),n.d(t,"default",(function(){return a}))},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function o(e,t,n){return 0!==Object(a.default)(e,t,n.start,n.end)}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u}));var a=n("./externalModules.js"),o=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),r=n("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js"),l=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js"),s=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js");function u(e,t,n,u){var d=a.default.cornerstoneMath.lineSegment,c=Object(r.default)(t,n,u),f=c.columnPixelSpacing,g=c.rowPixelSpacing,m=c.start,h=c.longLine,v=c.intersection;if(!Object(i.default)(f,g,h))return!1;var p=Object(o.default)(f,g,m,v),b=Object(l.default)(c,e,p),j=d.intersectLine(h,b);if(!j)return!1;var x=Object(s.default)(c,j,b,p);return t.handles.perpendicularStart.x=x.start.x,t.handles.perpendicularStart.y=x.start.y,t.handles.perpendicularEnd.x=x.end.x,t.handles.perpendicularEnd.y=x.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var a=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),o=n.n(a),r=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js");function l(e,t,n,a){var l,s=e.columnPixelSpacing,u=e.rowPixelSpacing,d=e.fixedPoint,c=e.perpendicularStart,f=e.perpendicularEnd,g=e.distanceToFixed,m=Object(r.default)(d,f)*g,h=Object(i.default)(d,c,f)===c,v=h?"start":"end",p=h?"end":"start";return l={},o()(l,v,{x:n.start.x,y:n.start.y}),o()(l,p,{x:t.x+a.y*u*m,y:t.y+a.x*s*m*-1}),l}},"./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js"),r=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js");t.default=function(e,t,n,i){var l,s,u,d,c={},f={},g={x:t.currentPoints.image.x+i.x,y:t.currentPoints.image.y+i.y};0===e.index?Object(o.default)(g,n,t,n.handles.end)?(e.x=g.x,e.y=g.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):1===e.index?Object(o.default)(g,n,t,n.handles.start)?(e.x=g.x,e.y=g.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):2===e.index?(l=!1,c.start={x:n.handles.start.x,y:n.handles.start.y},c.end={x:n.handles.end.x,y:n.handles.end.y},f.start={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},f.end={x:g.x,y:g.y},(s=a.default.cornerstoneMath.lineSegment.intersectLine(c,f))||(f.end={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},s=a.default.cornerstoneMath.lineSegment.intersectLine(c,f),u=a.default.cornerstoneMath.point.distance(s,n.handles.start),d=a.default.cornerstoneMath.point.distance(s,n.handles.end),(!s||u<3||d<3)&&(l=!0)),l||Object(r.default)(g,n,t,n.handles.perpendicularEnd)||(t.currentPoints.image.x=n.handles.perpendicularStart.x,t.currentPoints.image.y=n.handles.perpendicularStart.y)):3===e.index&&(l=!1,c.start={x:n.handles.start.x,y:n.handles.start.y},c.end={x:n.handles.end.x,y:n.handles.end.y},f.start={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},f.end={x:g.x,y:g.y},(s=a.default.cornerstoneMath.lineSegment.intersectLine(c,f))||(f.end={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},s=a.default.cornerstoneMath.lineSegment.intersectLine(c,f),u=a.default.cornerstoneMath.point.distance(s,n.handles.start),d=a.default.cornerstoneMath.point.distance(s,n.handles.end),(!s||u<3||d<3)&&(l=!0)),l||Object(r.default)(g,n,t,n.handles.perpendicularStart)||(t.currentPoints.image.x=n.handles.perpendicularEnd.x,t.currentPoints.image.y=n.handles.perpendicularEnd.y))}},"./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./store/index.js"),r=n("./events.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),l=n("./util/getActiveTool.js"),s=n("./tools/base/BaseAnnotationTool.js"),u=[r.default.TOUCH_END,r.default.TOUCH_DRAG_END,r.default.TOUCH_PINCH,r.default.TOUCH_PRESS,r.default.TAP];t.default=function(e,t,n,d,c,f){var g=e.element,m=e.image,h=e.buttons,v={x:d.x-e.currentPoints.image.x,y:d.y-e.currentPoints.image.y},p=function(e){var o=e.detail;d.hasMoved=!0,void 0===d.index||null===d.index?(d.x=o.currentPoints.image.x+v.x,d.y=o.currentPoints.image.y+v.y):Object(i.default)(d,o,n,v),f&&(d.x=Math.max(d.x,0),d.x=Math.min(d.x,o.image.width),d.y=Math.max(d.y,0),d.y=Math.min(d.y,o.image.height)),n.invalidated=!0,a.default.cornerstone.updateImage(g);var u=Object(l.default)(g,h,"touch");u instanceof s.default&&u.updateCachedStats(m,g,n);var c={toolName:t,toolType:t,element:g,measurementData:n};a.default.cornerstone.triggerEvent(g,r.default.MEASUREMENT_MODIFIED,c)};d.active=!0,o.state.isToolLocked=!0,g.addEventListener(r.default.TOUCH_DRAG,p);var b=function e(){d.active=!1,o.state.isToolLocked=!1,g.removeEventListener(r.default.TOUCH_DRAG,p),u.forEach((function(t){g.removeEventListener(t,e)})),a.default.cornerstone.updateImage(g),"function"==typeof c&&c()};u.forEach((function(e){g.addEventListener(e,b)}))}},"./tools/annotation/bidirectionalTool/pointNearTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/getProximityThreshold.js"),o=n("./externalModules.js"),r=n("./util/pointInsideBoundingBox.js"),i=function(e,t,n,a){var r=o.default.cornerstone,i=o.default.cornerstoneMath,l={start:r.pixelToCanvas(e,t.perpendicularStart),end:r.pixelToCanvas(e,t.perpendicularEnd)};return i.lineSegment.distanceToPoint(l,n)<a};t.default=function(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",s=o.default.cornerstone,u=o.default.cornerstoneMath,d=t.handles,c={start:s.pixelToCanvas(e,d.start),end:s.pixelToCanvas(e,d.end)},f=u.lineSegment.distanceToPoint(c,n);if(Object(r.default)(d.textBox,n))return!0;var g=Object(a.default)(l,"Bidirectional");return!!i(e,d,n,g)||f<g}},"./tools/annotation/bidirectionalTool/renderToolData.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n("./drawing/drawHandles.js"),i=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js"),l=n("./store/index.js"),s=n("./stateManagement/toolStyle.js"),u=n("./stateManagement/toolColors.js"),d=n("./stateManagement/toolState.js"),c=n("./drawing/index.js"),f=n("./drawing/drawLinkedTextBox.js"),g=n("./util/getPixelSpacing.js");t.default=function(e){var t=this,n=e.detail,a=n.element,o=n.canvasContext,h=n.image,v=this.configuration,p=v.handleRadius,b=v.drawHandlesOnHover,j=v.hideHandlesIfMoving,x=v.renderDashed,y=Object(l.getModule)("globalConfiguration").configuration.lineDash,T=Object(d.getToolState)(a,this.name);if(T){var w=Object(g.default)(h),C=w.rowPixelSpacing,O=w.colPixelSpacing;if(C&&O)for(var E,M=Object(c.getNewContext)(o.canvas),I=s.default.getToolWidth(),S=function(e){var o=T.data[e];if(!1===o.visible)return"continue";E=u.default.getColorIfActive(o),!0===o.invalidated&&(o.longestDiameter&&o.shortestDiameter?t.throttledUpdateCachedStats(h,a,o):t.updateCachedStats(h,a,o)),Object(c.draw)(M,(function(e){Object(c.setShadow)(e,t.configuration);var l=o.handles,s=l.start,u=l.end,d=l.perpendicularStart,g=l.perpendicularEnd,h=l.textBox,v={color:E},T={color:E,strokeWidth:w};x&&(v.lineDash=y,T.lineDash=y),Object(c.drawLine)(e,a,s,u,v);var w=I;Object(i.default)(n,o),Object(c.drawLine)(e,a,d,g,T);var M={color:E,handleRadius:p,drawHandlesIfActive:b,hideHandlesIfMoving:j};t.configuration.drawHandles&&Object(r.default)(e,n,o.handles,M);var S=m(o,C,O);Object(f.default)(e,a,h,S,o.handles,(function(e){return[e.start,e.end,e.perpendicularStart,e.perpendicularEnd]}),E,I,10,!0)}))},P=0;P<T.data.length;P++)S(P)}};var m=function(e,t,n){var a=" mm";t&&n||(a=" pixels");var r=" L ".concat(e.longestDiameter).concat(a),i=" W ".concat(e.shortestDiameter).concat(a),l=e.labels;return l&&Array.isArray(l)?[].concat(o()(l),[r,i]):[r,i]}},"./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js":function(e,t,n){"use strict";function a(e,t){var n=t.rowPixelSpacing,a=t.colPixelSpacing,o=e.handles,r=o.start,i=o.end,l=o.perpendicularStart,s=o.perpendicularEnd,u=(r.x-i.x)*(a||1),d=(r.y-i.y)*(n||1),c=Math.sqrt(u*u+d*d),f=(l.x-s.x)*(a||1),g=(l.y-s.y)*(n||1),m=Math.sqrt(f*f+g*g);if(m||(m=0),m>c){var h=c;c=m,m=h}return{longestDiameter:c.toFixed(1),shortestDiameter:m.toFixed(1)}}n.r(t),n.d(t,"default",(function(){return a}))},"./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js":function(e,t,n){"use strict";function a(e,t,n,a){var o=(n.x-a.x)/t,r=(n.y-a.y)/e;return Math.sqrt(o*o+r*r)}n.r(t),n.d(t,"default",(function(){return a}))},"./tools/annotation/bidirectionalTool/utils/getLineVector.js":function(e,t,n){"use strict";function a(e,t,n,a){var o=(n.x-a.x)*e,r=(n.y-a.y)*t,i=Math.sqrt(o*o+r*r);return{x:o/i,y:r/i,length:i}}n.r(t),n.d(t,"default",(function(){return a}))},"./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js");function o(e,t){if(!t.handles.perpendicularStart.locked)return!1;var n,o,r,i,l=t.handles,s=l.start,u=l.end,d=e.image,c=d.columnPixelSpacing,f=void 0===c?1:c,g=d.rowPixelSpacing,m=void 0===g?1:g;if(s.x===u.x&&s.y===u.y)n=s.x,o=s.y,r=u.x,i=u.y;else{var h={x:(s.x+u.x)/2,y:(s.y+u.y)/2},v=Object(a.default)(f,m,s,u),p=v.length/2,b=p/(2*m),j=p/(2*f);n=h.x+j*v.y,o=h.y-b*v.x,r=h.x-j*v.y,i=h.y+b*v.x}return t.handles.perpendicularStart.x=n,t.handles.perpendicularStart.y=o,t.handles.perpendicularEnd.x=r,t.handles.perpendicularEnd.y=i,!0}},"./tools/annotation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/annotation/AngleTool.js"),o=n("./tools/annotation/ArrowAnnotateTool.js"),r=n("./tools/annotation/BidirectionalTool.js"),i=n("./tools/annotation/CircleRoiTool.js"),l=n("./tools/annotation/CobbAngleTool.js"),s=n("./tools/annotation/EllipticalRoiTool.js"),u=n("./tools/annotation/FreehandRoiTool.js"),d=n("./tools/annotation/LengthTool.js"),c=n("./tools/annotation/ProbeTool.js"),f=n("./tools/annotation/RectangleRoiTool.js"),g=n("./tools/annotation/TextMarkerTool.js");n.d(t,"AngleTool",(function(){return a.default})),n.d(t,"ArrowAnnotateTool",(function(){return o.default})),n.d(t,"BidirectionalTool",(function(){return r.default})),n.d(t,"CircleRoiTool",(function(){return i.default})),n.d(t,"CobbAngleTool",(function(){return l.default})),n.d(t,"EllipticalRoiTool",(function(){return s.default})),n.d(t,"FreehandRoiTool",(function(){return u.default})),n.d(t,"LengthTool",(function(){return d.default})),n.d(t,"ProbeTool",(function(){return c.default})),n.d(t,"RectangleRoiTool",(function(){return f.default})),n.d(t,"TextMarkerTool",(function(){return g.default})),t.default={AngleTool:a.default,ArrowAnnotateTool:o.default,BidirectionalTool:r.default,CircleRoiTool:i.default,CobbAngleTool:l.default,EllipticalRoiTool:s.default,FreehandRoiTool:u.default,LengthTool:d.default,ProbeTool:c.default,RectangleRoiTool:f.default,TextMarkerTool:g.default}},"./tools/base/BaseAnnotationTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),g=n("./tools/base/BaseTool.js"),m=n("./stateManagement/toolState.js"),h=n("./manipulators/handleActivator.js"),v=n("./util/findAndMoveHelpers.js"),p=n("./util/logger.js"),b=Object(p.getLogger)("baseAnnotationTool"),j=function(e){function t(){return o()(this,t),s()(this,d()(t).apply(this,arguments))}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){throw new Error("Method createNewMeasurement not implemented for ".concat(this.name,"."))}},{key:"pointNearTool",value:function(e,t,n){throw new Error("Method pointNearTool not implemented for ".concat(this.name,"."))}},{key:"distanceFromPoint",value:function(e,t,n){throw new Error("Method distanceFromPoint not implemented for ".concat(this.name,"."))}},{key:"renderToolData",value:function(e){throw new Error("renderToolData not implemented for ".concat(this.name,"."))}},{key:"mouseMoveCallback",value:function(e){for(var t=e.detail,n=t.element,a=t.currentPoints.canvas,o=Object(m.getToolState)(n,this.name),r=!1,i=0;i<o.data.length;i++){var l=o.data[i];!0===Object(h.default)(n,l.handles,a)&&(r=!0);var s=this.pointNearTool(n,l,a,"mouse")&&!l.active,u=!this.pointNearTool(n,l,a,"mouse")&&l.active;(s||u)&&(l.active=!l.active,r=!0)}return r}},{key:"handleSelectedCallback",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";Object(v.moveHandleNearImagePoint)(e,this,t,n,a)}},{key:"toolSelectedCallback",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";Object(v.moveAnnotation)(e,this,t,n)}},{key:"updateCachedStats",value:function(e,t,n){b.warn("updateCachedStats not implemented for ".concat(this.name,"."))}}]),t}(g.default);t.default=j},"./tools/base/BaseBrushTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./tools/base/BaseTool.js"),v=n("./events.js"),p=n("./externalModules.js"),b=n("./store/isToolActiveForElement.js"),j=n("./store/index.js"),x=n("./util/segmentation/index.js"),y=Object(j.getModule)("segmentation"),T=function(e){function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o()(this,t),a.configuration||(a.configuration={alwaysEraseOnClick:!1}),(n=s()(this,d()(t).call(this,e,a))).updateOnMouseMove=!0,n.hideDefaultCursor=!0,n._drawing=!1,n._drawingMouseUpCallback=n._drawingMouseUpCallback.bind(f()(n)),n}return m()(t,e),i()(t,[{key:"renderBrush",value:function(e){throw new Error("Method renderBrush not implemented for ".concat(this.name,"."))}},{key:"_paint",value:function(e){throw new Error("Method _paint not implemented for ".concat(this.name,"."))}},{key:"mouseDragCallback",value:function(e){var t=e.detail.currentPoints;this._lastImageCoords=t.image,this._drawing&&this._paint(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,n=t.element,a=t.currentPoints;return this._startPainting(e),this._lastImageCoords=a.image,this._drawing=!0,this._startListeningForMouseUp(n),this._paint(e),!0}},{key:"_startPainting",value:function(e){var t=e.detail,n=t.element,a=y.configuration,o=y.getters.labelmap2D(n),r=o.labelmap2D,i=o.labelmap3D,l=o.currentImageIdIndex,s=o.activeLabelmapIndex,u=this._isCtrlDown(t)||this.configuration.alwaysEraseOnClick;if(this.paintEventData={labelmap2D:r,labelmap3D:i,currentImageIdIndex:l,activeLabelmapIndex:s,shouldErase:u},a.storeHistory){var d=r.pixelData.slice();this.paintEventData.previousPixelData=d}}},{key:"_endPainting",value:function(e){for(var t=y.configuration,n=y.setters,a=this.paintEventData,o=a.labelmap2D,r=a.currentImageIdIndex,i=new Set(o.pixelData).values(),l=[],s=!1;!s;){var u=i.next();(s=u.done)||l.push(u.value)}if(o.segmentsOnLabelmap=l,t.storeHistory){var d=this.paintEventData.previousPixelData,c=o.pixelData,f={imageIdIndex:r,diff:Object(x.getDiffBetweenPixelData)(d,c)};n.pushState(this.element,[f])}Object(x.triggerLabelmapModifiedEvent)(this.element)}},{key:"mouseMoveCallback",value:function(e){var t=e.detail.currentPoints;this._lastImageCoords=t.image}},{key:"renderToolData",value:function(e){var t=e.detail.element;Object(b.default)(t,this.name)&&this.renderBrush(e)}},{key:"passiveCallback",value:function(e){try{p.default.cornerstone.updateImage(this.element)}catch(e){return}}},{key:"_drawingMouseUpCallback",value:function(e){var t=e.detail.element;this._endPainting(e),this._drawing=!1,this._mouseUpRender=!0,this._stopListeningForMouseUp(t)}},{key:"newImageCallback",value:function(e){this._drawing&&(this._endPainting(e),this._startPainting(e))}},{key:"_startListeningForMouseUp",value:function(e){e.removeEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),e.addEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.addEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),p.default.cornerstone.updateImage(e)}},{key:"_stopListeningForMouseUp",value:function(e){e.removeEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),p.default.cornerstone.updateImage(e)}},{key:"increaseBrushSize",value:function(){var e=y.configuration,t=y.setters,n=e.radius,a=Math.floor(1.2*n);a===n&&(a+=1),t.radius(a)}},{key:"decreaseBrushSize",value:function(){var e=y.configuration,t=y.setters,n=e.radius,a=Math.floor(.8*n);t.radius(a)}},{key:"_isCtrlDown",value:function(e){return e.event&&e.event.ctrlKey||e.ctrlKey}}]),t}(h.default);t.default=T},"./tools/base/BaseTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),s=n.n(l),u=n("./mixins/index.js"),d=n("./util/logger.js"),c=n("./util/deepmerge.js"),f=n("./store/setToolCursor.js"),g=n("./store/index.js"),m=Object(d.getLogger)("tools:base:BaseTool"),h=Object(g.getModule)("globalConfiguration"),v=function(){function e(t,n){i()(this,e),this.initialConfiguration=Object(c.default)(n,t);var a=this.initialConfiguration,o=a.name,r=a.strategies,l=a.defaultStrategy,s=a.configuration,u=a.supportedInteractionTypes,d=a.mixins,f=a.svgCursor;this.name=o,this.mode="disabled",this.element=void 0,this.supportedInteractionTypes=u||[],this.strategies=r||{},this.defaultStrategy=l||Object.keys(this.strategies)[0]||void 0,this.activeStrategy=this.defaultStrategy,f&&(this.svgCursor=f),this._options={},this._configuration=Object.assign({},s),this.updateOnMouseMove=!1,this.hideDefaultCursor=!1,d&&d.length&&this._applyMixins(d),this._cursors=Object.assign({},this.initialConfiguration.cursors);var g=this.defaultStrategy&&this._cursors[this.activeStrategy];g&&(this.svgCursor=g)}return s()(e,[{key:"mergeOptions",value:function(e){this._options=Object.assign({},this._options,e)}},{key:"clearOptions",value:function(){this._options={}}},{key:"applyActiveStrategy",value:function(e,t){return this.strategies[this.activeStrategy].call(this,e,t)}},{key:"_applyMixins",value:function(e){for(var t=0;t<e.length;t++){var n=u.default["".concat(e[t])];"object"===o()(n)?(Object.assign(this,n),"function"==typeof this.initializeMixin&&this.initializeMixin()):m.warn("".concat(this.name,": mixin ").concat(u.default[t]," does not exist."))}"function"===this.initializeMixin&&delete this.initializeMixin}},{key:"setActiveStrategy",value:function(e){this.activeStrategy=e,h.configuration.showSVGCursors&&this.changeCursor(this.element,e)}},{key:"changeCursor",value:function(e,t){if(e){var n=this._cursors[t];n&&(this.svgCursor=n,"active"===this.mode&&Object(f.setToolCursor)(e,n))}}},{key:"configuration",get:function(){return this._configuration},set:function(e){this._configuration=e}},{key:"options",get:function(){return this._options}}],[{key:"configuration",get:function(){}}]),e}();t.default=v},"./tools/base/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/base/BaseAnnotationTool.js"),o=n("./tools/base/BaseTool.js"),r=n("./tools/base/BaseBrushTool.js");n.d(t,"BaseAnnotationTool",(function(){return a.default})),n.d(t,"BaseBrushTool",(function(){return r.default})),n.d(t,"BaseTool",(function(){return o.default})),t.default={BaseAnnotationTool:a.default,BaseBrushTool:r.default,BaseTool:o.default}},"./tools/cursors/MouseCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("./stateManagement/toolColors.js"),s=n("./store/index.js").modules.cursor,u=function(){function e(t,n){o()(this,e),this.iconGroupString=t,this.options=Object.assign({},s.getters.defaultOptions(),n)}return i()(e,[{key:"getIconSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconSVGString(e)}},{key:"getIconWithPointerSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconWithPointerSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconWithPointerString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconWithPointerSVGString(e)}},{key:"_generateIconWithPointerSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.mousePointerGroupString,a=t.iconSize,o=t.viewBox,r=a/Math.max(o.x,o.y),i=16+a,l='\n        <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(i,'" height="').concat(i,'" viewBox="0 0 ').concat(i," ").concat(i,'"\n      >\n        <g>\n          ').concat(n,'\n        </g>\n        <g transform="translate(16, 16) scale(').concat(r,')">\n          ').concat(this.iconGroupString,"\n        </g>\n      </svg>");return this._injectColors(l,t)}},{key:"_generateIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.iconSize,a=t.viewBox,o='\n      <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(n,'" height="').concat(n,'" viewBox="0 0\n        ').concat(a.x," ").concat(a.y,'"\n      >\n        ').concat(this.iconGroupString,"\n      </svg>");return this._injectColors(o,t)}},{key:"_injectColors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.activeColor||l.default.getActiveColor(),a=t.toolColor||l.default.getToolColor(),o=t.fillColor||l.default.getFillColor();return e.replace(/ACTIVE_COLOR/g,"".concat(n)).replace(/TOOL_COLOR/g,"".concat(a)).replace(/FILL_COLOR/g,"".concat(o))}},{key:"mousePoint",get:function(){var e=this.options.mousePoint;return"".concat(e.x," ").concat(e.y)}}]),e}()},"./tools/cursors/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"angleCursor",(function(){return o})),n.d(t,"arrowAnnotateCursor",(function(){return r})),n.d(t,"bidirectionalCursor",(function(){return i})),n.d(t,"cobbAngleCursor",(function(){return l})),n.d(t,"circleRoiCursor",(function(){return s})),n.d(t,"ellipticalRoiCursor",(function(){return u})),n.d(t,"freehandRoiCursor",(function(){return d})),n.d(t,"freehandRoiSculptorCursor",(function(){return c})),n.d(t,"lengthCursor",(function(){return f})),n.d(t,"probeCursor",(function(){return g})),n.d(t,"rectangleRoiCursor",(function(){return m})),n.d(t,"textMarkerCursor",(function(){return h})),n.d(t,"crosshairsCursor",(function(){return v})),n.d(t,"eraserCursor",(function(){return p})),n.d(t,"magnifyCursor",(function(){return b})),n.d(t,"panCursor",(function(){return j})),n.d(t,"rotateCursor",(function(){return x})),n.d(t,"stackScrollCursor",(function(){return y})),n.d(t,"wwwcRegionCursor",(function(){return T})),n.d(t,"wwwcCursor",(function(){return w})),n.d(t,"zoomCursor",(function(){return C})),n.d(t,"freehandEraseInsideCursor",(function(){return _})),n.d(t,"freehandFillInsideCursor",(function(){return D})),n.d(t,"freehandEraseOutsideCursor",(function(){return L})),n.d(t,"freehandFillOutsideCursor",(function(){return k})),n.d(t,"segRectangleEraseInsideCursor",(function(){return A})),n.d(t,"segRectangleFillInsideCursor",(function(){return R})),n.d(t,"segRectangleEraseOutsideCursor",(function(){return H})),n.d(t,"segRectangleFillOutsideCursor",(function(){return B})),n.d(t,"segCircleEraseInsideCursor",(function(){return U})),n.d(t,"segCircleFillInsideCursor",(function(){return F})),n.d(t,"segCircleEraseOutsideCursor",(function(){return N})),n.d(t,"segCircleFillOutsideCursor",(function(){return V}));var a=n("./tools/cursors/MouseCursor.js"),o=new a.default('<path fill="ACTIVE_COLOR" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n        10l50 50q10 10 10 23z"\n      />',{viewBox:{x:1792,y:1792}}),r=new a.default('<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />\n  </g>',{viewBox:{x:24,y:24}}),i=new a.default('<g fill="ACTIVE_COLOR" stroke-width="3" stroke="ACTIVE_COLOR">\n    <path d="M27.63 3.21L3.12 28.81"></path>\n    <path d="M27.63 15.75L15.27 4.43"></path>\n    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>\n    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>\n    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>\n    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>\n  </g>',{viewBox:{x:48,y:48}}),l=new a.default('<g stroke="ACTIVE_COLOR" stroke-width="3">\n    <path d="M28.59 2.34L3.82 12.32"></path>\n    <path d="M28.59 29.66L3.82 19.68"></path>\n    <path stroke-dasharray="2" fill-opacity="0" d="M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63">\n    </path>\n  </g>',{viewBox:{x:32,y:32}}),s=new a.default('<circle stroke="ACTIVE_COLOR" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',{viewBox:{x:32,y:32}}),u=new a.default('<path stroke="ACTIVE_COLOR" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z"\n    />',{viewBox:{x:32,y:32}}),d=new a.default('\n  <g fill="ACTIVE_COLOR" stroke="ACTIVE_COLOR" stroke-width="2">\n    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>\n    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>\n    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>\n    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>\n    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>\n    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>\n    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>\n    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>\n    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>\n    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>\n    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>\n    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>\n    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>\n    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>\n    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>\n    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>\n    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>\n    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>\n    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>\n    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>\n    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>\n    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>\n    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>\n    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>\n    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>\n    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>\n    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>\n    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>\n    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>\n    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>\n  </g>',{viewBox:{x:18,y:18}}),c=new a.default('<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n      <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>\n      <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>\n      <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>\n      <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>\n      <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>\n      <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>\n      <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>\n      <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>\n      <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>\n      <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>\n      <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>\n      <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>\n      <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>\n      <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>\n      <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>\n      <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>\n      <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>\n      <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>\n      <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>\n      <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>\n      <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>\n      <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>\n      <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>\n      <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>\n      <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>\n      <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>\n      <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>\n      <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>\n      <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>\n      <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>\n      <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>\n      <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>\n    </g>',{viewBox:{x:18,y:18}}),f=new a.default('<g id="length-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />\n  </g>',{viewBox:{x:24,y:24}}),g=new a.default('<path fill="ACTIVE_COLOR" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z"\n  />',{viewBox:{x:1792,y:1792}}),m=new a.default('<path fill="ACTIVE_COLOR" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),h=new a.default('<path fill="ACTIVE_COLOR" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"\n  />',{viewBox:{x:1792,y:1792}}),v=new a.default('<path fill="ACTIVE_COLOR" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z"\n  />',{viewBox:{x:1792,y:1792}}),p=new a.default('<path transform="translate(0,1792) scale(1,-1)" fill="ACTIVE_COLOR" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n      0 69.5 20.5t47.5 54.5z"\n    />',{viewBox:{x:2048,y:1792}}),b=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />',{viewBox:{x:512,y:512}}),j=new a.default('<path fill="ACTIVE_COLOR" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n      45v448q0 42-39 59-13 5-25 5-26 0-45-19z"\n    />',{viewBox:{x:1792,y:1792}}),x=new a.default('<path fill="ACTIVE_COLOR" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n      39 17 39 59z"\n    />',{viewBox:{x:1792,y:1792}}),y=new a.default('<path fill="ACTIVE_COLOR" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z"\n      />',{viewBox:{x:24,y:28}}),T=new a.default('<path fill="ACTIVE_COLOR" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),w=new a.default('<path fill="ACTIVE_COLOR" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />\n    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="ACTIVE_COLOR" />',{viewBox:{x:18,y:18}}),C=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />\n    <path fill="ACTIVE_COLOR" transform="scale(0.22,0.22) translate(1400,0)" d="M1216\n      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z"\n    />',{viewBox:{x:640,y:512}}),O={x:127,y:60},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(e,'" x="80.19" y="25.03" width="47.14" height="15.85"/>')},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(e,'" x="80.19" y="25.03" width="47.14" height="15.85"/>\n      <rect fill="').concat(e,'" x="95.84" y="9.38" width="15.85" height="47.14"/>')},I='<path fill="ACTIVE_COLOR" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',S='<path fill="ACTIVE_COLOR" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',P='<path fill="ACTIVE_COLOR" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',_=new a.default("".concat(I," ").concat(E()),{viewBox:O}),D=new a.default("".concat(I," ").concat(M()),{viewBox:O}),L=new a.default("".concat(I," ").concat(E()),{viewBox:O}),k=new a.default("".concat(I," ").concat(M()),{viewBox:O}),A=new a.default("".concat(S," ").concat(E()),{viewBox:O}),R=new a.default("".concat(S," ").concat(M()),{viewBox:O}),H=new a.default("".concat(S," ").concat(E()),{viewBox:O}),B=new a.default("".concat(S," ").concat(M()),{viewBox:O}),U=new a.default("".concat(P," ").concat(E()),{viewBox:O}),F=new a.default("".concat(P," ").concat(M()),{viewBox:O}),N=new a.default("".concat(P," ").concat(E()),{viewBox:O}),V=new a.default("".concat(P," ").concat(M()),{viewBox:O})},"./tools/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/CrosshairsTool.js");n.d(t,"CrosshairsTool",(function(){return a.default}));var o=n("./tools/DoubleTapFitToWindowTool.js");n.d(t,"DoubleTapFitToWindowTool",(function(){return o.default}));var r=n("./tools/DragProbeTool.js");n.d(t,"DragProbeTool",(function(){return r.default}));var i=n("./tools/EraserTool.js");n.d(t,"EraserTool",(function(){return i.default}));var l=n("./tools/FreehandRoiSculptorTool.js");n.d(t,"FreehandRoiSculptorTool",(function(){return l.default}));var s=n("./tools/MagnifyTool.js");n.d(t,"MagnifyTool",(function(){return s.default}));var u=n("./tools/OverlayTool.js");n.d(t,"OverlayTool",(function(){return u.default}));var d=n("./tools/OrientationMarkersTool.js");n.d(t,"OrientationMarkersTool",(function(){return d.default}));var c=n("./tools/PanMultiTouchTool.js");n.d(t,"PanMultiTouchTool",(function(){return c.default}));var f=n("./tools/PanTool.js");n.d(t,"PanTool",(function(){return f.default}));var g=n("./tools/ReferenceLinesTool.js");n.d(t,"ReferenceLinesTool",(function(){return g.default}));var m=n("./tools/RotateTool.js");n.d(t,"RotateTool",(function(){return m.default}));var h=n("./tools/RotateTouchTool.js");n.d(t,"RotateTouchTool",(function(){return h.default}));var v=n("./tools/ScaleOverlayTool.js");n.d(t,"ScaleOverlayTool",(function(){return v.default}));var p=n("./tools/StackScrollMouseWheelTool.js");n.d(t,"StackScrollMouseWheelTool",(function(){return p.default}));var b=n("./tools/StackScrollMultiTouchTool.js");n.d(t,"StackScrollMultiTouchTool",(function(){return b.default}));var j=n("./tools/StackScrollTool.js");n.d(t,"StackScrollTool",(function(){return j.default}));var x=n("./tools/WwwcRegionTool.js");n.d(t,"WwwcRegionTool",(function(){return x.default}));var y=n("./tools/WwwcTool.js");n.d(t,"WwwcTool",(function(){return y.default}));var T=n("./tools/ZoomMouseWheelTool.js");n.d(t,"ZoomMouseWheelTool",(function(){return T.default}));var w=n("./tools/ZoomTool.js");n.d(t,"ZoomTool",(function(){return w.default}));var C=n("./tools/ZoomTouchPinchTool.js");n.d(t,"ZoomTouchPinchTool",(function(){return C.default})),t.default={CrosshairsTool:a.default,DoubleTapFitToWindowTool:o.default,DragProbeTool:r.default,EraserTool:i.default,FreehandRoiSculptorTool:l.default,MagnifyTool:s.default,OverlayTool:u.default,OrientationMarkersTool:d.default,PanMultiTouchTool:c.default,PanTool:f.default,ReferenceLinesTool:g.default,RotateTool:m.default,RotateTouchTool:h.default,ScaleOverlayTool:v.default,StackScrollMouseWheelTool:p.default,StackScrollMultiTouchTool:b.default,StackScrollTool:j.default,WwwcRegionTool:x.default,WwwcTool:y.default,ZoomMouseWheelTool:T.default,ZoomTool:w.default,ZoomTouchPinchTool:C.default}},"./tools/referenceLines/calculateReferenceLine.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/pointProjector.js");t.default=function(e,t){var n=Object(a.planePlaneIntersection)(e,t);if(n)return{start:Object(a.projectPatientPointToImagePlane)(n.start,e),end:Object(a.projectPatientPointToImagePlane)(n.end,e)}}},"./tools/referenceLines/renderActiveReferenceLine.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=n("./tools/referenceLines/calculateReferenceLine.js"),r=n("./stateManagement/toolColors.js"),i=n("./util/convertToVector3.js"),l=n("./drawing/index.js");t.default=function(e,t,n,s){var u=a.default.cornerstone,d=u.getEnabledElement(n).image,c=u.getEnabledElement(s).image;if(d&&c){var f=u.metaData.get("imagePlaneModule",d.imageId),g=u.metaData.get("imagePlaneModule",c.imageId);if(f&&g&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&g.rowCosines&&g.columnCosines&&g.imagePositionPatient&&f.frameOfReferenceUID===g.frameOfReferenceUID){f.rowCosines=Object(i.default)(f.rowCosines),f.columnCosines=Object(i.default)(f.columnCosines),f.imagePositionPatient=Object(i.default)(f.imagePositionPatient),g.rowCosines=Object(i.default)(g.rowCosines),g.columnCosines=Object(i.default)(g.columnCosines),g.imagePositionPatient=Object(i.default)(g.imagePositionPatient);var m=f.rowCosines.clone().cross(f.columnCosines),h=g.rowCosines.clone().cross(g.columnCosines),v=m.angleTo(h);if(!((v=Math.abs(v))<.5)){var p=Object(o.default)(f,g);if(p){var b=r.default.getActiveColor();e.setTransform(1,0,0,1,0,0),Object(l.draw)(e,(function(e){Object(l.drawLine)(e,t.element,p.start,p.end,{color:b})}))}}}}}},"./tools/segmentation/BrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./externalModules.js"),v=n("./tools/base/index.js"),p=n("./store/index.js"),b=n("./util/segmentation/index.js"),j=n("./util/logger.js"),x=(Object(j.getLogger)("tools:BrushTool"),Object(p.getModule)("segmentation")),y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Brush",supportedInteractionTypes:["Mouse","Touch"],configuration:{},mixins:["renderBrushMixin"]};return(e=s()(this,d()(t).call(this,n,a))).touchDragCallback=e._paint.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_paint",value:function(e){var t=x.configuration,n=e.detail,a=(n.element,n.image),o=a.rows,r=a.columns,i=n.currentPoints.image,l=i.x,s=i.y;if(!(l<0||l>r||s<0||s>o)){var u=t.radius,d=Object(b.getCircle)(u,o,r,l,s),c=this.paintEventData,f=c.labelmap2D,g=c.labelmap3D,m=c.shouldErase;Object(b.drawBrushPixels)(d,f.pixelData,g.activeSegmentIndex,r,m),h.default.cornerstone.updateImage(e.detail.element)}}}]),t}(v.BaseBrushTool)},"./tools/segmentation/CircleScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/segmentation/strategies/index.js"),g=n("./tools/cursors/index.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"CircleScissors",strategies:{FILL_INSIDE:f.fillInsideCircle,FILL_OUTSIDE:f.fillOutsideCircle,ERASE_OUTSIDE:f.eraseOutsideCircle,ERASE_INSIDE:f.eraseInsideCircle},cursors:{FILL_INSIDE:g.segCircleFillInsideCursor,FILL_OUTSIDE:g.segCircleFillOutsideCursor,ERASE_OUTSIDE:g.segCircleEraseOutsideCursor,ERASE_INSIDE:g.segCircleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:g.segCircleFillInsideCursor,mixins:["circleSegmentationMixin"]};return i()(this,s()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/CorrectionScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/cursors/index.js"),g=n("./tools/segmentation/strategies/index.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"CorrectionScissors",strategies:{CORRECTION:g.correction},cursors:{CORRECTION:f.freehandFillInsideCursor},defaultStrategy:"CORRECTION",supportedInteractionTypes:["Mouse","Touch"],svgCursor:f.freehandFillInsideCursor,mixins:["polylineSegmentationMixin"]};return i()(this,s()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/FreehandScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/cursors/index.js"),f=n("./tools/segmentation/strategies/index.js"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"FreehandScissors",strategies:{FILL_INSIDE:f.fillInsideFreehand,FILL_OUTSIDE:f.fillOutsideFreehand,ERASE_OUTSIDE:f.eraseOutsideFreehand,ERASE_INSIDE:f.eraseInsideFreehand},cursors:{FILL_INSIDE:c.freehandFillInsideCursor,FILL_OUTSIDE:c.freehandFillOutsideCursor,ERASE_OUTSIDE:c.freehandEraseOutsideCursor,ERASE_INSIDE:c.freehandEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:c.freehandFillInsideCursor,mixins:["freehandSegmentationMixin"]};return i()(this,s()(t).call(this,e,n))}return d()(t,e),t}(n("./tools/base/index.js").BaseTool)},"./tools/segmentation/RectangleScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/segmentation/strategies/index.js"),g=n("./tools/cursors/index.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"RectangleScissors",strategies:{FILL_INSIDE:f.fillInsideRectangle,FILL_OUTSIDE:f.fillOutsideRectangle,ERASE_OUTSIDE:f.eraseOutsideRectangle,ERASE_INSIDE:f.eraseInsideRectangle},cursors:{FILL_INSIDE:g.segRectangleFillInsideCursor,FILL_OUTSIDE:g.segRectangleFillOutsideCursor,ERASE_OUTSIDE:g.segRectangleEraseOutsideCursor,ERASE_INSIDE:g.segRectangleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],mixins:["rectangleSegmentationMixin"]};return i()(this,s()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/SphericalBrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(g),h=n("./externalModules.js"),v=n("./tools/base/BaseBrushTool.js"),p=n("./store/index.js"),b=n("./util/segmentation/index.js"),j=n("./stateManagement/toolState.js"),x=n("./util/logger.js"),y=Object(x.getLogger)("tools:SphericalBrushTool"),T=Object(p.getModule)("segmentation"),w=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"SphericalBrush",supportedInteractionTypes:["Mouse","Touch"],configuration:{alwaysEraseOnClick:!1},mixins:["renderBrushMixin"]};return(e=s()(this,d()(t).call(this,n,a))).touchDragCallback=e._paint.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_startPainting",value:function(e){var t,n=T.configuration,a=T.getters,o=e.detail,r=o.element,i=o.image,l=h.default.cornerstone,s=n.radius,u=i.rows,d=i.columns,c=Math.max(i.rowPixelSpacing,i.columnPixelSpacing),f=Object(j.getToolState)(r,"stack").data[0].imageIds,g=a.labelmap2D(r),m=g.labelmap2D,v=g.labelmap3D,p=g.currentImageIdIndex,b=g.activeLabelmapIndex,x=this._isCtrlDown(o)||this.configuration.alwaysEraseOnClick,w=l.metaData.get("imagePlaneModule",i.imageId);if(w){var C=w.imagePositionPatient;t=this._getImagesInRange(p,C,f,s,c)}else y.warn("No imagePlane metadata found for image, defaulting to circle brush application."),t=[{imageIdIndex:p,radiusOnImage:s}];if(this.paintEventData={labelmap2D:m,labelmap3D:v,currentImageIdIndex:p,activeLabelmapIndex:b,shouldErase:x,imagesInRange:t},n.storeHistory){for(var O=[],E=0;E<t.length;E++){var M=t[E].imageIdIndex,I=a.labelmap2DByImageIdIndex(v,M,u,d).pixelData.slice();O.push(I)}this.paintEventData.previousPixeldataForImagesInRange=O}}},{key:"_paint",value:function(e){var t=T.getters,n=e.detail,a=(n.element,n.image),o=a.rows,r=a.columns,i=n.currentPoints.image,l=i.x,s=i.y;if(!(l<0||l>r||s<0||s>o)){for(var u=this.paintEventData,d=u.labelmap3D,c=u.imagesInRange,f=u.shouldErase,g=0;g<c.length;g++){var m=c[g],v=m.imageIdIndex,p=m.radiusOnImage,j=Object(b.getCircle)(p,o,r,l,s),x=t.labelmap2DByImageIdIndex(d,v,o,r);Object(b.drawBrushPixels)(j,x.pixelData,d.activeSegmentIndex,r,f)}h.default.cornerstone.updateImage(e.detail.element)}}},{key:"_getImagesInRange",value:function(e,t,n,a,o){for(var r=a*o,i=[{imageIdIndex:e,radiusOnImage:a}],l=e+1;l<n.length;l++){var s=this._getRadiusOnImage(n[l],t,r,o);if(!s)break;i.push({imageIdIndex:l,radiusOnImage:s})}for(var u=e-1;u>=0;u--){var d=this._getRadiusOnImage(n[u],t,r,o);if(!d)break;i.push({imageIdIndex:u,radiusOnImage:d})}return i}},{key:"_getRadiusOnImage",value:function(e,t,n,a){var o=h.default.cornerstone.metaData.get("imagePlaneModule",e);if(o){var r=o.imagePositionPatient,i=Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2)+Math.pow(r[2]-t[2],2));if(!(i>n))return Math.floor(Math.sqrt(Math.pow(n,2)-Math.pow(i,2))/a)}else y.warn("Can't find imagePlane metadata for image, cancelling spherical brushing on: ".concat(e,","))}},{key:"_endPainting",value:function(e){for(var t=this.paintEventData,n=t.labelmap3D,a=t.imagesInRange,o=[],r=T.configuration,i=T.setters,l=0;l<a.length;l++){for(var s=a[l].imageIdIndex,u=n.labelmaps2D[s],d=new Set(u.pixelData).values(),c=[],f=!1;!f;){var g=d.next();(f=g.done)||c.push(g.value)}if(u.segmentsOnLabelmap=c,r.storeHistory){var m=this.paintEventData.previousPixeldataForImagesInRange[l],h=n.labelmaps2D[s].pixelData;o.push({imageIdIndex:s,diff:Object(b.getDiffBetweenPixelData)(m,h)})}}r.storeHistory&&i.pushState(this.element,o),Object(b.triggerLabelmapModifiedEvent)(this.element)}}]),t}(v.default)},"./tools/segmentation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/segmentation/BrushTool.js"),o=n("./tools/segmentation/SphericalBrushTool.js"),r=n("./tools/segmentation/FreehandScissorsTool.js"),i=n("./tools/segmentation/RectangleScissorsTool.js"),l=n("./tools/segmentation/CircleScissorsTool.js"),s=n("./tools/segmentation/CorrectionScissorsTool.js");n.d(t,"BrushTool",(function(){return a.default})),n.d(t,"SphericalBrushTool",(function(){return o.default})),n.d(t,"FreehandScissorsTool",(function(){return r.default})),n.d(t,"RectangleScissorsTool",(function(){return i.default})),n.d(t,"CircleScissorsTool",(function(){return l.default})),n.d(t,"CorrectionScissorsTool",(function(){return s.default})),t.default={BrushTool:a.default,SphericalBrushTool:o.default,CircleScissorsTool:l.default,CorrectionScissorsTool:s.default,FreehandScissorsTool:r.default,RectangleScissorsTool:i.default}},"./tools/segmentation/strategies/correction.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n("./tools/segmentation/strategies/index.js"),i=n("./util/segmentation/index.js"),l=n("./util/clip.js"),s=n("./util/isPointInImage.js"),u=n("./util/logger.js"),d=Object(u.getLogger)("util:segmentation:operations:correction");function c(e,t){var n=t.pixelData,a=t.segmentIndex,u=t.segmentationMixinType;if("freehandSegmentationMixin"===u){var c=function(e,t){for(var n=t.pixelData,a=t.points,o=e.detail.image,r=o.width,i=o.height,s=[],u=0;u<a.length;u++){var d=a[u],c=Math.floor(d.x),f=Math.floor(d.y);c=Object(l.default)(c,0,r-1),f=Object(l.default)(f,0,i-1);var g=s[s.length-1];g&&c===g.x&&f===g.y||s.push({x:c,y:f,segment:n[f*r+c]})}return s}(e,t),m=function(e,t){for(var n=!0,a=!0,o=0;o<e.length&&(e[o].segment===t?a=!1:n=!1,n||a);o++);return a?{isScissorOperation:!0,operation:"fillInsideFreehand"}:n?{isScissorOperation:!0,operation:"eraseInsideFreehand"}:{isScissorOperation:!1}}(c,a);if(m.isScissorOperation)"fillInsideFreehand"===m.operation?(d.warn("The line never intersects a segment."),Object(r.fillInsideFreehand)(e,t)):"eraseInsideFreehand"===m.operation&&(d.warn("The line is only ever inside the segment."),Object(r.eraseInsideFreehand)(e,t));else{var h=new Uint8Array(n.length),v=function(e,t){var n=e[0].segment===t,a=[];a.push({additive:!n,nodes:[]});for(var o=0,r=0;r<e.length;r++){var i=e[r];n?(a[o].nodes.push(i),i.segment!==t&&(o++,n=!n,a.push({additive:!0,nodes:[]}),a[o].nodes.push(e[r-1]),a[o].nodes.push(i))):(a[o].nodes.push(i),i.segment===t&&(o++,n=!n,a.push({additive:!1,nodes:[]}),a[o].nodes.push(e[r-1]),a[o].nodes.push(i)))}return a.pop(),a.shift(),a}(c,a);v.forEach((function(t){!function(e,t,n,a,r){var l=r.detail.image,u=l.width,c=l.height,m=e.nodes,h=e.additive,v=h?0:1,p=function(e){return e.y*u+e.x},b=function(e){return{x:e%u,y:Math.floor(e/u)}};h?d.warn("additive operation..."):d.warn("subtractive operation...");for(var j=function(e){for(var t=[],n=0;n<e.length-1;n++)t.push(e[n]),t.push.apply(t,o()(Object(i.getPixelPathBetweenPixels)(e[n],e[n+1])));t.push[e[e.length-1]];for(var a=[],r=[],l=0;l<t.length-1;l++){var s=(f=t[l],g=t[l+1],m=void 0,-1===(m={x:g.x-f.x,y:g.y-f.y}).x&&1===m.y?{left:{x:f.x-1,y:f.y-1},right:{x:f.x+1,y:f.y+1}}:0===m.x&&1===m.y?{left:{x:f.x-1,y:f.y},right:{x:f.x+1,y:f.y}}:1===m.x&&1===m.y?{left:{x:f.x-1,y:f.y+1},right:{x:f.x+1,y:f.y-1}}:1===m.x&&0===m.y?{left:{x:f.x,y:f.y+1},right:{x:f.x,y:f.y-1}}:1===m.x&&-1===m.y?{left:{x:f.x+1,y:f.y+1},right:{x:f.x-1,y:f.y-1}}:0===m.x&&-1===m.y?{left:{x:f.x+1,y:f.y},right:{x:f.x-1,y:f.y}}:-1===m.x&&-1===m.y?{left:{x:f.x+1,y:f.y-1},right:{x:f.x-1,y:f.y+1}}:-1===m.x&&0===m.y?{left:{x:f.x,y:f.y-1},right:{x:f.x,y:f.y+1}}:void d.error("Unable to find left and right paths for flood fill ",f,g,m)),u=s.left,c=s.right;a.push(u),r.push(c)}var f,g,m;return{pixelPath:t,leftPath:a,rightPath:r}}(m),x=j.pixelPath,y=j.leftPath,T=j.rightPath,w=x[0],C={xMin:w.x,xMax:w.x,yMin:w.y,yMax:w.y},O=0;O<n.length;O++)t[O]===a?(f(C,b(O)),n[O]=1):n[O]=0;for(var E=0;E<x.length;E++){var M=x[E];n[p(M)]=2,f(C,M)}!function(e,t,n){e.xMax=Math.min(e.xMax+2,n),e.xMin=Math.max(e.xMin-2,0),e.yMax=Math.min(e.yMax+2,t),e.yMin=Math.max(e.yMin-2,0)}(C,c,u);var I=C.xMin,S=C.xMax,P=C.yMin,_=C.yMax;function D(e,t){if(!(e>=S||e<I||t>=_||t<P))return n[t*u+e]}for(var L=0,k=0,A=0;A<y.length;A++){var R=y[A];n[p(R)]===v&&Object(s.default)(R,c,u)&&(L+=g(R,3,n,D,u));var H=T[A];n[p(H)]===v&&Object(s.default)(H,c,u)&&(k+=g(H,4,n,D,u))}if(0!==L&&0!==k){for(var B=h?a:0,U=L<k?3:4,F=0;F<n.length;F++)n[F]===U&&(t[F]=B);if(B===a)for(var N=0;N<x.length;N++)t[p(x[N])]=a;else for(var V=0;V<x.length;V++){var z=p(x[V]);t[z]===a&&(t[z]=0)}}}(t,n,h,a,e)}))}}else d.error("correction operation requires freehandSegmentationMixin operationData, recieved ".concat(u))}function f(e,t){var n=t.x,a=t.y;n<e.xMin&&(e.xMin=n),n>e.xMax&&(e.xMax=n),a<e.yMin&&(e.yMin=a),a>e.yMax&&(e.yMax=a)}function g(e,t,n,a,o){for(var r=Object(i.floodFill)(a,[e.x,e.y]).flooded,l=0;l<r.length;l++){var s=r[l];n[s[1]*o+s[0]]=t}return r.length}},"./tools/segmentation/strategies/eraseCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideCircle",(function(){return c})),n.d(t,"eraseOutsideCircle",(function(){return f}));var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(a),r=n("./util/ellipse/index.js"),i=n("./util/logger.js"),l=n("./util/segmentation/index.js"),s=n("./util/getCircleCoords.js"),u=Object(i.getLogger)("util:segmentation:operations:eraseInsideCircle");function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.segmentationMixinType;if("circleSegmentationMixin"===a){var i=e.detail,d=Object(l.getBoundingBoxAroundCircle)(e),c=o()(d,2),f=c[0],g=c[1],m=Object(s.default)(i.handles.start,i.handles.end);n?Object(l.eraseInsideShape)(e,t,(function(e){return Object(r.pointInEllipse)(m,e)}),f,g):Object(l.eraseOutsideShape)(e,t,(function(e){return Object(r.pointInEllipse)(m,e)}),f,g)}else u.error("eraseInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(a))}function c(e,t){d(e,t,!0)}function f(e,t){d(e,t,!1)}},"./tools/segmentation/strategies/eraseFreehand.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideFreehand",(function(){return d})),n.d(t,"eraseOutsideFreehand",(function(){return c}));var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(a),r=n("./util/segmentation/index.js"),i=n("./util/isPointInPolygon.js"),l=n("./util/logger.js"),s=Object(l.getLogger)("util:segmentation:operations:eraseInsideFreehand");function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,l=t.segmentationMixinType;if("freehandSegmentationMixin"===l){var u=e.detail.image,d=a.map((function(e){return[e.x,e.y]})),c=Object(r.getBoundingBoxAroundPolygon)(d,u),f=o()(c,2),g=f[0],m=f[1];n?Object(r.eraseInsideShape)(e,t,(function(e){return Object(i.default)([e.x,e.y],d)}),g,m):Object(r.eraseOutsideShape)(e,t,(function(e){return Object(i.default)([e.x,e.y],d)}),g,m)}else s.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(l))}function d(e,t){u(e,t,!0)}function c(e,t){u(e,t,!1)}},"./tools/segmentation/strategies/eraseRectangle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideRectangle",(function(){return u})),n.d(t,"eraseOutsideRectangle",(function(){return d}));var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(a),r=n("./util/logger.js"),i=n("./util/segmentation/index.js"),l=Object(r.getLogger)("util:segmentation:operations:eraseInsideRectangle");function s(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,r=t.segmentationMixinType;if("rectangleSegmentationMixin"===r){var s=e.detail,u=s.image,d=a.map((function(e){return[e.x,e.y]})),c=Object(i.getBoundingBoxAroundPolygon)(d,u),f=o()(c,2),g=f[0],m=f[1];n?Object(i.eraseInsideShape)(e,t,(function(){return!0}),g,m):Object(i.eraseOutsideBoundingBox)(e,t,g,m)}else l.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(r))}function u(e,t){s(e,t,!0)}function d(e,t){s(e,t,!1)}},"./tools/segmentation/strategies/fillCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideCircle",(function(){return c})),n.d(t,"fillOutsideCircle",(function(){return f}));var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(a),r=n("./util/segmentation/index.js"),i=n("./util/ellipse/index.js"),l=n("./util/getCircleCoords.js"),s=n("./util/logger.js"),u=Object(s.getLogger)("util:segmentation:operations:fillCircle");function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.segmentationMixinType;if("circleSegmentationMixin"===a){var s=e.detail,d=Object(r.getBoundingBoxAroundCircle)(e),c=o()(d,2),f=c[0],g=c[1],m=Object(l.default)(s.handles.start,s.handles.end);n?Object(r.fillInsideShape)(e,t,(function(e){return Object(i.pointInEllipse)(m,e)}),f,g):Object(r.fillOutsideShape)(e,t,(function(e){return Object(i.pointInEllipse)(m,e)}),f,g)}else u.error("fillInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(a))}function c(e,t){d(e,t,!0)}function f(e,t){d(e,t,!1)}},"./tools/segmentation/strategies/fillFreehand.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideFreehand",(function(){return d})),n.d(t,"fillOutsideFreehand",(function(){return c}));var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(a),r=n("./util/segmentation/index.js"),i=n("./util/isPointInPolygon.js"),l=n("./util/logger.js"),s=Object(l.getLogger)("util:segmentation:operations:fillInsideFreehand");function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,l=t.segmentationMixinType;if("freehandSegmentationMixin"===l){var u=e.detail.image,d=a.map((function(e){return[e.x,e.y]})),c=Object(r.getBoundingBoxAroundPolygon)(d,u),f=o()(c,2),g=f[0],m=f[1];n?Object(r.fillInsideShape)(e,t,(function(e){return Object(i.default)([e.x,e.y],d)}),g,m):Object(r.fillOutsideShape)(e,t,(function(e){return Object(i.default)([e.x,e.y],d)}),g,m)}else s.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(l))}function d(e,t){u(e,t,!0)}function c(e,t){u(e,t,!1)}},"./tools/segmentation/strategies/fillRectangle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideRectangle",(function(){return u})),n.d(t,"fillOutsideRectangle",(function(){return d}));var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(a),r=n("./util/segmentation/index.js"),i=n("./util/logger.js"),l=Object(i.getLogger)("util:segmentation:operations:fillInsideRectangle");function s(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,i=t.segmentationMixinType;if("rectangleSegmentationMixin"===i){var s=e.detail.image,u=a.map((function(e){return[e.x,e.y]})),d=Object(r.getBoundingBoxAroundPolygon)(u,s),c=o()(d,2),f=c[0],g=c[1];n?Object(r.fillInsideShape)(e,t,(function(){return!0}),f,g):Object(r.fillOutsideBoundingBox)(e,t,f,g)}else l.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(i))}function u(e,t){s(e,t,!0)}function d(e,t){s(e,t,!1)}},"./tools/segmentation/strategies/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/segmentation/strategies/correction.js");n.d(t,"correction",(function(){return a.default}));var o=n("./tools/segmentation/strategies/eraseFreehand.js");n.d(t,"eraseInsideFreehand",(function(){return o.eraseInsideFreehand})),n.d(t,"eraseOutsideFreehand",(function(){return o.eraseOutsideFreehand}));var r=n("./tools/segmentation/strategies/eraseRectangle.js");n.d(t,"eraseInsideRectangle",(function(){return r.eraseInsideRectangle})),n.d(t,"eraseOutsideRectangle",(function(){return r.eraseOutsideRectangle}));var i=n("./tools/segmentation/strategies/fillFreehand.js");n.d(t,"fillInsideFreehand",(function(){return i.fillInsideFreehand})),n.d(t,"fillOutsideFreehand",(function(){return i.fillOutsideFreehand}));var l=n("./tools/segmentation/strategies/fillRectangle.js");n.d(t,"fillInsideRectangle",(function(){return l.fillInsideRectangle})),n.d(t,"fillOutsideRectangle",(function(){return l.fillOutsideRectangle}));var s=n("./tools/segmentation/strategies/fillCircle.js");n.d(t,"fillInsideCircle",(function(){return s.fillInsideCircle})),n.d(t,"fillOutsideCircle",(function(){return s.fillOutsideCircle}));var u=n("./tools/segmentation/strategies/eraseCircle.js");n.d(t,"eraseInsideCircle",(function(){return u.eraseInsideCircle})),n.d(t,"eraseOutsideCircle",(function(){return u.eraseOutsideCircle}))},"./util/SaveAs.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=e.querySelector("canvas");if(a.msToBlob){var o=a.msToBlob();return window.navigator.msSaveBlob(o,t)}var r=document.createElement("a");if(r.download=t,r.href=a.toDataURL(n,1),document.createEvent){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(i)}else r.fireEvent&&r.fireEvent("onclick")}},"./util/angleBetweenPoints.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),r=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2));return{angle:180*Math.acos((Math.pow(a,2)+Math.pow(o,2)-Math.pow(r,2))/(2*a*o))/Math.PI,direction:(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)}}},"./util/calculateSUV.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");function o(e){return parseFloat(".".concat(e))}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=a.default.cornerstone,i=r.metaData.get("patientStudyModule",e.imageId),l=r.metaData.get("generalSeriesModule",e.imageId);if(i&&l){var s=l.modality;if("PT"===s){var u=n?t:t*e.slope+e.intercept,d=i.patientWeight;if(d){var c=r.metaData.get("petIsotopeModule",e.imageId);if(c){var f=c.radiopharmaceuticalInfo,g=f.radiopharmaceuticalStartTime,m=f.radionuclideTotalDose,h=f.radionuclideHalfLife,v=l.seriesTime;if(g&&m&&h&&v){var p=o(v.fractionalSeconds||0)+v.seconds+60*v.minutes+60*v.hours*60,b=o(g.fractionalSeconds||0)+g.seconds+60*g.minutes+60*g.hours*60,j=p-b,x=m*Math.exp(-j*Math.log(2)/h),y=u*d/x*1e3;return y}}}}}}},"./util/clip.js":function(e,t,n){"use strict";n.r(t),n.d(t,"clip",(function(){return i})),n.d(t,"clipToBox",(function(){return l})),n.d(t,"clipBoxToDisplayedArea",(function(){return u}));var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n("./externalModules.js");function i(e,t,n){return Math.min(Math.max(t,e),n)}function l(e,t){var n=t.left||0,a=t.top||0;e.x=i(e.x,n,n+t.width),e.y=i(e.y,a,a+t.height)}var s=function(e,t,n,a,o,r){r-o<a-n?(e[t]+=o-n,e[t]+=(r-o)/2,e[t]-=(a-n)/2):n<o?e[t]+=o-n:a>r&&(e[t]-=a-r)};function u(e,t){var n=r.default.cornerstone,a=n.pixelToCanvas,i=n.canvasToPixel,l=n.getViewport,u=n.getEnabledElement,d=n.getDisplayedArea,c=i(e,{x:t.left,y:t.top}),f=function(e,t){var n=function(t){return r.default.cornerstone.canvasToPixel(e,t)},a=t.top,i=t.left,l=t.width,s=t.height,u=[n({x:i,y:a}),n({x:i+l,y:a}),n({x:i,y:a+s}),n({x:i+l,y:a+s})],d=u.map((function(e){return e.x})),c=u.map((function(e){return e.y}));return{minX:Math.min.apply(Math,o()(d)),minY:Math.min.apply(Math,o()(c)),maxX:Math.max.apply(Math,o()(d)),maxY:Math.max.apply(Math,o()(c))}}(e,t),g=f.minX,m=f.minY,h=f.maxX,v=f.maxY,p=l(e),b=d(u(e).image,p),j=p.displayedArea?p.displayedArea:b,x=j.tlhc,y=j.brhc,T=x.y-1,w=x.x-1,C=y.y,O=y.x;s(c,"y",m,v,T,C),s(c,"x",g,h,w,O);var E=a(e,c);t.top=E.y,t.left=E.x}t.default=i},"./util/convertToVector3.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./externalModules.js");function o(e){var t=a.default.cornerstoneMath;if(e instanceof t.Vector3)return e;var n=Object.keys(e);return n.includes("x")&&n.includes("y")&&n.includes("z")?new t.Vector3(e.x,e.y,e.z):new t.Vector3(e[0],e[1],e[2])}},"./util/copyPoints.js":function(e,t,n){"use strict";function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.x,n=e.y;return{x:t,y:n}}n.r(t),t.default=function(e){return{page:a(e.page),image:a(e.image),client:a(e.client),canvas:a(e.canvas)}}},"./util/debounce.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/isObject.js");t.default=function(e,t,n){var o,r,i,l,s,u,d=0,c=!1,f=!1,g=!0,m=!t&&0!==t&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=o,a=r;return o=r=void 0,d=t,l=e.apply(a,n)}function v(e,t){return m?window.requestAnimationFrame(e):setTimeout(e,t)}function p(e){return d=e,s=v(j,t),c?h(e):l}function b(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-d>=i}function j(){var e=Date.now();if(b(e))return x(e);s=v(j,function(e){var n=e-d,a=t-(e-u);return f?Math.min(a,i-n):a}(e))}function x(e){return s=void 0,g&&o?h(e):(o=r=void 0,l)}function y(){for(var e=Date.now(),n=b(e),a=arguments.length,i=new Array(a),d=0;d<a;d++)i[d]=arguments[d];if(o=i,r=this,u=e,n){if(void 0===s)return p(u);if(f)return s=v(j,t),h(u)}return void 0===s&&(s=v(j,t)),l}return t=Number(t)||0,Object(a.default)(n)&&(c=Boolean(n.leading),i=(f="maxWait"in n)?Math.max(Number(n.maxWait)||0,t):i,g="trailing"in n?Boolean(n.trailing):g),y.cancel=function(){void 0!==s&&function(e){if(m)return window.cancelAnimationFrame(e);clearTimeout(e)}(s),d=0,o=u=r=s=void 0},y.flush=function(){return void 0===s?l:x(Date.now())},y.pending=function(){return void 0!==s},y}},"./util/debugLib/common.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a);t.default=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return a.colors[Math.abs(t)%a.colors.length]}function a(e){var n;function o(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(o.enabled){var i=o,l=Number(new Date),s=l-(n||l);i.diff=s,i.prev=n,i.curr=l,n=l,t[0]=a.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;u++;var o=a.formatters[n];if("function"==typeof o){var r=t[u];e=o.call(i,r),t.splice(u,1),u--}return e})),a.formatArgs.call(i,t);var d=i.log||a.log;d.apply(i,t)}}return o.namespace=e,o.enabled=a.enabled(e),o.useColors=a.useColors(),o.color=t(e),o.destroy=r,o.extend=i,"function"==typeof a.init&&a.init(o),a.instances.push(o),o}function r(){var e=a.instances.indexOf(this);return-1!==e&&(a.instances.splice(e,1),!0)}function i(e,t){var n=a(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function l(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(e){return e instanceof Error?e.stack||e.message:e},a.disable=function(){var e=[].concat(o()(a.names.map(l)),o()(a.skips.map(l).map((function(e){return"-".concat(e)})))).join(",");return a.enable(""),e},a.enable=function(e){var t;a.save(e),a.names=[],a.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^".concat(e.substr(1),"$"))):a.names.push(new RegExp("^".concat(e,"$"))));for(t=0;t<a.instances.length;t++){var r=a.instances[t];r.enabled=a.enabled(r.namespace)}},a.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=a.skips.length;t<n;t++)if(a.skips[t].test(e))return!1;for(t=0,n=a.names.length;t<n;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=n("../node_modules/ms/index.js"),Object.keys(e).forEach((function(t){a[t]=e[t]})),a.instances=[],a.names=[],a.skips=[],a.formatters={},a.selectColor=t,a.enable(a.load()),a}},"./util/debugLib/index.js":function(e,t,n){"use strict";n.r(t),function(e){var a=n("./util/debugLib/common.js"),o={formatArgs:function(e){if(e[0]="".concat((this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" "),"+").concat(r.humanize(this.diff)),this.useColors){var t="color: ".concat(this.color);e.splice(1,0,t,"color: inherit");var n=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(a=n))})),e.splice(a,0,t)}},save:function(e){try{e?o.storage.setItem("debug",e):o.storage.removeItem("debug")}catch(e){}},load:function(){var t;try{t=o.storage.getItem("debug")}catch(e){console.warn(e)}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t},useColors:function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},storage:function(){try{return localStorage}catch(e){}}(),colors:["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"]};o.log=console.debug||console.log||function(){};var r=Object(a.default)(o);r.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: ".concat(e.message)}},t.default=r}.call(this,n("../node_modules/process/browser.js"))},"./util/deepmerge.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=function(e){return e&&"object"===o()(e)&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)},i=function(e,t){var n;return t&&!0===t.clone&&r(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e},l=function(e,t,n){var a=e.slice();return t.forEach((function(t,o){void 0===a[o]?a[o]=i(t,n):r(t)?a[o]=u(e[o],t,n):-1===e.indexOf(t)&&a.push(i(t,n))})),a},s=function(e,t,n){var a={};return r(e)&&Object.keys(e).forEach((function(t){a[t]=i(e[t],n)})),Object.keys(t).forEach((function(o){r(t[o])&&e[o]?a[o]=u(e[o],t[o],n):a[o]=i(t[o],n)})),a},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=Array.isArray(t),o=n||{arrayMerge:l},r=o.arrayMerge||l;if(a)return Array.isArray(e)?r(e,t,n):i(t,n);var u=s(e,t,n);return Object.getPrototypeOf(e)!==Object.prototype&&Object.setPrototypeOf(u,Object.getPrototypeOf(e)),u};t.default=u},"./util/ellipse/calculateEllipseStatistics.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/ellipse/pointInEllipse.js");t.default=function(e,t){for(var n=0,o=0,r=0,i=0,l=null,s=null,u=t.top;u<t.top+t.height;u++)for(var d=t.left;d<t.left+t.width;d++){var c={x:d,y:u};Object(a.default)(t,c)&&(null===l&&(l=e[i],s=e[i]),n+=e[i],o+=e[i]*e[i],l=Math.min(l,e[i]),s=Math.max(s,e[i]),r++),i++}if(0===r)return{count:r,mean:0,variance:0,stdDev:0,min:0,max:0};var f=n/r,g=o/r-f*f;return{count:r,mean:f,variance:g,stdDev:Math.sqrt(g),min:l,max:s}}},"./util/ellipse/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/ellipse/calculateEllipseStatistics.js");n.d(t,"calculateEllipseStatistics",(function(){return a.default}));var o=n("./util/ellipse/pointInEllipse.js");n.d(t,"pointInEllipse",(function(){return o.default})),t.default={calculateEllipseStatistics:a.default,pointInEllipse:o.default}},"./util/ellipse/pointInEllipse.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.width/2,a=e.height/2;if(n<=0||a<=0)return!1;var o=e.left+n,r=e.top+a,i=t.x-o,l=t.y-r;return i*i/(n*n)+l*l/(a*a)<=1}},"./util/findAndMoveHelpers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"moveHandleNearImagePoint",(function(){return g})),n.d(t,"findHandleDataNearImagePoint",(function(){return m})),n.d(t,"moveAnnotation",(function(){return h}));var a=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),o=n.n(a),r=n("./store/index.js"),i=n("./manipulators/getHandleNearImagePoint.js"),l=n("./manipulators/index.js"),s=n("./util/getProximityThreshold.js"),u=n("./events.js"),d=n("./util/triggerEvent.js");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(n,!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e,t,n,a,o){n.active=!0,r.state.isToolLocked=!0,Object(l.moveHandle)(e.detail,t.name,n,a,t.options,o,(function(t){var a=e.detail.element,o=n.toolType||n.toolName,r={toolName:o,toolType:o,element:a,measurementData:f({},n,{active:!1})};Object(d.default)(a,u.default.MEASUREMENT_COMPLETED,r)})),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()},m=function(e,t,n,a){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"mouse",r=0;r<t.data.length;r++){var l=t.data[r],u=Object(i.default)(e,l.handles,a,Object(s.default)(o,n));if(u)return{handle:u,data:l}}},h=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";n.active=!0,r.state.isToolLocked=!0,Object(l.moveAllHandles)(e.detail,t.name,n,null,t.options,a,(function(){n.active=!1,r.state.isToolLocked=!1})),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./util/freehand/ClickedLineData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=function e(t,n){o()(this,e),this.toolIndex=t,this.handleIndexArray=n}},"./util/freehand/FreehandHandleData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];o()(this,e),this.x=t.x,this.y=t.y,this.highlight=n,this.active=a,this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("./stateManagement/toolState.js"),s=n("./externalModules.js"),u=n("./util/freehand/ClickedLineData.js"),d=function(){function e(t,n){o()(this,e),this._eventData=t,this._toolName=n}return i()(e,[{key:"findLine",value:function(){var e=this.findTool();if(null===e)return null;var t=this._getCloseLinesInTool(e);return t?this._findCorrectLine(e,t):null}},{key:"findTool",value:function(){return this._toolData=Object(l.getToolState)(this._eventData.element,this._toolName),this._mousePoint=this._eventData.currentPoints.canvas,this._toolData?this._nearestHandleToPointAllTools().toolIndex:null}},{key:"_nearestHandleToPointAllTools",value:function(){for(var e=this._toolData,t={toolIndex:null,handleIndex:null,distance:1/0},n=0;n<e.data.length;n++){var a=this._nearestHandleToPoint(n);null!==a&&a.distance<t.distance&&(t=a)}return t}},{key:"_nearestHandleToPoint",value:function(e){var t=this._eventData,n=this._toolData.data[e],a=n.handles.points;if(void 0===a)return null;if(!1===n.visible)return null;for(var o={toolIndex:e,handleIndex:null,distance:1/0},r=0;r<a.length;r++){var i=s.default.cornerstone.pixelToCanvas(t.element,a[r]),l=s.default.cornerstoneMath.point.distance(i,this._mousePoint);l<o.distance&&(o.handleIndex=r,o.distance=l)}return o}},{key:"_getCloseLinesInTool",value:function(t){for(var n=this._toolData.data[t].handles.points,a=[],o=0;o<n.length;o++){var r=e.getNextHandleIndex(o,n.length);this._distanceOfPointfromLine(n[o],n[r])<10&&a.push([o,r])}return a}},{key:"_findCorrectLine",value:function(e,t){for(var n=0;n<t.length;n++)if(this._pointProjectsToLineSegment(e,t[n]))return new u.default(e,t[n]);return null}},{key:"_pointProjectsToLineSegment",value:function(t,n){var a=this._eventData,o=this._toolData.data[t],r=o.handles.points;if(void 0!==o.handles.points){if(!1===o.visible)return!1;var i=r[n[0]],l=r[n[1]],s=e.getCanvasPointsFromHandles(i,l,a.element),u=e.getLineAsVector(s),d=this._getLineOriginToMouseAsVector(s),c=(d[0]*u[0]+d[1]*u[1])/u.magnitude;return c>0&&c<u.magnitude}}},{key:"_getLineOriginToMouseAsVector",value:function(e){return[this._mousePoint.x-e[0].x,this._mousePoint.y-e[0].y]}},{key:"_distanceOfPointfromLine",value:function(e,t){var n=this._eventData,a=s.default.cornerstone.pixelToCanvas(n.element,e),o=s.default.cornerstone.pixelToCanvas(n.element,t),r=this._mousePoint;return Math.abs((o.y-a.y)*r.x-(o.x-a.x)*r.y+o.x*a.y-o.y*a.x)/s.default.cornerstoneMath.point.distance(a,o)}}],[{key:"getCanvasPointsFromHandles",value:function(e,t,n){var a=[];return e.x<t.x?(a.push(s.default.cornerstone.pixelToCanvas(n,e)),a.push(s.default.cornerstone.pixelToCanvas(n,t))):(a.push(s.default.cornerstone.pixelToCanvas(n,t)),a.push(s.default.cornerstone.pixelToCanvas(n,e))),a}},{key:"getLineAsVector",value:function(e){var t=[e[1].x-e[0].x,e[1].y-e[0].y];return t.magnitude=s.default.cornerstoneMath.point.distance(e[0],e[1]),t}},{key:"getNextHandleIndex",value:function(e,t){return e<t-1?e+1:0}}]),e}()},"./util/freehand/addLine.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){t===e.length-1?e[t].lines.push(e[0]):e[t].lines.push(e[t+1])}},"./util/freehand/calculateFreehandStatistics.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/pointInFreehand.js");function o(e,t,n,o){Object(a.default)(e,t)&&(n.value+=o,n.squared+=o*o,n.count++)}t.default=function(e,t,n){var a={count:0,mean:0,variance:0,stdDev:0},r=function(e,t,n){for(var a={value:0,squared:0,count:0},r=0,i=t.top;i<t.top+t.height;i++)for(var l=t.left;l<t.left+t.width;l++)o(n,{x:l,y:i},a,e[r]),r++;return a}(e,t,n);return 0===r.count||(a.count=r.count,a.mean=r.value/r.count,a.variance=r.squared/r.count-a.mean*a.mean,a.stdDev=Math.sqrt(a.variance)),a}},"./util/freehand/freehandArea.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=0,a=e.length-1;t=t||1;for(var o=0;o<e.length;o++)n+=(e[a].x+e[o].x)*(e[a].y-e[o].y),a=o;return Math.abs(n*t/2)}},"./util/freehand/freehandIntersect.js":function(e,t,n){"use strict";function a(e,t,n,a){for(var i=e.length-1,l=0;l<e.length;l++)if(-1===a.indexOf(l)&&-1===a.indexOf(i)){if(o(t,n,r(e[i]),r(e[l])))return!0;i=l}else i=l;return!1}function o(e,t,n,a){var o=!1,r=[i(e,t,n),i(e,t,a),i(n,a,e),i(n,a,t)];return r[0]!==r[1]&&r[2]!==r[3]||((0===r[0]&&l(e,n,t)||0===r[1]&&l(e,a,t)||0===r[2]&&l(n,e,a)||0===r[3]&&l(n,t,a))&&(o=!0),o)}function r(e){return{x:e.x,y:e.y}}function i(e,t,n){var a=(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y);return 0===a?0:a>0?1:2}function l(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}n.r(t),t.default={newHandle:function(e,t){var n=t.length-1;return a(t,r(t[n]),r(e),[n])},end:function(e){var t=e.length-1;return a(e,r(e[t]),r(e[0]),[t,0])},modify:function(e,t){var n=r(e[t]),o=t-1;0===t&&(o=e.length-1);var i=r(e[o]);return!!a(e,n,i,[t,o])||a(e,n,i=r(e[o=t===e.length-1?0:t+1]),[t,o])}}},"./util/freehand/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/calculateFreehandStatistics.js"),o=n("./util/freehand/ClickedLineData.js"),r=n("./util/freehand/freehandArea.js"),i=n("./util/freehand/FreehandHandleData.js"),l=n("./util/freehand/freehandIntersect.js"),s=n("./util/freehand/FreehandLineFinder.js"),u=n("./util/freehand/insertOrDelete.js"),d=n("./util/freehand/pointInFreehand.js"),c=n("./util/freehand/addLine.js");t.default={calculateFreehandStatistics:a.default,ClickedLineData:o.default,freehandArea:r.default,FreehandHandleData:i.default,freehandIntersect:l.default,FreehandLineFinder:s.default,insertOrDelete:u.default,pointInFreehand:d.default,addLine:c.default}},"./util/freehand/insertOrDelete.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/FreehandLineFinder.js"),o=n("./util/freehand/FreehandHandleData.js"),r=n("./stateManagement/toolState.js"),i=n("./externalModules.js"),l=n("./util/freehand/addLine.js");function s(e,t){var n=Object(r.getToolState)(e.element,this.name);if(void 0!==n){var a=t.handleIndex,o=t.toolIndex,l=n.data[o],s=l.handles.points;s.length<=3||(a===s.length-1?(s[a-1].lines.pop(),s[a-1].lines.push(s[0])):0===a?(s[s.length-1].lines.pop(),s[s.length-1].lines.push(s[a+1])):(s[a-1].lines.pop(),s[a-1].lines.push(s[a+1])),s.splice(a,1),l.invalidated=!0,l.active=!0,l.highlight=!0,i.default.cornerstone.updateImage(e.element))}}function u(e,t){var n=Object(r.getToolState)(e.element,this.name);if(void 0!==n){var a=n.data[t.toolIndex],s=function(e){for(var t=e.handleIndexArray,n=1/0,a=t.includes(0),o=0;o<t.length;o++){var r=t[o];0!==r&&r<n&&(n=r)}return a&&1===n&&(n=0),++n}(t);if(s!==1/0){var u=new o.default(e.currentPoints.image),d=a.handles.points;d.splice(s,0,u),d[s-1].lines.pop(),d[s-1].lines.push(e.currentPoints.image),Object(l.default)(d,s),a.active=!0,a.highlight=!0,a.invalidated=!0,i.default.cornerstone.updateImage(e.element)}}}t.default=function(e,t){var n=e.detail;if(t&&null!==t.handleNearby){var o={toolIndex:t.toolIndex,handleIndex:t.handleNearby};s.call(this,n,o)}else{var r=new a.default(n,this.name).findLine();r&&u.call(this,n,r)}}},"./util/freehand/pointInFreehand.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){for(var n=!1,a=e.length-1,o=0;o<e.length;o++)r=t,i=e[o],l=e[a],s=void 0,u=void 0,d=void 0,s=r.y,u=i.y,d=l.y,!(u<s&&s<d||d<s&&s<u)||!function(e,t,n){if(t.x>e.x&&n.x>e.x)return!0;if(t.x===n.x)return e.x<t.x;if(t.x>n.x){var a=t;t=n,n=a}var o=function(e,t,n){var a=(n.y-t.y)/(n.x-t.x);return{value:t.y+a*(e.x-t.x),gradient:a}}(e,t,n);return Math.sign(o.gradient)*e.y>Math.sign(o.gradient)*o.value}(r,i,l)||(n=!n),a=o;var r,i,l,s,u,d;return n}},"./util/getActiveTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var a=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),r=n("./store/filterToolsUsableWithMultiPartTools.js");function i(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";if("touch"===i?n=(n=Object(o.default)(e,a.getters.touchTools())).filter((function(e){return e.options.isTouchActive})):(n=(n=Object(o.default)(e,a.getters.mouseTools())).filter((function(e){return Array.isArray(e.options.mouseButtonMask)&&t&&e.options.mouseButtonMask.includes(t)&&e.options.isMouseActive})),a.state.isMultiPartToolActive&&(n=Object(r.default)(n))),0!==n.length)return n[0]}},"./util/getCircleCoords.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./externalModules.js");function o(e,t){var n=(0,a.default.cornerstoneMath.point.distance)(e,t);return{left:Math.floor(Math.min(e.x-n,t.x)),top:Math.floor(Math.min(e.y-n,t.y)),width:2*n,height:2*n}}},"./util/getDefault.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return void 0===e?t:e}},"./util/getKeyPressData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var a=n("./store/index.js"),o=n("./externalModules.js");function r(e){var t=o.default.cornerstone,n=e.currentTarget,r=t.getEnabledElement(n);if(r&&r.image){var i=a.default.state.mousePositionImage;return{event:window.event||e,element:n,viewport:t.getViewport(n),image:r.image,currentPoints:{image:i,canvas:t.pixelToCanvas(n,i)},keyCode:e.keyCode,which:e.which}}}},"./util/getLuminance.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,o,r){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,l,s,u=a.default.cornerstone.getEnabledElement(e).image,d=[],c=0,f=u.getPixelData();if(u.color)for(l=0;l<r;l++)for(s=0;s<o;s++){var g=f[i=4*((l+n)*u.columns+(s+t))],m=f[i+1],h=f[i+2];d[c++]=.2126*g+.7152*m+.0722*h}else for(l=0;l<r;l++)for(s=0;s<o;s++)i=(l+n)*u.columns+(s+t),d[c++]=f[i]*u.slope+u.intercept;return d}},"./util/getMaxSimultaneousRequests.js":function(e,t,n){"use strict";var a;n.r(t),n.d(t,"getDefaultSimultaneousRequests",(function(){return s})),n.d(t,"getMaxSimultaneousRequests",(function(){return l})),n.d(t,"setMaxSimultaneousRequests",(function(){return i})),n.d(t,"getBrowserInfo",(function(){return r})),n.d(t,"isMobileDevice",(function(){return u}));var o={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function r(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE ".concat(e[1]||"")):"Chrome"===n[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}function i(e){a=e}function l(){return a||s()}function s(){var e=r().split(" "),t=e[0],n=e[1],a=o[t];return a?a[n]?a[n]:a.default:o.default}function u(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},"./util/getPixelSpacing.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./externalModules.js");function o(e){var t=a.default.cornerstone.metaData.get("imagePlaneModule",e.imageId);return t?{rowPixelSpacing:t.rowPixelSpacing||t.rowImagePixelSpacing,colPixelSpacing:t.columnPixelSpacing||t.colImagePixelSpacing}:{rowPixelSpacing:e.rowPixelSpacing,colPixelSpacing:e.columnPixelSpacing}}},"./util/getProximityThreshold.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./store/index.js");function o(e,t){var n=a.state.clickProximity,o=a.state.touchProximity,r=a.state.tools.find((function(e){return e.name===t}));return r&&r.configuration&&(n=r.configuration.clickProximity||n,o=r.configuration.touchProximity||o),"mouse"===e?n:o}},"./util/getRGBPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,o,r){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,l,s,u=a.default.cornerstone.getEnabledElement(e),d=[],c=0,f=u.image.getPixelData();if(u.image.color)for(l=0;l<r;l++)for(s=0;s<o;s++){var g=f[i=4*((l+n)*u.image.columns+(s+t))],m=f[i+1],h=f[i+2],v=f[i+3];d[c++]=g,d[c++]=m,d[c++]=h,d[c++]=v}return d}},"./util/getROITextBoxCoords.js":function(e,t,n){"use strict";function a(e,t){var n=function(e){var t=[e.start,e.end].sort((function(e,t){return e.x<t.x?-1:1})),n=[e.start,e.end].sort((function(e,t){return e.y<t.y?-1:1})),a=t[0],o=t[t.length-1];return{top:n[0],left:a,bottom:n[n.length-1],right:o}}(t),a=(n.left.x+n.right.x)/2,o=(n.top.y+n.bottom.y)/2,r={};return e.rotation>=0&&e.rotation<90&&(r.x=e.hflip?n.left.x:n.right.x,r.y=o),e.rotation>=90&&e.rotation<180&&(r.x=a,r.y=e.vflip?n.bottom.y:n.top.y),e.rotation>=180&&e.rotation<270&&(r.x=e.hflip?n.right.x:n.left.x,r.y=o),e.rotation>=270&&e.rotation<360&&(r.x=a,r.y=e.vflip?n.top.y:n.bottom.y),r}n.r(t),n.d(t,"default",(function(){return a}))},"./util/isEmptyObject.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return 0===Object.keys(e).length&&e.constructor===Object}},"./util/isObject.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a);t.default=function(e){var t=o()(e);return null!==e&&("object"===t||"function"===t)}},"./util/isPointInImage.js":function(e,t,n){"use strict";function a(e,t,n){var a=e.x,o=e.y;return a<n&&a>=0&&o<t&&o>=0}n.r(t),n.d(t,"default",(function(){return a}))},"./util/isPointInPolygon.js":function(e,t,n){"use strict";function a(e,t){for(var n=e[0],a=e[1],o=!1,r=0,i=t.length-1;r<t.length;i=r++){var l=t[r][0],s=t[r][1],u=t[i][0],d=t[i][1];s>a!=d>a&&n<(u-l)*(a-s)/(d-s)+l&&(o=!o)}return o}n.r(t),n.d(t,"default",(function(){return a}))},"./util/lineSegDistance.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,o){var r=a.default.cornerstone,i={start:r.pixelToCanvas(e,t),end:r.pixelToCanvas(e,n)};return a.default.cornerstoneMath.lineSegment.distanceToPoint(i,o)}},"./util/logger.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLogger",(function(){return i})),n.d(t,"enable",(function(){return l})),n.d(t,"disable",(function(){return s}));var a=n("./util/debugLib/index.js"),o="cornerstoneTools",r=Object(a.default)(o);r.enabled||(console.log("%cCornerstone Tools","background: #339955; padding: 4px; font-weight: bold; color: white"),console.info('run %clocalStorage.setItem("debug", "cornerstoneTools")%c to see console output',"background: #eaeaea; color: #333; font-family: monospace",""));var i=function(e){return{log:r.extend(e),warn:console.warn.bind(console),error:console.error.bind(console)}},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(o,":*");return a.default.enable(e)},s=function(){return a.default.disable()}},"./util/makeUnselectable.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.style.webkitUserSelect="none",e.style.webkitTouchCallout="none",e.style.mozUserSelect="none",e.style.msUserSelect="none",e.style.oUserSelect="none",e.style.khtmlUserSelect="none",e.style.userSelect="none",e.unselectable="on",e.oncontextmenu=function(){return!1},!0===t&&(e.style.pointerEvents="none")}},"./util/numbersWithCommas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},"./util/pointInsideBoundingBox.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){if(e.boundingBox)return a.default.cornerstoneMath.point.insideRect(t,e.boundingBox)}},"./util/pointProjector.js":function(e,t,n){"use strict";n.r(t),n.d(t,"projectPatientPointToImagePlane",(function(){return r})),n.d(t,"imagePointToPatientPoint",(function(){return i})),n.d(t,"planePlaneIntersection",(function(){return l})),n.d(t,"rotatePoint",(function(){return s}));var a=n("./externalModules.js"),o=n("./util/convertToVector3.js");function r(e,t){var n=Object(o.default)(t.rowCosines),a=Object(o.default)(t.columnCosines),r=Object(o.default)(t.imagePositionPatient),i=e.clone().sub(r);return{x:n.dot(i)/t.columnPixelSpacing,y:a.dot(i)/t.rowPixelSpacing}}function i(e,t){var n=Object(o.default)(t.rowCosines),a=Object(o.default)(t.columnCosines),r=Object(o.default)(t.imagePositionPatient),i=n.clone().multiplyScalar(e.x);i.multiplyScalar(t.columnPixelSpacing);var l=a.clone().multiplyScalar(e.y);l.multiplyScalar(t.rowPixelSpacing);var s=i.add(l);return s.add(r),s}function l(e,t){var n=Object(o.default)(e.rowCosines),r=Object(o.default)(e.columnCosines),l=Object(o.default)(e.imagePositionPatient),s=Object(o.default)(t.rowCosines),u=Object(o.default)(t.columnCosines),d=Object(o.default)(t.imagePositionPatient),c=n.clone().cross(r),f=new a.default.cornerstoneMath.Plane;f.setFromNormalAndCoplanarPoint(c,l);var g=s.clone().cross(u),m=new a.default.cornerstoneMath.Plane;m.setFromNormalAndCoplanarPoint(g,d);var h=m.clone().intersectPlane(f),v=h.origin,p=h.direction,b=i({x:t.columns,y:t.rows},t),j=d.distanceTo(b),x=new a.default.cornerstoneMath.Line3;x.start=v,x.end=v.clone().add(p.multiplyScalar(j));var y=function(e){var t=i({x:0,y:0},e),n=i({x:e.columns,y:0},e),o=i({x:0,y:e.rows},e),r=i({x:e.columns,y:e.rows},e);return{top:new a.default.cornerstoneMath.Line3(t,n),left:new a.default.cornerstoneMath.Line3(t,o),right:new a.default.cornerstoneMath.Line3(n,r),bottom:new a.default.cornerstoneMath.Line3(o,r)}}(t),T=function(e,t){var n=[];return Object.keys(t).forEach((function(a){var o=t[a],r=e.intersectLine(o);r&&n.push(r)})),n}(x,y);if(2===T.length)return{start:T[0],end:T[1]}}function s(e,t,n){var a=n*(Math.PI/180);return{x:Math.cos(a)*(e.x-t.x)-Math.sin(a)*(e.y-t.y)+t.x,y:Math.sin(a)*(e.x-t.x)+Math.cos(a)*(e.y-t.y)+t.y}}},"./util/roundToDecimal.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},"./util/scroll.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/scrollToIndex.js"),o=n("./stateManagement/toolState.js"),r=n("./util/clip.js"),i=n("./externalModules.js");function l(e,t,n){if(e.pending[0]===t){if(e.currentImageIdIndex===t.index)return e.pending.splice(e.pending.indexOf(t),1),void(e.pending.length>0&&l(e,e.pending[0],n));n.addEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,(function a(o){e.imageIds.indexOf(o.detail.image.imageId)===t.index&&(e.pending.splice(e.pending.indexOf(t),1),n.removeEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,a),e.pending.length>0&&l(e,e.pending[0],n))})),Object(a.default)(n,t.index)}}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=Object(o.getToolState)(e,"stack");if(s&&s.data&&s.data.length){var u=s.data[0];u.pending||(u.pending=[]);var d=u.currentImageIdIndex+t;if(n){var c=u.imageIds.length;d%=c}else d=Object(r.default)(d,0,u.imageIds.length-1);if(i)Object(a.default)(e,d);else{var f={index:d};u.pending.push(f),l(u,f,e)}}}},"./util/scrollToIndex.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),o=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),i=n("./stateManagement/loadHandlerManager.js"),l=n("./util/triggerEvent.js");t.default=function(e,t){var n=Object(r.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var s,u=o.default.cornerstone;if(n.data.length>1){var d=Object(r.getToolState)(e,"stackRenderer");d&&d.data&&d.data.length&&(s=d.data[0])}var c=n.data[0];t<0&&(t+=c.imageIds.length);var f=i.default.getStartLoadHandler(e),g=i.default.getEndLoadHandler(e),m=i.default.getErrorLoadingHandler(e);if(t!==c.currentImageIdIndex){f&&f(e);var h={newImageIdIndex:t,direction:t-c.currentImageIdIndex};c.currentImageIdIndex=t;var v=c.imageIds[t];(Boolean(c.preventCache)?u.loadImage(v):u.loadAndCacheImage(v)).then((function(a){if(c.currentImageIdIndex===t){try{u.getEnabledElement(e)}catch(e){return}s?(s.currentImageIdIndex=t,s.render(e,n.data)):u.displayImage(e,a),g&&g(e,a)}}),(function(n){var a=c.imageIds[t];m&&m(e,a,n)})),Object(l.default)(e,a.default.STACK_SCROLL,h)}}}},"./util/segmentation/drawBrush.js":function(e,t,n){"use strict";n.r(t),n.d(t,"drawBrushPixels",(function(){return i}));var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n("./util/segmentation/eraseIfSegmentIndex.js");function i(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=function(e,t){return t*a+e};e.forEach((function(e){var a=l.apply(void 0,o()(e));i?Object(r.default)(a,t,n):t[a]=n}))}},"./util/segmentation/eraseIfSegmentIndex.js":function(e,t,n){"use strict";function a(e,t,n){t[e]===n&&(t[e]=0)}n.r(t),n.d(t,"default",(function(){return a}))},"./util/segmentation/eraseOutsideBoundingBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./util/segmentation/eraseIfSegmentIndex.js");function o(e,t,n,o){for(var r=e.detail,i=t.pixelData,l=t.segmentIndex,s=r.image,u=s.width,d=s.height,c=0;c<u;c++)for(var f=0;f<n[1];f++)Object(a.default)(f*u+c,i,l);for(var g=0;g<n[0];g++)for(var m=n[1];m<o[1];m++)Object(a.default)(m*u+g,i,l);for(var h=o[0];h<u;h++)for(var v=n[1];v<o[1];v++)Object(a.default)(v*u+h,i,l);for(var p=0;p<u;p++)for(var b=o[1];b<d;b++)Object(a.default)(b*u+p,i,l)}},"./util/segmentation/eraseShape.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideShape",(function(){return u})),n.d(t,"eraseOutsideShape",(function(){return d}));var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(a),r=n("./util/segmentation/eraseOutsideBoundingBox.js"),i=n("./util/segmentation/isSameSegment.js"),l=n("./util/logger.js");function s(e,t,n,a,l){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inside",u=e.detail.image.width,d=t.pixelData,c=t.segmentIndex,f=o()(a,2),g=f[0],m=f[1],h=o()(l,2),v=h[0],p=h[1];"outside"===s&&Object(r.default)(e,t,a,l);for(var b=g;b<v;b++)for(var j=m;j<p;j++){var x=j*u+b;Object(i.default)(x,d,c)&&n({x:b,y:j})&&(d[x]=0)}}function u(e,t,n,a,o){s(e,t,n,a,o,"inside")}function d(e,t,n,a,o){s(e,t,(function(e){return!n(e)}),a,o,"outside")}Object(l.getLogger)("util:segmentation:operations:eraseOutsideCircle")},"./util/segmentation/fillOutsideBoundingBox.js":function(e,t,n){"use strict";function a(e,t,n,a){for(var o=t.pixelData,r=t.segmentIndex,i=e.detail.image,l=i.width,s=i.height,u=0;u<l;u++)for(var d=0;d<n[1];d++)o[d*l+u]=r;for(var c=0;c<n[0];c++)for(var f=n[1];f<a[1];f++)o[f*l+c]=r;for(var g=a[0];g<l;g++)for(var m=n[1];m<a[1];m++)o[m*l+g]=r;for(var h=0;h<l;h++)for(var v=a[1];v<s;v++)o[v*l+h]=r}n.r(t),n.d(t,"default",(function(){return a}))},"./util/segmentation/fillShape.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideShape",(function(){return u})),n.d(t,"fillOutsideShape",(function(){return d}));var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(a),r=n("./util/segmentation/fillOutsideBoundingBox.js"),i=n("./util/logger.js"),l=Object(i.getLogger)("util:segmentation:operations:helpers:fillShape");function s(e,t,n,a,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inside",u=t.pixelData,d=t.segmentIndex;if(void 0!==u&&void 0!==d){var c=e.detail.image.width,f=o()(a,2),g=f[0],m=f[1],h=o()(i,2),v=h[0],p=h[1];"outside"===s&&Object(r.default)(e,t,a,i);for(var b=g;b<v;b++)for(var j=m;j<p;j++){var x=j*c+b;n({x:b,y:j})&&(u[x]=d)}}else l.error("fillInsideShape requires operationData to contain pixelData and segmentIndex")}function u(e,t,n,a,o){s(e,t,n,a,o,"inside")}function d(e,t,n,a,o){s(e,t,(function(e){return!n(e)}),a,o,"outside")}},"./util/segmentation/floodFill.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a);function r(e,t){return e===t}function i(e){for(var t=0,n=0;n<e.length;n+=1)0!==e[n]&&(t+=1);return t}function l(e,t,n){return(new Array(n+1).join(t)+e).slice(-n)}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.onFlood||function(){},s=n.onBoundary||function(){},u=n.equals||r,d=n.diagonals||!1,c=C(t),f=E(),g=[],m=[],h={},v={};for(g.push({currentArgs:t});g.length>0;)p(g.pop());return{flooded:m,boundaries:I()};function p(e){var t=e.currentArgs,n=e.previousArgs;b(t)||(j(t),x(t)?(y(t),w(t)):T(n))}function b(e){return!0===h[e]}function j(e){h[e]=!0}function x(e){var t=O(C,[e]);return O(u,[t,c])}function y(e){m.push(e),a.apply(void 0,o()(e))}function T(e){v[e]=e,s.apply(void 0,o()(e))}function w(e){for(var t=0;t<f.length;t+=1){for(var n=f[t],a=e.slice(0),o=0;o<e.length;o+=1)a[o]+=n[o];g.push({currentArgs:a,previousArgs:e})}}function C(t){return e.apply(void 0,o()(t))}function O(e,t){try{return e.apply(void 0,o()(t))}catch(e){return}}function E(){return M(t.length).filter((function(e){var t=i(e);return 0!==t&&(1===t||d)}))}function M(e){for(var t=[],n=function(e){return e.split("").map((function(e){return parseInt(e,10)-1}))},a=0;a<Math.pow(3,e);a+=1){var o=l(a.toString(3),"0",e);t.push(n(o))}return t}function I(){var e=[];for(var t in v)v.hasOwnProperty(t)&&e.unshift(v[t]);return e}}},"./util/segmentation/getBoundingBoxAroundCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var a=n("./util/getCircleCoords.js");function o(e){var t=e.detail.handles,n=e.detail.image,o=n.width,r=n.height,i=Object(a.default)(t.start,t.end),l=i.width+i.left,s=i.left,u=i.top+i.height,d=i.top;return s=Math.floor(s),d=Math.floor(d),l=Math.floor(l),u=Math.floor(u),l=Math.min(o,l),s=Math.max(0,s),u=Math.min(r,u),[[s,d=Math.max(0,d)],[l,u]]}},"./util/segmentation/getBoundingBoxAroundPolygon.js":function(e,t,n){"use strict";function a(e,t){var n=1/0,a=0,o=1/0,r=0,i=t.width,l=t.height;return e.forEach((function(e){n=Math.min(e[0],n),a=Math.max(e[0],a),o=Math.min(e[1],o),r=Math.max(e[1],r)})),n=Math.floor(n),o=Math.floor(o),a=Math.floor(a),r=Math.floor(r),a=Math.min(i,a),n=Math.max(0,n),r=Math.min(l,r),o=Math.max(0,o),[[n,o],[a,r]]}n.r(t),n.d(t,"default",(function(){return a}))},"./util/segmentation/getCircle.js":function(e,t,n){"use strict";function a(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=Math.floor(a),i=Math.floor(o);if(1===e)return[[r,i]];for(var l=[],s=0,u=-e;u<=e;u++){var d=i+u;if(!(d>t||d<0))for(var c=-e;c<=e;c++){var f=r+c;f>=n||f<0||c*c+u*u<e*e&&(l[s++]=[r+c,i+u])}}return l}n.r(t),n.d(t,"default",(function(){return a}))},"./util/segmentation/getDiffBetweenPixelData.js":function(e,t,n){"use strict";function a(e,t){for(var n=[],a=0;a<e.length;a++)e[a]!==t[a]&&n.push([a,e[a],t[a]]);return n}n.r(t),n.d(t,"default",(function(){return a}))},"./util/segmentation/getPixelPathBetweenPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),o=1/Math.sqrt(2),r={up:{x:0,y:1},upRight:{x:o,y:o},right:{x:1,y:0},downRight:{x:o,y:-o},down:{x:0,y:1},downLeft:{x:-o,y:-o},left:{x:-1,y:0},upLeft:{x:-o,y:o}};function i(e,t){var n=d(e,t);switch(f([c(n,r.up),c(n,r.right),c(n,r.upRight)])){case 0:e.y++;break;case 1:e.x++;break;case 2:e.y++,e.x++}}function l(e,t){var n=d(e,t);switch(f([c(n,r.up),c(n,r.left),c(n,r.upLeft)])){case 0:e.y++;break;case 1:e.x--;break;case 2:e.y++,e.x--}}function s(e,t){var n=d(e,t);switch(f([c(n,r.down),c(n,r.right),c(n,r.downRight)])){case 0:e.y--;break;case 1:e.x++;break;case 2:e.y--,e.x++}}function u(e,t){var n=d(e,t);switch(f([c(n,r.down),c(n,r.left),c(n,r.downLeft)])){case 0:e.y--;break;case 1:e.x--;break;case 2:e.y--,e.x--}}function d(e,t){var n=a.default.cornerstoneMath.point.distance(e,t);return{x:(t.x-e.x)/n,y:(t.y-e.y)/n}}function c(e,t){return e.x*t.x+e.y*t.y}function f(e){var t=e[0]>e[1]?0:1;return e[2]>e[t]&&(t=2),t}t.default=function(e,t){for(var n={x:e.x,y:e.y},a=[];t.x!==n.x||t.y!==n.y;)t.x===n.x?t.y>n.y?n.y++:n.y--:t.y===n.y?t.x>n.x?n.x++:n.x--:t.y>n.y?t.x>n.x?i(n,t):l(n,t):t.x>n.x?s(n,t):u(n,t),a.push({x:n.x,y:n.y});return a.pop(),a}},"./util/segmentation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/segmentation/drawBrush.js");n.d(t,"drawBrushPixels",(function(){return a.drawBrushPixels}));var o=n("./util/segmentation/eraseIfSegmentIndex.js");n.d(t,"eraseIfSegmentIndex",(function(){return o.default}));var r=n("./util/segmentation/eraseOutsideBoundingBox.js");n.d(t,"eraseOutsideBoundingBox",(function(){return r.default}));var i=n("./util/segmentation/eraseShape.js");n.d(t,"eraseInsideShape",(function(){return i.eraseInsideShape})),n.d(t,"eraseOutsideShape",(function(){return i.eraseOutsideShape}));var l=n("./util/segmentation/fillOutsideBoundingBox.js");n.d(t,"fillOutsideBoundingBox",(function(){return l.default}));var s=n("./util/segmentation/fillShape.js");n.d(t,"fillInsideShape",(function(){return s.fillInsideShape})),n.d(t,"fillOutsideShape",(function(){return s.fillOutsideShape}));var u=n("./util/segmentation/floodFill.js");n.d(t,"floodFill",(function(){return u.default}));var d=n("./util/segmentation/getBoundingBoxAroundCircle.js");n.d(t,"getBoundingBoxAroundCircle",(function(){return d.default}));var c=n("./util/segmentation/getBoundingBoxAroundPolygon.js");n.d(t,"getBoundingBoxAroundPolygon",(function(){return c.default}));var f=n("./util/segmentation/getCircle.js");n.d(t,"getCircle",(function(){return f.default}));var g=n("./util/segmentation/getPixelPathBetweenPixels.js");n.d(t,"getPixelPathBetweenPixels",(function(){return g.default}));var m=n("./util/segmentation/isSameSegment.js");n.d(t,"isSameSegment",(function(){return m.default}));var h=n("./util/segmentation/triggerLabelmapModifiedEvent.js");n.d(t,"triggerLabelmapModifiedEvent",(function(){return h.default}));var v=n("./util/segmentation/getDiffBetweenPixelData.js");n.d(t,"getDiffBetweenPixelData",(function(){return v.default}))},"./util/segmentation/isSameSegment.js":function(e,t,n){"use strict";function a(e,t,n){return t[e]===n}n.r(t),n.d(t,"default",(function(){return a}))},"./util/segmentation/triggerLabelmapModifiedEvent.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var a=n("./externalModules.js"),o=n("./events.js"),r=n("./store/index.js");function i(e,t){var n=Object(r.getModule)("segmentation").getters;t=void 0===t?n.activeLabelmapIndex(e):t,a.default.cornerstone.triggerEvent(e,o.default.LABELMAP_MODIFIED,{labelmapIndex:t})}},"./util/setContextToDisplayFontSize.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){var o=.1;return a.default.cornerstone.setToPixelCoordinateSystem(e,t,o),{fontSize:n/e.viewport.scale/o,lineHeight:n/e.viewport.scale/o,fontScale:o}}},"./util/throttle.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/debounce.js"),o=n("./util/isObject.js");t.default=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Object(o.default)(n)&&(r="leading"in n?Boolean(n.leading):r,i="trailing"in n?Boolean(n.trailing):i),Object(a.default)(e,t,{leading:r,trailing:i,maxWait:t})}},"./util/triggerEvent.js":function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",(function(){return a}))},"./util/uuidv4.js":function(e,t,n){"use strict";function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}n.r(t),n.d(t,"default",(function(){return a}))},"./util/wait.js":function(e,t,n){"use strict";n.r(t),n.d(t,"wait",(function(){return o})),n.d(t,"waitForEnabledElementImageToLoad",(function(){return r}));var a=n("./externalModules.js"),o=function(e){return new Promise((function(t){return setTimeout(t,e)}))};function r(e){try{var t=a.default.cornerstone.getEnabledElement(e);return t.image?t:o(250).then((function(){return r(e)}))}catch(e){return null}}t.default=o},"./util/zoom/changeViewportScale.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=n.maxScale,o=n.minScale,r=Math.log(e.scale)/Math.log(1.7)+t,i=Math.pow(1.7,r);return e.scale=a&&i>a?a:o&&i<o?o:i,e}},"./util/zoom/correctShift.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=t.hflip,a=t.vflip,o=t.rotation;if(e.x*=n?-1:1,e.y*=a?-1:1,0!==o){var r=o*Math.PI/180,i=Math.cos(r),l=Math.sin(r),s=e.x*i-e.y*l,u=e.x*l+e.y*i;e.x=s,e.y=u}return e}},"./util/zoom/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/zoom/changeViewportScale.js");n.d(t,"changeViewportScale",(function(){return a.default}));var o=n("./util/zoom/correctShift.js");n.d(t,"correctShift",(function(){return o.default})),t.default={changeViewportScale:a.default,correctShift:o.default}},"./version.js":function(e,t,n){"use strict";n.r(t),t.default="6.0.8"}})},e.exports=t()}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";n(371);var e=n(30),t=n.n(e);const{drawBrushPixels:a,getCircle:o}=t().import("util/segmentationUtils");t().getModule("segmentation"),t().import("base/BaseBrushTool")})()})();